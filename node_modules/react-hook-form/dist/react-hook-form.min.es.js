import{isValidElement as e,useRef as r,useState as t,useCallback as n,useEffect as c,createContext as s,useContext as u,createElement as i,cloneElement as a,Fragment as o}from"react";var l=e=>null==e,f=e=>Array.isArray(e);const d=e=>"object"==typeof e;var g=e=>!l(e)&&!f(e)&&d(e),h=e=>g(e)&&e.nodeType===Node.ELEMENT_NODE;const m={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit"},v="undefined",b={BLUR:"blur",CHANGE:"change",INPUT:"input"},p="max",O="min",y="maxLength",j="minLength",R="pattern",x="required",S="validate",E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,V=/^\w*$/,w=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,B=/\\(\\)?/g,N=/[\d+]/g;var C=e=>!f(e)&&(V.test(e)||!E.test(e)),k=e=>{const r=[];return e.replace(w,(e,t,n,c)=>{r.push(n?c.replace(B,"$1"):t||e)}),r};function F(e,r,t){let n=-1;const c=C(r)?[r]:k(r),s=c.length,u=s-1;for(;++n<s;){const r=c[n];let s=t;if(n!==u){const t=e[r];s=g(t)||f(t)?t:isNaN(+c[n+1])?{}:[]}e[r]=s,e=e[r]}return e}var $=e=>Object.entries(e).reduce((e,[r,t])=>C(r)?Object.assign(Object.assign({},e),{[r]:t}):(F(e,r,t),e),{}),L=e=>void 0===e,A=(e,r,t)=>{const n=r.split(/[,[\].]+?/).filter(Boolean).reduce((e,r)=>l(e)?e:e[r],e);return L(n)||n===e?e[r]||t:n},P=(e,r)=>{for(const t in e)if(A(r,t)){const r=e[t];if(r){if(r.ref.focus){r.ref.focus();break}if(r.options){r.options[0].ref.focus();break}}}},D=(e,r)=>{h(e)&&e.removeEventListener&&(e.removeEventListener(b.INPUT,r),e.removeEventListener(b.CHANGE,r),e.removeEventListener(b.BLUR,r))},M=e=>"radio"===e.type,W=e=>"checkbox"===e.type;function T(e){return!e||e instanceof HTMLElement&&e.nodeType!==Node.DOCUMENT_NODE&&T(e.parentNode)}var U=e=>g(e)&&!Object.keys(e).length;function I(e){return f(e)?e:k(e)}function z(e,r){return 1==r.length?e:function(e,r){const t=C(r)?[r]:I(r),n=r.length;let c=0;for(;c<n;)e=L(e)?c++:e[t[c++]];return c==n?e:void 0}(e,function(e,r,t){let n=-1,c=e.length;r<0&&(r=-r>c?0:c+r),(t=t>c?c:t)<0&&(t+=c),c=r>t?0:t-r;const s=Array(c);for(;++n<c;)s[n]=e[n+r];return s}(r,0,-1))}function H(e,r){return r.forEach(r=>{!function(e,r){const t=C(r)?[r]:I(r),n=z(e,t),c=t[t.length-1],s=!(null!=n)||delete n[c];let u=void 0;for(let r=0;r<t.slice(0,-1).length;r++){let n=-1,c=void 0;const s=t.slice(0,-(r+1)),i=s.length-1;for(r>0&&(u=e);++n<s.length;){const r=s[n];c=c?c[r]:e[r],i===n&&(g(c)&&U(c)||f(c)&&!c.filter(e=>g(e)&&!U(e)).length)&&(u?delete u[r]:delete e[r]),u=c}}}(e,r)}),e}const G=(e,r)=>e&&e.ref===r;const _={isValid:!1,value:""};var q=e=>f(e)?e.reduce((e,{ref:{checked:r,value:t}})=>r?{isValid:!0,value:t}:e,_):_,J=e=>[...e].filter(({selected:e})=>e).map(({value:e})=>e),K=e=>"file"===e.type,Q=e=>"select-multiple"===e.type,X=e=>""===e;const Y={value:!1,isValid:!1},Z={value:!0,isValid:!0};var ee=e=>{if(f(e)){if(e.length>1){const r=e.filter(e=>e&&e.ref.checked).map(({ref:{value:e}})=>e);return{value:r,isValid:!!r.length}}const{checked:r,value:t,attributes:n}=e[0].ref;return r?n&&!L(n.value)?L(t)||X(t)?Z:{value:t,isValid:!0}:Z:Y}return Y};function re(e,r){const{name:t,value:n}=r,c=e[t];return K(r)?r.files:M(r)?c?q(c.options).value:"":Q(r)?J(r.options):W(r)?!!c&&ee(c.options).value:n}var te=e=>"string"==typeof e,ne=(e,r)=>{const t={};for(const n in e)(L(r)||(te(r)?n.startsWith(r):f(r)?r.find(e=>n.startsWith(e)):r&&r.nest))&&(t[n]=re(e,e[n].ref));return t},ce=(e,{type:r,types:t,message:n})=>g(e)&&e.type===r&&e.message===n&&((e={},r={})=>{const t=Object.keys(e),n=Object.keys(r);return t.length===n.length&&t.every(t=>r[t]&&r[t]===e[t])})(e.types,t);var se=e=>e instanceof RegExp,ue=e=>{return(e=>g(e)&&!se(e))(e)?e:{value:e,message:""}},ie=e=>"function"==typeof e,ae=e=>"boolean"==typeof e,oe=r=>te(r)||g(r)&&e(r);function le(e,r,t="validate"){if(oe(e)||ae(e)&&!e)return{type:t,message:oe(e)?e:"",ref:r}}var fe=(e,r,t,n,c)=>{if(r){const r=t[e];return Object.assign(Object.assign({},r),{types:Object.assign(Object.assign({},r&&r.types?r.types:{}),{[n]:c||!0})})}return{}},de=async(e,r,{ref:t,ref:{type:n,value:c,name:s},options:u,required:i,maxLength:a,minLength:o,min:f,max:d,pattern:h,validate:m})=>{var v;const b=e.current,E={},V=M(t),w=W(t),B=V||w,N=X(c),C=fe.bind(null,s,r,E),k=(e,n,c,u=y,i=j)=>{const a=e?n:c;if(E[s]=Object.assign({type:e?u:i,message:a,ref:t},C(e?u:i,a)),!r)return E};if(i&&(!V&&!w&&(N||l(c))||ae(c)&&!c||w&&!ee(u).isValid||V&&!q(u).isValid)){const{value:e,message:n}=oe(i)?{value:!!i,message:i}:ue(i);if(e&&(E[s]=Object.assign({type:x,message:n,ref:B?null===(v=b[s].options)||void 0===v?void 0:v[0].ref:t},C(x,n)),!r))return E}if(!l(f)||!l(d)){let e,s;const{value:u,message:i}=ue(d),{value:a,message:o}=ue(f);if("number"===n||!n&&!isNaN(c)){const r=t.valueAsNumber||parseFloat(c);l(u)||(e=r>u),l(a)||(s=r<a)}else{const r=t.valueAsDate||new Date(c);te(u)&&(e=r>new Date(u)),te(a)&&(s=r<new Date(a))}if((e||s)&&(k(!!e,i,o,p,O),!r))return E}if(te(c)&&!N&&(a||o)){const{value:e,message:t}=ue(a),{value:n,message:s}=ue(o),u=c.toString().length,i=!l(e)&&u>e,f=!l(n)&&u<n;if((i||f)&&(k(!!i,t,s),!r))return E}if(h&&!N){const{value:e,message:n}=ue(h);if(se(e)&&!e.test(c)&&(E[s]=Object.assign({type:R,message:n,ref:t},C(R,n)),!r))return E}if(m){const e=re(b,t),n=B&&u?u[0].ref:t;if(ie(m)){const t=le(await m(e),n);if(t&&(E[s]=Object.assign(Object.assign({},t),C(S,t.message)),!r))return E}else if(g(m)){let t={};for(const[c,u]of Object.entries(m)){if(!U(t)&&!r)break;const i=le(await u(e),n,c);i&&(t=Object.assign(Object.assign({},i),C(c,i.message)),r&&(E[s]=t))}if(!U(t)&&(E[s]=Object.assign({ref:n},t),!r))return E}}return E};const ge=(e,r)=>f(e.inner)?e.inner.reduce((e,{path:t,message:n,type:c})=>Object.assign(Object.assign({},e),t?e[t]&&r?{[t]:fe(t,r,e,c,n)}:{[t]:e[t]||Object.assign({message:n,type:c},r?{types:{[c]:n||!0}}:{})}:{}),{}):{[e.path]:{message:e.message,type:e.type}};async function he(e,r,t,n,c){if(n)return n(t,c);try{return{values:await e.validate(t,{abortEarly:!1,context:c}),errors:{}}}catch(e){return{values:{},errors:$(ge(e,r))}}}var me=e=>l(e)||!d(e);const ve=(e,r)=>{const t=(r,t,n)=>{const c=n?`${e}.${t}`:`${e}[${t}]`;return me(r)?c:ve(c,r)};return f(r)?r.map((e,r)=>t(e,r)):Object.entries(r).map(([e,r])=>t(r,e,!0))};var be=(e,r,t,n)=>{let c;return t.add(r),U(e)?c=void 0:L(e[r])?(c=A($(e),r),L(c)||((e,r)=>ve(e,r).flat(1/0))(r,c).forEach(e=>t.add(e))):(c=e[r],t.add(r)),L(c)?A(n,r):c},pe=({isOnChange:e,hasError:r,isBlurEvent:t,isOnSubmit:n,isReValidateOnSubmit:c,isOnBlur:s,isReValidateOnBlur:u,isSubmitted:i})=>e&&t||n&&c||n&&!i||s&&!t&&!r||u&&!t&&r||c&&i,Oe=e=>e.substring(0,e.indexOf("[")),ye=(e,r)=>{const t=$(ne(e));return r?A(t,r,t):t};function je(e,r){let t=!1;if(!f(e)||!f(r)||e.length!==r.length)return!0;for(let n=0;n<e.length&&!t;n++){const c=e[n],s=r[n];if(L(s)||Object.keys(c).length!==Object.keys(s).length){t=!0;break}for(const e in c)if(c[e]!==s[e]){t=!0;break}}return t}const Re=(e,r)=>RegExp(`^${r}[\\d+]`.replace(/\[/g,"\\[").replace(/\]/g,"\\]")).test(e);var xe=(e,r)=>[...e].reduce((e,t)=>!!Re(r,t)||e,!1);var Se=e=>({isOnSubmit:!e||e===m.onSubmit,isOnBlur:e===m.onBlur,isOnChange:e===m.onChange}),Ee=e=>M(e)||W(e);function Ve({mode:e=m.onSubmit,reValidateMode:s=m.onChange,validationSchema:u,validationResolver:i,validationContext:a,defaultValues:o={},submitFocusError:d=!0,validateCriteriaMode:p}={}){const O=r({}),y=r({}),j=r({}),R=r({}),x=r(new Set),S=r(new Set),E=r(new Set),V=r(new Set),w=r(!0),B=r(o),N=r({}),C=r(!1),k=r(!1),I=r(!1),z=r(!1),_=r(0),q=r(!1),J=r(),X=r({}),Y=r(a),Z=r(new Set),[,ee]=t(),{isOnBlur:se,isOnSubmit:ue,isOnChange:oe}=r(Se(e)).current,le="all"===p,fe=typeof window===v,ge=!(!u&&!i),ve=typeof document!==v&&!fe&&!L(window.HTMLElement),Re=ve?"Proxy"in window:typeof Proxy!==v,Ve=r({dirty:!Re,dirtyFields:!Re,isSubmitted:ue,submitCount:!Re,touched:!Re,isSubmitting:!Re,isValid:!Re}),{isOnBlur:we,isOnSubmit:Be}=r(Se(s)).current;Y.current=a;const Ne=n(()=>{C.current||ee({})},[]),Ce=n((e,r,t=!1)=>{let n=t||function({errors:e,name:r,error:t,validFields:n,fieldsWithValidation:c}){const s=U(t),u=U(e),i=A(t,r),a=A(e,r);return!(s&&n.has(r)||a&&a.isManual)&&(!!(u!==s||!u&&!a||s&&c.has(r)&&!n.has(r))||i&&!ce(a,i))}({errors:y.current,error:r,name:e,validFields:V.current,fieldsWithValidation:E.current});if(U(r)?((E.current.has(e)||ge)&&(V.current.add(e),n=n||A(y.current,e)),y.current=H(y.current,[e])):(V.current.delete(e),n=n||!A(y.current,e),F(y.current,e,r[e])),n&&!l(t))return Ne(),!0},[Ne,ge]),ke=n((e,r)=>{const{ref:t,options:n}=e,c=ve&&h(t)&&l(r)?"":r;M(t)&&n?n.forEach(({ref:e})=>e.checked=e.value===c):K(t)?te(c)?t.value=c:t.files=c:Q(t)?[...t.options].forEach(e=>e.selected=c.includes(e.value)):W(t)&&n?n.length>1?n.forEach(({ref:e})=>e.checked=c.includes(e.value)):n[0].ref.checked=!!c:t.value=c},[ve]),Fe=e=>{if(!O.current[e]||!Ve.current.dirty&&!Ve.current.dirtyFields)return!1;let r=N.current[e]!==re(O.current,O.current[e].ref);const t=xe(Z.current,e),n=S.current.size;if(t){const t=Oe(e);r=je(ye(O.current,t),A(B.current,t))}const c=(t?z.current:S.current.has(e))!==r;return r?S.current.add(e):S.current.delete(e),z.current=t?r:!!S.current.size,Ve.current.dirty?c:n!==S.current.size},$e=n(e=>{if(Fe(e)||!A(j.current,e)&&Ve.current.touched)return!!F(j.current,e,!0)},[]),Le=n((e,r,t)=>{const n=f(r);for(const c in r){const s=`${t||e}${n?`[${c}]`:`.${c}`}`,u=O.current[s];g(r[c])&&Le(e,r[c],s),u&&(ke(u,r[c]),$e(s))}},[ke,$e]),Ae=n((e,r)=>{const t=O.current[e];if(t){ke(t,r);const n=$e(e);if(ae(n))return n}else me(r)||Le(e,r)},[$e,ke,Le]),Pe=n(async(e,r)=>{const t=O.current[e];if(t){const n=await de(O,le,t);return Ce(e,n,!!r&&null),U(n)}return!1},[Ce,le]),De=n(async e=>{const{errors:r}=await he(u,le,ye(O.current),i,Y.current),t=w.current;if(w.current=U(r),f(e))e.forEach(e=>{const t=A(r,e);t?F(y.current,e,t):H(y.current,[e])}),Ne();else{const n=A(r,e);Ce(e,n?{[e]:n}:{},t!==w.current)}return U(y.current)},[Ne,Ce,le,i,u]),Me=n(async e=>{const r=e||Object.keys(O.current);if(ge)return De(r);if(f(r)){const e=await Promise.all(r.map(async e=>await Pe(e,!0)));return Ne(),e.every(Boolean)}return await Pe(r)},[De,Pe,Ne,ge]),We=e=>k.current||x.current.has(e)||x.current.has((e.match(/\w+/)||[])[0]);J.current=J.current?J.current:async({type:e,target:r})=>{const t=r?r.name:"",n=O.current,c=y.current,s=n[t],a=A(c,t);let o;if(!s)return;const l=e===b.BLUR,f=pe({hasError:!!a,isOnChange:oe,isBlurEvent:l,isOnSubmit:ue,isReValidateOnSubmit:Be,isOnBlur:se,isReValidateOnBlur:we,isSubmitted:I.current}),d=Fe(t);let g=We(t)||d;if(l&&!A(j.current,t)&&Ve.current.touched&&(F(j.current,t,!0),g=!0),f)return g&&Ne();if(ge){const{errors:e}=await he(u,le,ye(n),i,Y.current),r=w.current;w.current=U(e),o=A(e,t)?{[t]:A(e,t)}:{},r!==w.current&&(g=!0)}else o=await de(O,le,s);!Ce(t,o)&&g&&Ne()};const Te=n((e={})=>{const r=U(B.current)?ne(O.current):B.current;he(u,le,$(Object.assign(Object.assign({},r),e)),i,Y.current).then(({errors:e})=>{const r=w.current;w.current=U(e),r!==w.current&&Ne()})},[Ne,le,i]),Ue=n((e,r)=>{J.current&&e&&function(e,r,t,n){const{ref:c,ref:{name:s,type:u},mutationWatcher:i}=t,a=e[s];if(u)if((M(c)||W(c))&&a){const{options:t}=a;f(t)&&t.length?(t.filter(Boolean).forEach((e,c)=>{const{ref:s,mutationWatcher:u}=e;(s&&T(s)&&G(e,s)||n)&&(D(s,r),u&&u.disconnect(),H(t,[`[${c}]`]))}),t&&!t.filter(Boolean).length&&delete e[s]):delete e[s]}else(T(c)&&G(a,c)||n)&&(D(c,r),i&&i.disconnect(),delete e[s]);else delete e[s]}(O.current,J.current,e,r)},[]),Ie=n((e,r)=>{if(!e||e&&xe(Z.current,e.ref.name)&&!r)return;Ue(e,r);const{name:t}=e.ref;y.current=H(y.current,[t]),j.current=H(j.current,[t]),N.current=H(N.current,[t]),[S,E,V,x].forEach(e=>e.current.delete(t)),(Ve.current.isValid||Ve.current.touched)&&(Ne(),ge&&Te())},[Ne,ge,Te,Ue]);const ze=({name:e,type:r,types:t,message:n,shouldRender:c})=>{const s=O.current[e];ce(y.current[e],{type:r,message:n,types:t})||(F(y.current,e,{type:r,types:t,message:n,ref:s?s.ref:{},isManual:!0}),c&&Ne())};function He(e,r={}){if(!e.name)return console.warn("Missing name @",e);const{name:t,type:n,value:c}=e,s=Object.assign({ref:e},r),u=O.current,i=Ee(e);let a,o,l=u[t],d=!0;if(i?l&&f(l.options)&&l.options.filter(Boolean).find(r=>c===r.ref.value&&r.ref===e):l&&e===l.ref)u[t]=Object.assign(Object.assign({},l),r);else{if(n){const c=function(e,r){const t=new MutationObserver(()=>{T(e)&&(t.disconnect(),r())});return t.observe(window.document,{childList:!0,subtree:!0}),t}(e,()=>Ie(l));l=i?Object.assign({options:[...l&&l.options||[],{ref:e,mutationWatcher:c}],ref:{type:n,name:t}},r):Object.assign(Object.assign({},s),{mutationWatcher:c})}else l=s;u[t]=l,U(B.current)||(o=A(B.current,t),d=L(o),a=xe(Z.current,t),d||a||ke(l,o)),ge&&!a&&Ve.current.isValid?Te():U(r)||(E.current.add(t),!ue&&Ve.current.isValid&&de(O,le,l).then(e=>{const r=w.current;U(e)?V.current.add(t):w.current=!1,r!==w.current&&Ne()})),N.current[t]||a&&d||(N.current[t]=d?re(u,l.ref):o),n&&function({field:{ref:e},handleChange:r,isRadioOrCheckbox:t}){h(e)&&r&&(e.addEventListener(t?b.CHANGE:b.INPUT,r),e.addEventListener(b.BLUR,r))}({field:i&&l.options?l.options[l.options.length-1]:l,isRadioOrCheckbox:i,handleChange:J.current})}}const Ge=n(e=>async r=>{r&&(r.preventDefault(),r.persist());let t={};const n=O.current;let c=ne(n);Ve.current.isSubmitting&&(q.current=!0,Ne());try{if(ge){const{errors:e,values:r}=await he(u,le,$(c),i,Y.current);y.current=e,t=e,c=r}else for(const e of Object.values(n))if(e){const{ref:{name:r}}=e,n=await de(O,le,e);n[r]?(F(t,r,n[r]),V.current.delete(r)):E.current.has(r)&&V.current.add(r)}U(t)?(y.current={},await e($(c),r)):(y.current=t,d&&ve&&P(n,t))}finally{I.current=!0,q.current=!1,_.current=_.current+1,Ne()}},[ve,Ne,ge,d,le,i,u]);c(()=>()=>{C.current=!0,O.current&&"production"===process.env.NODE_ENV&&Object.values(O.current).forEach(e=>Ie(e,!0))},[Ie]),ge||(w.current=V.current.size>=E.current.size&&U(y.current));const _e={dirty:z.current,dirtyFields:S.current,isSubmitted:I.current,submitCount:_.current,touched:j.current,isSubmitting:q.current,isValid:ue?I.current&&U(y.current):w.current},qe={triggerValidation:Me,setValue:n(function(e,r,t){let n=!1;const c=f(e);(c?e:[e]).forEach(e=>{const t=te(e);n=!(!Ae(t?e:Object.keys(e)[0],t?r:Object.values(e)[0])&&!c)||We(e)}),(n||c)&&Ne(),(t||c&&r)&&Me(c?void 0:e)},[Ne,Ae,Me]),register:n(function(e,r){if(!fe)if(te(e))He({name:e},r);else{if(!(g(e)&&"name"in e))return r=>r&&He(r,e);He(e,r)}},[B.current,N.current]),unregister:n(function(e){O.current&&(f(e)?e:[e]).forEach(e=>Ie(O.current[e],!0))},[]),getValues:n(function(e){if(te(e))return O.current[e]?re(O.current,O.current[e].ref):void 0;const r=ne(O.current),t=U(r)?B.current:r;return e&&e.nest?$(t):t},[]),formState:Re?new Proxy(_e,{get:(e,r)=>r in e?(Ve.current[r]=!0,e[r]):{}}):_e},Je=Object.assign(Object.assign(Object.assign({removeFieldEventListener:Ue,reRender:Ne},ge?{validateSchemaIsValid:Te}:{}),{mode:{isOnBlur:se,isOnSubmit:ue,isOnChange:oe},reValidateMode:{isReValidateOnBlur:we,isReValidateOnSubmit:Be},errorsRef:y,touchedFieldsRef:j,fieldsRef:O,isWatchAllRef:k,watchFieldsRef:x,resetFieldArrayFunctionRef:X,fieldArrayDefaultValues:R,validFieldsRef:V,dirtyFieldsRef:S,fieldsWithValidationRef:E,fieldArrayNamesRef:Z,isDirtyRef:z,readFormStateRef:Ve,defaultValuesRef:B}),qe);return Object.assign({watch:function(e,r){const t=x.current,n=L(r),c=n?B.current:r,s=ne(O.current,e);if(te(e))return be(s,e,t,{[e]:n?A(c,e):r});if(f(e))return e.reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:be(s,r,t,c)}),{});k.current=!0;const u=!U(s)&&s||c;return e&&e.nest?$(u):u},control:Je,handleSubmit:Ge,reset:n((e,r={})=>{if(ve)for(const e of Object.values(O.current))if(e){const{ref:r,options:t}=e,n=Ee(r)&&f(t)?t[0].ref:r;if(h(n))try{n.closest("form").reset();break}catch(e){}}e&&(B.current=e),Object.values(X.current).forEach(e=>ie(e)&&e()),(({errors:e,dirty:r,isSubmitted:t,touched:n,isValid:c,submitCount:s,dirtyFields:u})=>{O.current={},e||(y.current={}),n||(j.current={}),c||(V.current=new Set,E.current=new Set,w.current=!0),r||(z.current=!1),u||(S.current=new Set),t||(I.current=!1),s||(_.current=0),N.current={},R.current={},x.current=new Set,k.current=!1})(r),Ne()},[]),clearError:n(function(e){e?H(y.current,f(e)?e:[e]):y.current={},Ne()},[]),setError:n(function(e,r="",t){te(e)?ze(Object.assign(Object.assign({name:e},g(r)?{types:r,type:""}:{type:r,message:t}),{shouldRender:!0})):f(e)&&(e.forEach(e=>ze(Object.assign({},e))),Ne())},[]),errors:y.current},qe)}function we(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(n=Object.getOwnPropertySymbols(e);c<n.length;c++)r.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(e,n[c])&&(t[n[c]]=e[n[c]])}return t}const Be=s(null);function Ne(){return u(Be)}function Ce(e){var{children:r,formState:t,errors:n}=e,c=we(e,["children","formState","errors"]);return i(Be.Provider,{value:Object.assign(Object.assign({},c),{formState:t,errors:n})},r)}var ke=()=>{const e=typeof performance===v?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})};const Fe=(e,r)=>Object.assign({[r]:ke()},g(e)?e:{value:e}),$e=(e,r)=>(f(e)?e:[]).map(e=>Fe(e,r));var Le=(e,r)=>L(r)?[]:f(r)?function(e,r){let t=-1;for(;++t<e.length;)r.indexOf(t)>=0&&delete e[t];return e.filter(Boolean)}(e,r):((e,r)=>[...e.slice(0,r),...e.slice(r+1)])(e,r),Ae=(e,r,t)=>f(e)?e.splice(t,0,e.splice(r,1)[0]):[],Pe=(e,r,t)=>{const n=[e[t],e[r]];e[r]=n[0],e[t]=n[1]};function De(e,r){return[...f(r)?r:[r||null],...e]}function Me(e,r,t){return[...e.slice(0,r),...f(t)?t:[t||null],...e.slice(r)]}var We=e=>f(e)?Array(e.length).fill(null):null;const Te=({control:e,name:s,keyName:u="id"})=>{const i=Ne(),{isWatchAllRef:a,resetFieldArrayFunctionRef:o,fieldArrayNamesRef:l,reRender:d,fieldsRef:g,getValues:h,defaultValuesRef:m,removeFieldEventListener:v,errorsRef:b,dirtyFieldsRef:p,isDirtyRef:O,touchedFieldsRef:y,readFormStateRef:j,watchFieldsRef:R,validFieldsRef:x,fieldsWithValidationRef:S,fieldArrayDefaultValues:E,validateSchemaIsValid:V}=e||i.control,w=()=>[...A(E.current[Oe(s)]?E.current:m.current,s,[])],B=r(w()),[k,F]=t($e(B.current,u)),[$,P]=t(!1),D=r(k),M=C(s);D.current=k,M&&(E.current[s]=B.current);const W=e=>e.map(e=>Fe(e,u)),T=e=>{F(e),j.current.isValid&&V&&V({[s]:e})},U=({shouldRender:e,isRemove:r,isPrePend:t,index:n,value:c={}}={})=>{let u=e;const i=f(c)?c:[c];if(j.current.dirty){const e={};if(t||r)for(const r of[...p.current].sort())if(Re(r,s)){const t=r.match(N);if(t){const n=+t[t.length-1];e[n]?e[n].push(r):e[n]=[r]}p.current.delete(r)}if(!L(n)||t){const r=L(n)?[]:((e,r,t=[],n=0,c=[])=>{for(const t of r)e.indexOf(t)<0&&c.push(t);for(const s of e.sort())r.indexOf(s)>-1?(t.push(-1),n++):t.push(s-n-(c.length?c.map(e=>e<s).filter(Boolean).length:0));return t})(Object.keys(e).map(e=>+e),f(n)?n:[n]);Object.values(e).forEach((e,n)=>{const c=t?0:r[n];if(c>-1)for(const r of e){const n=r.match(N);n&&p.current.add(r.replace(/[\d+]([^[\d+]+)$/,`${t?+n[n.length-1]+e.length:c}$1`))}})}r||(i.forEach((e,r)=>Object.keys(e).forEach(e=>p.current.add(`${s}[${t?r:D.current.length+r}].${e}`))),O.current=!0),u=!0}u&&!a.current&&d()},I=e=>{j.current.dirty&&(O.current=!!L(e)||je(e,m.current[s]||[]));for(const e in g.current)Re(e,s)&&g.current[e]&&v(g.current[e],!0)},z=()=>{const e=A(h({nest:!0}),s);if(f(e))for(let r=0;r<e.length;r++)D.current[r]=Object.assign(Object.assign({},D.current[r]),e[r])},H=()=>{I(),B.current=w(),F($e(B.current,u))};return c(()=>{M&&$&&E.current[s]&&k.length<E.current[s].length&&E.current[s].pop()},[k,s,E,$,M]),c(()=>{if(a&&a.current)d();else if(R)for(const e of R.current)if(e.startsWith(s)){d();break}},[k,s,d,R,a]),c(()=>{const e=o.current,r=l.current;return r.add(s),e[s]=H,()=>{I(),delete e[s],r.delete(s)}},[]),{swap:n((e,r)=>{z();const t=ye(g.current,s);Pe(t,e,r),I(t),Pe(D.current,e,r),T([...D.current]),b.current[s]&&Pe(b.current[s],e,r),j.current.touched&&y.current[s]&&(Pe(y.current[s],e,r),d())},[s]),move:n((e,r)=>{z();const t=ye(g.current,s);Ae(t,e,r),I(t),Ae(D.current,e,r),T([...D.current]),b.current[s]&&Ae(b.current[s],e,r),j.current.touched&&y.current[s]&&(Ae(y.current[s],e,r),d())},[s]),prepend:n(e=>{let r=!1;I(),T(De(D.current,f(e)?W(e):[Fe(e,u)])),b.current[s]&&(b.current[s]=De(b.current[s],We(e))),j.current.touched&&y.current[s]&&(y.current[s]=De(y.current[s],We(e)),r=!0),U({shouldRender:r,isPrePend:!0,value:e})},[s]),append:n(e=>{T([...D.current,...f(e)?W(e):[Fe(e,u)]]),U({value:e})},[s]),remove:n(e=>{let r=!1;if(L(e)||z(),I(Le(ye(g.current,s),e)),T(Le(D.current,e)),P(!0),b.current[s]&&(b.current[s]=Le(b.current[s],e),b.current[s].filter(Boolean).length||delete b.current[s]),j.current.touched&&y.current[s]&&(y.current[s]=Le(y.current[s],e),r=!0),j.current.isValid&&!V){let r=-1,t=!1;const n=L(e);for(;r++<k.length;){const c=r===k.length-1,u=(f(e)?e:[e]).indexOf(r)>=0;if((u||n)&&(t=!0),t)for(const e in k[r]){const t=`${s}[${r}].${e}`;if(u||c||n)x.current.delete(t),S.current.delete(t);else{const n=`${s}[${r-1}].${e}`;x.current.has(t)&&x.current.add(n),S.current.has(t)&&S.current.add(n)}}}}U({shouldRender:r,isRemove:!0,index:e})},[k,s]),insert:n((e,r)=>{z(),I(Me(ye(g.current,s),e)),T(Me(D.current,e,f(r)?W(r):[Fe(r,u)])),b.current[s]&&(b.current[s]=Me(b.current[s],e,We(r))),j.current.touched&&y.current[s]&&(y.current[s]=Me(y.current[s],e,We(r)),d())},[s]),fields:k}};const Ue=s=>{var{name:u,rules:o,as:l,onBlur:f,onChange:d,onChangeName:h=m.onChange,onBlurName:v=m.onBlur,valueName:b,defaultValue:p,control:O,onFocus:y}=s,j=we(s,["name","rules","as","onBlur","onChange","onChangeName","onBlurName","valueName","defaultValue","control","onFocus"]);const R=Ne(),{defaultValuesRef:x,setValue:S,register:E,unregister:V,errorsRef:w,removeFieldEventListener:B,triggerValidation:N,mode:{isOnSubmit:C,isOnBlur:k,isOnChange:F},reValidateMode:{isReValidateOnBlur:$,isReValidateOnSubmit:P},formState:{isSubmitted:D},fieldsRef:M,fieldArrayNamesRef:W}=O||R.control,[T,U]=t(L(p)?A(x.current,u):p),I=r(T),z=ae(T),H=k||$,G=r(o),_=!xe(W.current,u);G.current=o;const q=()=>!pe({hasError:!!A(w.current,u),isOnBlur:k,isOnSubmit:C,isOnChange:F,isReValidateOnBlur:$,isReValidateOnSubmit:P,isSubmitted:D}),J=e=>{const r=((e,r)=>me(e)||!g(e.target)||g(e.target)&&!e.type?e:r||L(e.target.value)?e.target.checked:e.target.value)(e,z);return U(r),I.current=r,r},K=n(()=>{!_&&M.current[u]&&B(M.current[u],!0),E(Object.defineProperty({name:u,focus:y},"value",{set(e){U(e),I.current=e},get:()=>I.current}),G.current)},[_,M,G,u,y,E,B]);c(()=>()=>V(u),[V,u]),c(()=>{K()},[K]),c(()=>{M.current[u]||(K(),_&&U(L(p)?A(x.current,u):p))});const Q=Object.assign(Object.assign(Object.assign(Object.assign({name:u},j),d?{[h]:(e=>(...r)=>S(u,J(e(r)),q()))(d)}:{[h]:e=>{const r=J(e);S(u,r,q())}}),f||H?{[v]:(...e)=>{f&&f(e),H&&N(u)}}:{}),{[b||(z?"checked":"value")]:T});return e(l)?a(l,Q):i(l,Q)},Ie=r=>{var{as:t,errors:n,name:c,message:s,children:u}=r,l=we(r,["as","errors","name","message","children"]);const f=Ne(),d=A(n||f.errors,c);if(!d)return null;const{message:g,types:h}=d,m=Object.assign(Object.assign({},t?l:{}),{children:u?u({message:g||s,messages:h}):g||s});return t?e(t)?a(t,m):i(t,m):i(o,Object.assign({},m))};export{Ue as Controller,Ie as ErrorMessage,Ce as FormContext,Te as useFieldArray,Ve as useForm,Ne as useFormContext};
