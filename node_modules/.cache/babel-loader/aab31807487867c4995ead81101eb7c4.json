{"ast":null,"code":"/**\n * @licstart The following is the entire license notice for the\n * Javascript code in this page\n *\n * Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * @licend The above is the entire license notice for the\n * Javascript code in this page\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SimpleLinkService = exports.PDFLinkService = void 0;\n\nvar _ui_utils = require(\"./ui_utils\");\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar PDFLinkService = /*#__PURE__*/function () {\n  function PDFLinkService() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        eventBus = _ref.eventBus,\n        _ref$externalLinkTarg = _ref.externalLinkTarget,\n        externalLinkTarget = _ref$externalLinkTarg === void 0 ? null : _ref$externalLinkTarg,\n        _ref$externalLinkRel = _ref.externalLinkRel,\n        externalLinkRel = _ref$externalLinkRel === void 0 ? null : _ref$externalLinkRel;\n\n    _classCallCheck(this, PDFLinkService);\n\n    this.eventBus = eventBus || (0, _ui_utils.getGlobalEventBus)();\n    this.externalLinkTarget = externalLinkTarget;\n    this.externalLinkRel = externalLinkRel;\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n    this._pagesRefCache = null;\n  }\n\n  _createClass(PDFLinkService, [{\n    key: \"setDocument\",\n    value: function setDocument(pdfDocument) {\n      var baseUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.baseUrl = baseUrl;\n      this.pdfDocument = pdfDocument;\n      this._pagesRefCache = Object.create(null);\n    }\n  }, {\n    key: \"setViewer\",\n    value: function setViewer(pdfViewer) {\n      this.pdfViewer = pdfViewer;\n    }\n  }, {\n    key: \"setHistory\",\n    value: function setHistory(pdfHistory) {\n      this.pdfHistory = pdfHistory;\n    }\n  }, {\n    key: \"navigateTo\",\n    value: function navigateTo(dest) {\n      var _this = this;\n\n      var goToDestination = function goToDestination(_ref2) {\n        var namedDest = _ref2.namedDest,\n            explicitDest = _ref2.explicitDest;\n        var destRef = explicitDest[0],\n            pageNumber;\n\n        if (destRef instanceof Object) {\n          pageNumber = _this._cachedPageNumber(destRef);\n\n          if (pageNumber === null) {\n            _this.pdfDocument.getPageIndex(destRef).then(function (pageIndex) {\n              _this.cachePageRef(pageIndex + 1, destRef);\n\n              goToDestination({\n                namedDest: namedDest,\n                explicitDest: explicitDest\n              });\n            }).catch(function () {\n              console.error(\"PDFLinkService.navigateTo: \\\"\".concat(destRef, \"\\\" is not \") + \"a valid page reference, for dest=\\\"\".concat(dest, \"\\\".\"));\n            });\n\n            return;\n          }\n        } else if (Number.isInteger(destRef)) {\n          pageNumber = destRef + 1;\n        } else {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(destRef, \"\\\" is not \") + \"a valid destination reference, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        if (!pageNumber || pageNumber < 1 || pageNumber > _this.pagesCount) {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(pageNumber, \"\\\" is not \") + \"a valid page number, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        if (_this.pdfHistory) {\n          _this.pdfHistory.pushCurrentPosition();\n\n          _this.pdfHistory.push({\n            namedDest: namedDest,\n            explicitDest: explicitDest,\n            pageNumber: pageNumber\n          });\n        }\n\n        _this.pdfViewer.scrollPageIntoView({\n          pageNumber: pageNumber,\n          destArray: explicitDest\n        });\n      };\n\n      new Promise(function (resolve, reject) {\n        if (typeof dest === 'string') {\n          _this.pdfDocument.getDestination(dest).then(function (destArray) {\n            resolve({\n              namedDest: dest,\n              explicitDest: destArray\n            });\n          });\n\n          return;\n        }\n\n        resolve({\n          namedDest: '',\n          explicitDest: dest\n        });\n      }).then(function (data) {\n        if (!Array.isArray(data.explicitDest)) {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(data.explicitDest, \"\\\" is\") + \" not a valid destination array, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        goToDestination(data);\n      });\n    }\n  }, {\n    key: \"getDestinationHash\",\n    value: function getDestinationHash(dest) {\n      if (typeof dest === 'string') {\n        return this.getAnchorUrl('#' + escape(dest));\n      }\n\n      if (Array.isArray(dest)) {\n        var str = JSON.stringify(dest);\n        return this.getAnchorUrl('#' + escape(str));\n      }\n\n      return this.getAnchorUrl('');\n    }\n  }, {\n    key: \"getAnchorUrl\",\n    value: function getAnchorUrl(anchor) {\n      return (this.baseUrl || '') + anchor;\n    }\n  }, {\n    key: \"setHash\",\n    value: function setHash(hash) {\n      var pageNumber, dest;\n\n      if (hash.includes('=')) {\n        var params = (0, _ui_utils.parseQueryString)(hash);\n\n        if ('search' in params) {\n          this.eventBus.dispatch('findfromurlhash', {\n            source: this,\n            query: params['search'].replace(/\"/g, ''),\n            phraseSearch: params['phrase'] === 'true'\n          });\n        }\n\n        if ('nameddest' in params) {\n          this.navigateTo(params.nameddest);\n          return;\n        }\n\n        if ('page' in params) {\n          pageNumber = params.page | 0 || 1;\n        }\n\n        if ('zoom' in params) {\n          var zoomArgs = params.zoom.split(',');\n          var zoomArg = zoomArgs[0];\n          var zoomArgNumber = parseFloat(zoomArg);\n\n          if (!zoomArg.includes('Fit')) {\n            dest = [null, {\n              name: 'XYZ'\n            }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null, zoomArgs.length > 2 ? zoomArgs[2] | 0 : null, zoomArgNumber ? zoomArgNumber / 100 : zoomArg];\n          } else {\n            if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n              dest = [null, {\n                name: zoomArg\n              }];\n            } else if (zoomArg === 'FitH' || zoomArg === 'FitBH' || zoomArg === 'FitV' || zoomArg === 'FitBV') {\n              dest = [null, {\n                name: zoomArg\n              }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null];\n            } else if (zoomArg === 'FitR') {\n              if (zoomArgs.length !== 5) {\n                console.error('PDFLinkService.setHash: Not enough parameters for \"FitR\".');\n              } else {\n                dest = [null, {\n                  name: zoomArg\n                }, zoomArgs[1] | 0, zoomArgs[2] | 0, zoomArgs[3] | 0, zoomArgs[4] | 0];\n              }\n            } else {\n              console.error(\"PDFLinkService.setHash: \\\"\".concat(zoomArg, \"\\\" is not \") + 'a valid zoom value.');\n            }\n          }\n        }\n\n        if (dest) {\n          this.pdfViewer.scrollPageIntoView({\n            pageNumber: pageNumber || this.page,\n            destArray: dest,\n            allowNegativeOffset: true\n          });\n        } else if (pageNumber) {\n          this.page = pageNumber;\n        }\n\n        if ('pagemode' in params) {\n          this.eventBus.dispatch('pagemode', {\n            source: this,\n            mode: params.pagemode\n          });\n        }\n      } else {\n        dest = unescape(hash);\n\n        try {\n          dest = JSON.parse(dest);\n\n          if (!Array.isArray(dest)) {\n            dest = dest.toString();\n          }\n        } catch (ex) {}\n\n        if (typeof dest === 'string' || isValidExplicitDestination(dest)) {\n          this.navigateTo(dest);\n          return;\n        }\n\n        console.error(\"PDFLinkService.setHash: \\\"\".concat(unescape(hash), \"\\\" is not \") + 'a valid destination.');\n      }\n    }\n  }, {\n    key: \"executeNamedAction\",\n    value: function executeNamedAction(action) {\n      switch (action) {\n        case 'GoBack':\n          if (this.pdfHistory) {\n            this.pdfHistory.back();\n          }\n\n          break;\n\n        case 'GoForward':\n          if (this.pdfHistory) {\n            this.pdfHistory.forward();\n          }\n\n          break;\n\n        case 'NextPage':\n          if (this.page < this.pagesCount) {\n            this.page++;\n          }\n\n          break;\n\n        case 'PrevPage':\n          if (this.page > 1) {\n            this.page--;\n          }\n\n          break;\n\n        case 'LastPage':\n          this.page = this.pagesCount;\n          break;\n\n        case 'FirstPage':\n          this.page = 1;\n          break;\n\n        default:\n          break;\n      }\n\n      this.eventBus.dispatch('namedaction', {\n        source: this,\n        action: action\n      });\n    }\n  }, {\n    key: \"cachePageRef\",\n    value: function cachePageRef(pageNum, pageRef) {\n      if (!pageRef) {\n        return;\n      }\n\n      var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n      this._pagesRefCache[refStr] = pageNum;\n    }\n  }, {\n    key: \"_cachedPageNumber\",\n    value: function _cachedPageNumber(pageRef) {\n      var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n      return this._pagesRefCache && this._pagesRefCache[refStr] || null;\n    }\n  }, {\n    key: \"isPageVisible\",\n    value: function isPageVisible(pageNumber) {\n      return this.pdfViewer.isPageVisible(pageNumber);\n    }\n  }, {\n    key: \"pagesCount\",\n    get: function get() {\n      return this.pdfDocument ? this.pdfDocument.numPages : 0;\n    }\n  }, {\n    key: \"page\",\n    get: function get() {\n      return this.pdfViewer.currentPageNumber;\n    },\n    set: function set(value) {\n      this.pdfViewer.currentPageNumber = value;\n    }\n  }, {\n    key: \"rotation\",\n    get: function get() {\n      return this.pdfViewer.pagesRotation;\n    },\n    set: function set(value) {\n      this.pdfViewer.pagesRotation = value;\n    }\n  }]);\n\n  return PDFLinkService;\n}();\n\nexports.PDFLinkService = PDFLinkService;\n\nfunction isValidExplicitDestination(dest) {\n  if (!Array.isArray(dest)) {\n    return false;\n  }\n\n  var destLength = dest.length,\n      allowNull = true;\n\n  if (destLength < 2) {\n    return false;\n  }\n\n  var page = dest[0];\n\n  if (!(_typeof(page) === 'object' && Number.isInteger(page.num) && Number.isInteger(page.gen)) && !(Number.isInteger(page) && page >= 0)) {\n    return false;\n  }\n\n  var zoom = dest[1];\n\n  if (!(_typeof(zoom) === 'object' && typeof zoom.name === 'string')) {\n    return false;\n  }\n\n  switch (zoom.name) {\n    case 'XYZ':\n      if (destLength !== 5) {\n        return false;\n      }\n\n      break;\n\n    case 'Fit':\n    case 'FitB':\n      return destLength === 2;\n\n    case 'FitH':\n    case 'FitBH':\n    case 'FitV':\n    case 'FitBV':\n      if (destLength !== 3) {\n        return false;\n      }\n\n      break;\n\n    case 'FitR':\n      if (destLength !== 6) {\n        return false;\n      }\n\n      allowNull = false;\n      break;\n\n    default:\n      return false;\n  }\n\n  for (var i = 2; i < destLength; i++) {\n    var param = dest[i];\n\n    if (!(typeof param === 'number' || allowNull && param === null)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar SimpleLinkService = /*#__PURE__*/function () {\n  function SimpleLinkService() {\n    _classCallCheck(this, SimpleLinkService);\n\n    this.externalLinkTarget = null;\n    this.externalLinkRel = null;\n  }\n\n  _createClass(SimpleLinkService, [{\n    key: \"navigateTo\",\n    value: function navigateTo(dest) {}\n  }, {\n    key: \"getDestinationHash\",\n    value: function getDestinationHash(dest) {\n      return '#';\n    }\n  }, {\n    key: \"getAnchorUrl\",\n    value: function getAnchorUrl(hash) {\n      return '#';\n    }\n  }, {\n    key: \"setHash\",\n    value: function setHash(hash) {}\n  }, {\n    key: \"executeNamedAction\",\n    value: function executeNamedAction(action) {}\n  }, {\n    key: \"cachePageRef\",\n    value: function cachePageRef(pageNum, pageRef) {}\n  }, {\n    key: \"isPageVisible\",\n    value: function isPageVisible(pageNumber) {\n      return true;\n    }\n  }, {\n    key: \"pagesCount\",\n    get: function get() {\n      return 0;\n    }\n  }, {\n    key: \"page\",\n    get: function get() {\n      return 0;\n    },\n    set: function set(value) {}\n  }, {\n    key: \"rotation\",\n    get: function get() {\n      return 0;\n    },\n    set: function set(value) {}\n  }]);\n\n  return SimpleLinkService;\n}();\n\nexports.SimpleLinkService = SimpleLinkService;","map":{"version":3,"sources":["/mnt/c/Users/Dell/Desktop/KhanaWeb/KhanaShana-Client/node_modules/pdfjs-dist/lib/web/pdf_link_service.js"],"names":["Object","defineProperty","exports","value","SimpleLinkService","PDFLinkService","_ui_utils","require","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_ref","arguments","undefined","eventBus","_ref$externalLinkTarg","externalLinkTarget","_ref$externalLinkRel","externalLinkRel","getGlobalEventBus","baseUrl","pdfDocument","pdfViewer","pdfHistory","_pagesRefCache","setDocument","create","setViewer","setHistory","navigateTo","dest","_this","goToDestination","_ref2","namedDest","explicitDest","destRef","pageNumber","_cachedPageNumber","getPageIndex","then","pageIndex","cachePageRef","catch","console","error","concat","Number","isInteger","pagesCount","pushCurrentPosition","push","scrollPageIntoView","destArray","Promise","resolve","reject","getDestination","data","Array","isArray","getDestinationHash","getAnchorUrl","escape","str","JSON","stringify","anchor","setHash","hash","includes","params","parseQueryString","dispatch","source","query","replace","phraseSearch","nameddest","page","zoomArgs","zoom","split","zoomArg","zoomArgNumber","parseFloat","name","allowNegativeOffset","mode","pagemode","unescape","parse","toString","ex","isValidExplicitDestination","executeNamedAction","action","back","forward","pageNum","pageRef","refStr","num","gen","isPageVisible","get","numPages","currentPageNumber","set","pagesRotation","destLength","allowNull","param"],"mappings":"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","sourcesContent":["/**\n * @licstart The following is the entire license notice for the\n * Javascript code in this page\n *\n * Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * @licend The above is the entire license notice for the\n * Javascript code in this page\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SimpleLinkService = exports.PDFLinkService = void 0;\n\nvar _ui_utils = require(\"./ui_utils\");\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar PDFLinkService =\n/*#__PURE__*/\nfunction () {\n  function PDFLinkService() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        eventBus = _ref.eventBus,\n        _ref$externalLinkTarg = _ref.externalLinkTarget,\n        externalLinkTarget = _ref$externalLinkTarg === void 0 ? null : _ref$externalLinkTarg,\n        _ref$externalLinkRel = _ref.externalLinkRel,\n        externalLinkRel = _ref$externalLinkRel === void 0 ? null : _ref$externalLinkRel;\n\n    _classCallCheck(this, PDFLinkService);\n\n    this.eventBus = eventBus || (0, _ui_utils.getGlobalEventBus)();\n    this.externalLinkTarget = externalLinkTarget;\n    this.externalLinkRel = externalLinkRel;\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n    this._pagesRefCache = null;\n  }\n\n  _createClass(PDFLinkService, [{\n    key: \"setDocument\",\n    value: function setDocument(pdfDocument) {\n      var baseUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.baseUrl = baseUrl;\n      this.pdfDocument = pdfDocument;\n      this._pagesRefCache = Object.create(null);\n    }\n  }, {\n    key: \"setViewer\",\n    value: function setViewer(pdfViewer) {\n      this.pdfViewer = pdfViewer;\n    }\n  }, {\n    key: \"setHistory\",\n    value: function setHistory(pdfHistory) {\n      this.pdfHistory = pdfHistory;\n    }\n  }, {\n    key: \"navigateTo\",\n    value: function navigateTo(dest) {\n      var _this = this;\n\n      var goToDestination = function goToDestination(_ref2) {\n        var namedDest = _ref2.namedDest,\n            explicitDest = _ref2.explicitDest;\n        var destRef = explicitDest[0],\n            pageNumber;\n\n        if (destRef instanceof Object) {\n          pageNumber = _this._cachedPageNumber(destRef);\n\n          if (pageNumber === null) {\n            _this.pdfDocument.getPageIndex(destRef).then(function (pageIndex) {\n              _this.cachePageRef(pageIndex + 1, destRef);\n\n              goToDestination({\n                namedDest: namedDest,\n                explicitDest: explicitDest\n              });\n            }).catch(function () {\n              console.error(\"PDFLinkService.navigateTo: \\\"\".concat(destRef, \"\\\" is not \") + \"a valid page reference, for dest=\\\"\".concat(dest, \"\\\".\"));\n            });\n\n            return;\n          }\n        } else if (Number.isInteger(destRef)) {\n          pageNumber = destRef + 1;\n        } else {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(destRef, \"\\\" is not \") + \"a valid destination reference, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        if (!pageNumber || pageNumber < 1 || pageNumber > _this.pagesCount) {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(pageNumber, \"\\\" is not \") + \"a valid page number, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        if (_this.pdfHistory) {\n          _this.pdfHistory.pushCurrentPosition();\n\n          _this.pdfHistory.push({\n            namedDest: namedDest,\n            explicitDest: explicitDest,\n            pageNumber: pageNumber\n          });\n        }\n\n        _this.pdfViewer.scrollPageIntoView({\n          pageNumber: pageNumber,\n          destArray: explicitDest\n        });\n      };\n\n      new Promise(function (resolve, reject) {\n        if (typeof dest === 'string') {\n          _this.pdfDocument.getDestination(dest).then(function (destArray) {\n            resolve({\n              namedDest: dest,\n              explicitDest: destArray\n            });\n          });\n\n          return;\n        }\n\n        resolve({\n          namedDest: '',\n          explicitDest: dest\n        });\n      }).then(function (data) {\n        if (!Array.isArray(data.explicitDest)) {\n          console.error(\"PDFLinkService.navigateTo: \\\"\".concat(data.explicitDest, \"\\\" is\") + \" not a valid destination array, for dest=\\\"\".concat(dest, \"\\\".\"));\n          return;\n        }\n\n        goToDestination(data);\n      });\n    }\n  }, {\n    key: \"getDestinationHash\",\n    value: function getDestinationHash(dest) {\n      if (typeof dest === 'string') {\n        return this.getAnchorUrl('#' + escape(dest));\n      }\n\n      if (Array.isArray(dest)) {\n        var str = JSON.stringify(dest);\n        return this.getAnchorUrl('#' + escape(str));\n      }\n\n      return this.getAnchorUrl('');\n    }\n  }, {\n    key: \"getAnchorUrl\",\n    value: function getAnchorUrl(anchor) {\n      return (this.baseUrl || '') + anchor;\n    }\n  }, {\n    key: \"setHash\",\n    value: function setHash(hash) {\n      var pageNumber, dest;\n\n      if (hash.includes('=')) {\n        var params = (0, _ui_utils.parseQueryString)(hash);\n\n        if ('search' in params) {\n          this.eventBus.dispatch('findfromurlhash', {\n            source: this,\n            query: params['search'].replace(/\"/g, ''),\n            phraseSearch: params['phrase'] === 'true'\n          });\n        }\n\n        if ('nameddest' in params) {\n          this.navigateTo(params.nameddest);\n          return;\n        }\n\n        if ('page' in params) {\n          pageNumber = params.page | 0 || 1;\n        }\n\n        if ('zoom' in params) {\n          var zoomArgs = params.zoom.split(',');\n          var zoomArg = zoomArgs[0];\n          var zoomArgNumber = parseFloat(zoomArg);\n\n          if (!zoomArg.includes('Fit')) {\n            dest = [null, {\n              name: 'XYZ'\n            }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null, zoomArgs.length > 2 ? zoomArgs[2] | 0 : null, zoomArgNumber ? zoomArgNumber / 100 : zoomArg];\n          } else {\n            if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n              dest = [null, {\n                name: zoomArg\n              }];\n            } else if (zoomArg === 'FitH' || zoomArg === 'FitBH' || zoomArg === 'FitV' || zoomArg === 'FitBV') {\n              dest = [null, {\n                name: zoomArg\n              }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null];\n            } else if (zoomArg === 'FitR') {\n              if (zoomArgs.length !== 5) {\n                console.error('PDFLinkService.setHash: Not enough parameters for \"FitR\".');\n              } else {\n                dest = [null, {\n                  name: zoomArg\n                }, zoomArgs[1] | 0, zoomArgs[2] | 0, zoomArgs[3] | 0, zoomArgs[4] | 0];\n              }\n            } else {\n              console.error(\"PDFLinkService.setHash: \\\"\".concat(zoomArg, \"\\\" is not \") + 'a valid zoom value.');\n            }\n          }\n        }\n\n        if (dest) {\n          this.pdfViewer.scrollPageIntoView({\n            pageNumber: pageNumber || this.page,\n            destArray: dest,\n            allowNegativeOffset: true\n          });\n        } else if (pageNumber) {\n          this.page = pageNumber;\n        }\n\n        if ('pagemode' in params) {\n          this.eventBus.dispatch('pagemode', {\n            source: this,\n            mode: params.pagemode\n          });\n        }\n      } else {\n        dest = unescape(hash);\n\n        try {\n          dest = JSON.parse(dest);\n\n          if (!Array.isArray(dest)) {\n            dest = dest.toString();\n          }\n        } catch (ex) {}\n\n        if (typeof dest === 'string' || isValidExplicitDestination(dest)) {\n          this.navigateTo(dest);\n          return;\n        }\n\n        console.error(\"PDFLinkService.setHash: \\\"\".concat(unescape(hash), \"\\\" is not \") + 'a valid destination.');\n      }\n    }\n  }, {\n    key: \"executeNamedAction\",\n    value: function executeNamedAction(action) {\n      switch (action) {\n        case 'GoBack':\n          if (this.pdfHistory) {\n            this.pdfHistory.back();\n          }\n\n          break;\n\n        case 'GoForward':\n          if (this.pdfHistory) {\n            this.pdfHistory.forward();\n          }\n\n          break;\n\n        case 'NextPage':\n          if (this.page < this.pagesCount) {\n            this.page++;\n          }\n\n          break;\n\n        case 'PrevPage':\n          if (this.page > 1) {\n            this.page--;\n          }\n\n          break;\n\n        case 'LastPage':\n          this.page = this.pagesCount;\n          break;\n\n        case 'FirstPage':\n          this.page = 1;\n          break;\n\n        default:\n          break;\n      }\n\n      this.eventBus.dispatch('namedaction', {\n        source: this,\n        action: action\n      });\n    }\n  }, {\n    key: \"cachePageRef\",\n    value: function cachePageRef(pageNum, pageRef) {\n      if (!pageRef) {\n        return;\n      }\n\n      var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n      this._pagesRefCache[refStr] = pageNum;\n    }\n  }, {\n    key: \"_cachedPageNumber\",\n    value: function _cachedPageNumber(pageRef) {\n      var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n      return this._pagesRefCache && this._pagesRefCache[refStr] || null;\n    }\n  }, {\n    key: \"isPageVisible\",\n    value: function isPageVisible(pageNumber) {\n      return this.pdfViewer.isPageVisible(pageNumber);\n    }\n  }, {\n    key: \"pagesCount\",\n    get: function get() {\n      return this.pdfDocument ? this.pdfDocument.numPages : 0;\n    }\n  }, {\n    key: \"page\",\n    get: function get() {\n      return this.pdfViewer.currentPageNumber;\n    },\n    set: function set(value) {\n      this.pdfViewer.currentPageNumber = value;\n    }\n  }, {\n    key: \"rotation\",\n    get: function get() {\n      return this.pdfViewer.pagesRotation;\n    },\n    set: function set(value) {\n      this.pdfViewer.pagesRotation = value;\n    }\n  }]);\n\n  return PDFLinkService;\n}();\n\nexports.PDFLinkService = PDFLinkService;\n\nfunction isValidExplicitDestination(dest) {\n  if (!Array.isArray(dest)) {\n    return false;\n  }\n\n  var destLength = dest.length,\n      allowNull = true;\n\n  if (destLength < 2) {\n    return false;\n  }\n\n  var page = dest[0];\n\n  if (!(_typeof(page) === 'object' && Number.isInteger(page.num) && Number.isInteger(page.gen)) && !(Number.isInteger(page) && page >= 0)) {\n    return false;\n  }\n\n  var zoom = dest[1];\n\n  if (!(_typeof(zoom) === 'object' && typeof zoom.name === 'string')) {\n    return false;\n  }\n\n  switch (zoom.name) {\n    case 'XYZ':\n      if (destLength !== 5) {\n        return false;\n      }\n\n      break;\n\n    case 'Fit':\n    case 'FitB':\n      return destLength === 2;\n\n    case 'FitH':\n    case 'FitBH':\n    case 'FitV':\n    case 'FitBV':\n      if (destLength !== 3) {\n        return false;\n      }\n\n      break;\n\n    case 'FitR':\n      if (destLength !== 6) {\n        return false;\n      }\n\n      allowNull = false;\n      break;\n\n    default:\n      return false;\n  }\n\n  for (var i = 2; i < destLength; i++) {\n    var param = dest[i];\n\n    if (!(typeof param === 'number' || allowNull && param === null)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar SimpleLinkService =\n/*#__PURE__*/\nfunction () {\n  function SimpleLinkService() {\n    _classCallCheck(this, SimpleLinkService);\n\n    this.externalLinkTarget = null;\n    this.externalLinkRel = null;\n  }\n\n  _createClass(SimpleLinkService, [{\n    key: \"navigateTo\",\n    value: function navigateTo(dest) {}\n  }, {\n    key: \"getDestinationHash\",\n    value: function getDestinationHash(dest) {\n      return '#';\n    }\n  }, {\n    key: \"getAnchorUrl\",\n    value: function getAnchorUrl(hash) {\n      return '#';\n    }\n  }, {\n    key: \"setHash\",\n    value: function setHash(hash) {}\n  }, {\n    key: \"executeNamedAction\",\n    value: function executeNamedAction(action) {}\n  }, {\n    key: \"cachePageRef\",\n    value: function cachePageRef(pageNum, pageRef) {}\n  }, {\n    key: \"isPageVisible\",\n    value: function isPageVisible(pageNumber) {\n      return true;\n    }\n  }, {\n    key: \"pagesCount\",\n    get: function get() {\n      return 0;\n    }\n  }, {\n    key: \"page\",\n    get: function get() {\n      return 0;\n    },\n    set: function set(value) {}\n  }, {\n    key: \"rotation\",\n    get: function get() {\n      return 0;\n    },\n    set: function set(value) {}\n  }]);\n\n  return SimpleLinkService;\n}();\n\nexports.SimpleLinkService = SimpleLinkService;"]},"metadata":{},"sourceType":"script"}