{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isNumber from \"lodash/isNumber\";\nimport _isString from \"lodash/isString\";\nimport _get from \"lodash/get\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _isArray from \"lodash/isArray\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { shallowEqual } from 'rsuite-utils/lib/utils';\nimport TreeNode from './TreeNode';\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction } from '../utils';\nimport { flattenTree, shouldDisplay, getNodeParents, shouldShowNodeByExpanded, getVirtualLisHeight, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState } from '../utils/treeUtils';\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction } from '../Picker';\nimport { PLACEMENT } from '../constants'; // default value for virtualized\n\nvar defaultHeight = 360;\nvar defaultWidth = 200;\n\nvar TreePicker = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(TreePicker, _React$Component);\n\n  function TreePicker(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.menuRef = void 0;\n    _this.treeViewRef = void 0;\n    _this.positionRef = void 0;\n    _this.listRef = void 0;\n    _this.triggerRef = void 0;\n    _this.toggleRef = void 0;\n\n    _this.getFocusableMenuItems = function () {\n      var filterData = _this.state.filterData;\n      var _this$props = _this.props,\n          childrenKey = _this$props.childrenKey,\n          _this$props$disabledI = _this$props.disabledItemValues,\n          disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\n          valueKey = _this$props.valueKey;\n      var items = [];\n\n      var loop = function loop(nodes) {\n        nodes.forEach(function (node) {\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\n\n          var disabled = disabledItemValues.some(function (disabledItem) {\n            return shallowEqual(disabledItem, node[valueKey]);\n          });\n\n          if (!disabled) {\n            items.push(node);\n          }\n\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\n            loop(node[childrenKey]);\n          }\n        });\n      };\n\n      loop(filterData);\n      return items;\n    };\n\n    _this.getElementByDataKey = function (dataKey) {\n      var ele = _this.nodeRefs[dataKey];\n\n      if (ele instanceof Element) {\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\n      }\n\n      return null;\n    };\n\n    _this.nodes = {};\n    _this.node = null;\n    _this.tempNode = [];\n    _this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: 20\n    });\n    _this.nodeRefs = {};\n\n    _this.bindNodeRefs = function (refKey, ref) {\n      _this.nodeRefs[refKey] = ref;\n    };\n\n    _this.getPositionInstance = function () {\n      return _this.positionRef.current;\n    };\n\n    _this.getToggleInstance = function () {\n      return _this.toggleRef.current;\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.addTreePrefix = function (name) {\n      return prefix(defaultClassPrefix('tree'))(name);\n    };\n\n    _this.selectActiveItem = function (event) {\n      var _this$getActiveItem = _this.getActiveItem(),\n          nodeData = _this$getActiveItem.nodeData,\n          layer = _this$getActiveItem.layer;\n\n      _this.handleSelect(nodeData, +layer, event);\n    };\n\n    _this.focusNextItem = function () {\n      var _node$focus;\n\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi.items,\n          activeIndex = _this$getItemsAndActi.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\n\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\n    };\n\n    _this.focusPreviousItem = function () {\n      var _node$focus2;\n\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi2.items,\n          activeIndex = _this$getItemsAndActi2.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\n\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\n    };\n\n    _this.handleCloseDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.hide();\n      }\n    };\n\n    _this.handleOpenDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.show();\n      }\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleToggleDropdown = function () {\n      var active = _this.state.active;\n\n      if (active) {\n        _this.handleCloseDropdown();\n\n        return;\n      }\n\n      _this.handleOpenDropdown();\n    };\n\n    _this.handleToggle = function (nodeData) {\n      var _this$props2 = _this.props,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey,\n          onExpand = _this$props2.onExpand,\n          expandItemValues = _this$props2.expandItemValues;\n\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\n\n      if (_isUndefined(expandItemValues)) {\n        _this.unserializeLists('expand', nextExpandItemValues);\n\n        _this.setState({\n          expandItemValues: nextExpandItemValues\n        });\n      }\n\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }));\n    };\n\n    _this.handleSelect = function (nodeData, layer, event) {\n      var _this$toggleRef$curre;\n\n      var _this$props3 = _this.props,\n          valueKey = _this$props3.valueKey,\n          onChange = _this$props3.onChange,\n          onSelect = _this$props3.onSelect,\n          value = _this$props3.value;\n      _this.node = nodeData;\n\n      if (_isUndefined(value)) {\n        _this.setState({\n          activeNode: nodeData,\n          selectedValue: nodeData[valueKey]\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, layer, event);\n\n      _this.handleCloseDropdown();\n\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\n    };\n\n    _this.handleKeyDown = function (event) {\n      onMenuKeyDown(event, {\n        down: _this.focusNextItem,\n        up: _this.focusPreviousItem,\n        enter: _this.selectActiveItem,\n        del: _this.handleClean\n      });\n    };\n\n    _this.handleToggleKeyDown = function (event) {\n      var _this$state = _this.state,\n          activeNode = _this$state.activeNode,\n          active = _this$state.active; // enter\n\n      if ((!activeNode || !active) && event.keyCode === 13) {\n        _this.handleToggleDropdown();\n      } // delete\n\n\n      if (event.keyCode === 8) {\n        _this.handleClean(event);\n      }\n\n      if (!_this.treeViewRef.current) {\n        return;\n      }\n\n      if (event.target instanceof HTMLElement) {\n        var className = event.target.className;\n\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\n          onMenuKeyDown(event, {\n            down: _this.focusNextItem\n          });\n        }\n      }\n    };\n\n    _this.handleSearch = function (value, event) {\n      var filterData = _this.state.filterData;\n      var _this$props4 = _this.props,\n          onSearch = _this$props4.onSearch,\n          searchKeyword = _this$props4.searchKeyword;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: value,\n          filterData: _this.getFilterData(filterData, value)\n        });\n      }\n\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props$onChange, _this$props5;\n\n      _this.setState({\n        activeNode: null,\n        selectedValue: null\n      });\n\n      _this.node = null;\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\n    };\n\n    _this.handleOnOpen = function () {\n      var _this$props$onOpen, _this$props6;\n\n      var activeNode = _this.state.activeNode;\n\n      if (activeNode) {\n        var _node$focus3;\n\n        var node = _this.getElementByDataKey(activeNode.refKey);\n\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\n      }\n\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleOnClose = function () {\n      var filterData = _this.state.filterData;\n      var _this$props7 = _this.props,\n          searchKeyword = _this$props7.searchKeyword,\n          onClose = _this$props7.onClose;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: '',\n          filterData: _this.getFilterData(filterData, '')\n        });\n      }\n\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n\n      _this.setState({\n        active: false\n      });\n    };\n\n    _this.measureRowRenderer = function (nodes) {\n      return function (_ref) {\n        var key = _ref.key,\n            index = _ref.index,\n            style = _ref.style,\n            parent = _ref.parent;\n        var node = nodes[index];\n        return React.createElement(CellMeasurer, {\n          cache: _this.cache,\n          columnIndex: 0,\n          key: key,\n          rowIndex: index,\n          parent: parent\n        }, function () {\n          return _this.renderVirtualNode(node, {\n            key: key,\n            style: style\n          });\n        });\n      };\n    };\n\n    var _value = props.value,\n        data = props.data,\n        _valueKey = props.valueKey,\n        _props$searchKeyword = props.searchKeyword,\n        _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\n\n    var nextData = [].concat(data);\n\n    var _nextExpandItemValues = getExpandItemValues(props);\n\n    _this.flattenNodes(nextData);\n\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\n\n    _this.state = {\n      data: data,\n      value: _value,\n      selectedValue: _this.getValue(props),\n      expandAll: getExpandAll(props),\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\n      searchKeyword: _searchKeyword,\n      expandItemValues: _this.serializeList('expand')\n    };\n    _this.treeViewRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.listRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    _this.toggleRef = React.createRef(); // for test\n\n    _this.menuRef = React.createRef();\n    treeDeprecatedWarning(props, ['expandAll']);\n    return _this;\n  }\n\n  var _proto = TreePicker.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var activeNode = this.state.activeNode;\n    this.focusNode(activeNode);\n  };\n\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n        data = nextProps.data,\n        expandAll = nextProps.expandAll,\n        searchKeyword = nextProps.searchKeyword,\n        expandItemValues = nextProps.expandItemValues;\n    var nextState = {};\n\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\n      nextState.data = data;\n    }\n\n    if (!shallowEqual(value, prevState.value)) {\n      nextState.value = value;\n      nextState.selectedValue = value;\n    }\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      nextState.expandItemValues = expandItemValues;\n    }\n\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\n      nextState.searchKeyword = searchKeyword;\n    }\n\n    if (expandAll !== prevState.expandAll) {\n      nextState.expandAll = expandAll;\n    }\n\n    return Object.keys(nextState).length ? nextState : null;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\n    this.updateDataChange(prevState);\n    this.updateValueChange(prevState);\n    this.updateExpandItemValuesChange(prevState);\n    this.updateSearchKeywordChange(prevState);\n\n    if (this.listRef.current) {\n      this.listRef.current.forceUpdateGrid();\n    }\n  };\n\n  _proto.updateDataChange = function updateDataChange(prevState) {\n    var _this$state2 = this.state,\n        searchKeyword = _this$state2.searchKeyword,\n        expandItemValues = _this$state2.expandItemValues;\n    var data = this.props.data;\n\n    if (prevState.data !== data) {\n      var nextData = [].concat(data);\n      this.flattenNodes(nextData);\n      var filterData = this.getFilterData(nextData, searchKeyword);\n      var activeNode = this.getActiveNode(this.getValue());\n      this.focusNode(activeNode);\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        data: nextData,\n        filterData: filterData,\n        activeNode: activeNode,\n        expandItemValues: this.serializeList('expand')\n      });\n    }\n  };\n\n  _proto.updateValueChange = function updateValueChange(prevState) {\n    var _this$props8 = this.props,\n        value = _this$props8.value,\n        valueKey = _this$props8.valueKey;\n\n    if (!shallowEqual(prevState.value, value)) {\n      var activeNode = null;\n\n      if (this.node === null) {\n        activeNode = this.getActiveNode(value);\n      }\n\n      if (value !== null && this.node !== null) {\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\n      }\n\n      var nextState = {\n        value: value,\n        activeNode: activeNode\n      };\n\n      if (value === null) {\n        nextState.activeNode = null;\n        this.node = null;\n      }\n\n      if (activeNode !== null) {\n        this.focusNode(activeNode);\n      }\n\n      this.setState(nextState);\n    }\n  };\n\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\n    var expandItemValues = this.props.expandItemValues;\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        expandItemValues: expandItemValues\n      });\n    }\n  };\n\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\n    var filterData = this.state.filterData;\n\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\n      this.setState({\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\n      });\n    }\n  };\n\n  _proto.getValue = function getValue(props) {\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props = props,\n        value = _props.value,\n        defaultValue = _props.defaultValue;\n    return !_isUndefined(value) ? value : defaultValue;\n  };\n\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\n    var _this4 = this;\n\n    if (valueKey === void 0) {\n      valueKey = this.props.valueKey;\n    }\n\n    var activeNode = null;\n\n    if (!_isUndefined(value)) {\n      Object.keys(this.nodes).forEach(function (refKey) {\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\n          activeNode = _this4.nodes[refKey];\n        }\n      });\n    }\n\n    return activeNode;\n  };\n\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\n    var childrenKey = this.props.childrenKey;\n\n    for (var i = 0; i < options.length; i += 1) {\n      var _options$i$childrenKe;\n\n      if (options[i].value === value) {\n        return options[i];\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\n\n        if (!_isEmpty(active)) {\n          return active;\n        }\n      }\n    }\n\n    return {};\n  };\n\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\n    var items = this.getFocusableMenuItems();\n    var activeIndex = -1;\n    items.forEach(function (item, index) {\n      if (document.activeElement !== null) {\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\n          activeIndex = index;\n        }\n      }\n    });\n    return {\n      items: items,\n      activeIndex: activeIndex\n    };\n  };\n\n  _proto.getActiveItem = function getActiveItem() {\n    var nodeData = {};\n    var activeItem = document.activeElement;\n\n    if (activeItem !== null) {\n      var _get2 = _get(activeItem, 'dataset'),\n          key = _get2.key,\n          layer = _get2.layer;\n\n      var activeNode = this.nodes[key];\n\n      if (activeNode) {\n        nodeData = activeNode;\n      }\n\n      return {\n        nodeData: nodeData,\n        layer: layer\n      };\n    }\n\n    return {};\n  };\n\n  _proto.getFilterData = function getFilterData(data, word, props) {\n    if (word === void 0) {\n      word = '';\n    }\n\n    var _ref2 = props || this.props,\n        labelKey = _ref2.labelKey,\n        childrenKey = _ref2.childrenKey;\n\n    var setVisible = function setVisible(nodes) {\n      if (nodes === void 0) {\n        nodes = [];\n      }\n\n      return nodes.forEach(function (item) {\n        item.visible = shouldDisplay(item[labelKey], word);\n\n        if (_isArray(item[childrenKey])) {\n          setVisible(item[childrenKey]);\n          item[childrenKey].forEach(function (child) {\n            if (child.visible) {\n              item.visible = child.visible;\n            }\n          });\n        }\n      });\n    };\n\n    if (!_isUndefined(word)) {\n      setVisible(data);\n    }\n\n    return data;\n  };\n\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\n    var _this5 = this;\n\n    var expandItemValues = this.state.expandItemValues;\n    var _this$props9 = this.props,\n        childrenKey = _this$props9.childrenKey,\n        valueKey = _this$props9.valueKey;\n    return flattenTree(nodes, childrenKey, function (node) {\n      var formatted = {};\n      var curNode = _this5.nodes[node.refKey];\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\n\n      if (curNode) {\n        formatted = _extends({}, node, {\n          expand: curNode.expand,\n          layer: curNode.layer,\n          parentNode: curNode.parentNode,\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\n        });\n      }\n\n      return formatted;\n    });\n  };\n\n  _proto.focusNode = function focusNode(activeNode) {\n    var inline = this.props.inline;\n\n    if (activeNode && inline) {\n      var _node$focus4;\n\n      var node = this.getElementByDataKey(activeNode.refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\n    }\n  };\n\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\n    var _this6 = this;\n\n    if (ref === void 0) {\n      ref = '0';\n    }\n\n    if (layer === void 0) {\n      layer = 0;\n    }\n\n    var _ref3 = props || this.props,\n        labelKey = _ref3.labelKey,\n        valueKey = _ref3.valueKey,\n        childrenKey = _ref3.childrenKey;\n\n    if (!Array.isArray(nodes) || nodes.length === 0) {\n      return [];\n    }\n\n    nodes.map(function (node, index) {\n      var _this6$nodes$refKey;\n\n      var refKey = ref + \"-\" + index;\n      node.refKey = refKey;\n      _this6.nodes[refKey] = (_this6$nodes$refKey = {\n        layer: layer\n      }, _this6$nodes$refKey[labelKey] = node[labelKey], _this6$nodes$refKey[valueKey] = node[valueKey], _this6$nodes$refKey.expand = getExpandState(node, props || _this6.props), _this6$nodes$refKey.refKey = refKey, _this6$nodes$refKey);\n\n      if (parentNode) {\n        _this6.nodes[refKey].parentNode = parentNode;\n      }\n\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\n    });\n  };\n\n  _proto.serializeList = function serializeList(key, nodes) {\n    if (nodes === void 0) {\n      nodes = this.nodes;\n    }\n\n    var valueKey = this.props.valueKey;\n    var list = [];\n    Object.keys(nodes).forEach(function (refKey) {\n      if (nodes[refKey][key]) {\n        list.push(nodes[refKey][valueKey]);\n      }\n    });\n    return list;\n  };\n\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\n    var _this7 = this;\n\n    if (value === void 0) {\n      value = [];\n    }\n\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props2 = props,\n        valueKey = _props2.valueKey;\n    var expandAll = getExpandAll(props);\n    Object.keys(this.nodes).forEach(function (refKey) {\n      _this7.nodes[refKey][key] = false;\n\n      if (value.length) {\n        value.forEach(function (value) {\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\n            _this7.nodes[refKey][key] = true;\n          }\n        });\n      } else {\n        _this7.nodes[refKey][key] = expandAll;\n      }\n    });\n  };\n\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\n    var valueKey = this.props.valueKey;\n    var expandItemValues = new Set(this.serializeList('expand'));\n\n    if (isExpand) {\n      expandItemValues.add(node[valueKey]);\n    } else {\n      expandItemValues.delete(node[valueKey]);\n    }\n\n    return Array.from(expandItemValues);\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _this$props10 = this.props,\n        _this$props10$height = _this$props10.height,\n        height = _this$props10$height === void 0 ? defaultHeight : _this$props10$height,\n        searchable = _this$props10.searchable,\n        searchKeyword = _this$props10.searchKeyword,\n        renderExtraFooter = _this$props10.renderExtraFooter,\n        locale = _this$props10.locale,\n        renderMenu = _this$props10.renderMenu,\n        menuStyle = _this$props10.menuStyle,\n        virtualized = _this$props10.virtualized,\n        menuClassName = _this$props10.menuClassName,\n        menuAutoWidth = _this$props10.menuAutoWidth;\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\n    var styles = virtualized ? _extends({\n      height: height\n    }, menuStyle) : menuStyle;\n    return React.createElement(MenuWrapper, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      ref: this.menuRef,\n      getToggleInstance: this.getToggleInstance,\n      getPositionInstance: this.getPositionInstance\n    }, searchable ? React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      key: \"searchBar\",\n      onChange: this.handleSearch,\n      value: keyword\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.renderNode = function renderNode(node, index, layer) {\n    var _this8 = this;\n\n    var _this$state3 = this.state,\n        selectedValue = _this$state3.selectedValue,\n        searchKeyword = _this$state3.searchKeyword;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var _this$props11 = this.props,\n        _this$props11$disable = _this$props11.disabledItemValues,\n        disabledItemValues = _this$props11$disable === void 0 ? [] : _this$props11$disable,\n        valueKey = _this$props11.valueKey,\n        labelKey = _this$props11.labelKey,\n        locale = _this$props11.locale,\n        childrenKey = _this$props11.childrenKey,\n        renderTreeNode = _this$props11.renderTreeNode,\n        renderTreeIcon = _this$props11.renderTreeIcon;\n    var refKey = node.refKey;\n    var expand = this.nodes[node.refKey].expand;\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\n\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n    var props = {\n      rtl: locale.rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      expand: expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      children: children,\n      nodeData: _extends({}, node, {\n        expand: expand\n      }),\n      disabled: disabledItemValues.filter(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }).length > 0,\n      hasChildren: visibleChildren,\n      onSelect: this.handleSelect,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n\n    if (props.hasChildren) {\n      var _classNames;\n\n      layer += 1;\n      var expandALlState = this.nodes[node.refKey].expand; // 是否展开树节点且子节点不为空\n\n      var openClass = this.addTreePrefix('open');\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expandALlState && visibleChildren, _classNames));\n      var nodes = children || [];\n      return React.createElement(\"div\", {\n        className: childrenClass,\n        key: key,\n        ref: this.bindNodeRefs.bind(this, refKey)\n      }, React.createElement(TreeNode, props), React.createElement(\"div\", {\n        className: this.addTreePrefix('children')\n      }, nodes.map(function (child, i) {\n        return _this8.renderNode(child, i, layer);\n      })));\n    }\n\n    return React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, props));\n  };\n\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\n    var selectedValue = this.state.selectedValue;\n    var _this$props12 = this.props,\n        locale = _this$props12.locale,\n        _this$props12$disable = _this$props12.disabledItemValues,\n        disabledItemValues = _this$props12$disable === void 0 ? [] : _this$props12$disable,\n        valueKey = _this$props12.valueKey,\n        labelKey = _this$props12.labelKey,\n        childrenKey = _this$props12.childrenKey,\n        renderTreeNode = _this$props12.renderTreeNode,\n        renderTreeIcon = _this$props12.renderTreeIcon;\n    var key = options.key,\n        style = options.style;\n    var layer = node.layer,\n        refKey = node.refKey,\n        expand = node.expand,\n        showNode = node.showNode;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var children = node[childrenKey];\n    var props = {\n      rtl: locale.rtl,\n      style: style,\n      value: node[valueKey],\n      label: node[labelKey],\n      layer: layer,\n      expand: expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      nodeData: node,\n      disabled: disabledItemValues.filter(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }).length > 0,\n      children: children,\n      hasChildren: !!children,\n      onSelect: this.handleSelect,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n    return showNode && React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, props));\n  };\n\n  _proto.renderTree = function renderTree() {\n    var _classNames2,\n        _this9 = this;\n\n    var filterData = this.state.filterData;\n    var _this$props13 = this.props,\n        height = _this$props13.height,\n        _this$props13$classNa = _this$props13.className,\n        className = _this$props13$classNa === void 0 ? '' : _this$props13$classNa,\n        inline = _this$props13.inline,\n        style = _this$props13.style,\n        locale = _this$props13.locale,\n        virtualized = _this$props13.virtualized;\n    var layer = 0;\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\n    var nodes = [];\n\n    if (!virtualized) {\n      nodes = filterData.map(function (dataItem, index) {\n        return _this9.renderNode(dataItem, index, layer);\n      });\n\n      if (!nodes.some(function (v) {\n        return v !== null;\n      })) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } else {\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\n        return n.showNode && n.visible;\n      });\n\n      if (!nodes.length) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } // 当未定义 height 且 设置了 virtualized 为 true，treeHeight 设置默认高度\n\n\n    var treeHeight = _isUndefined(height) && virtualized ? defaultHeight : height;\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\n    var styles = inline ? _extends({\n      height: treeHeight\n    }, style) : {};\n    var ListHeight = getVirtualLisHeight(inline, treeHeight);\n    return React.createElement(\"div\", {\n      ref: this.treeViewRef,\n      className: classes,\n      style: styles,\n      onKeyDown: this.handleKeyDown\n    }, React.createElement(\"div\", {\n      className: this.addTreePrefix('nodes')\n    }, virtualized ? React.createElement(AutoSizer, {\n      defaultHeight: ListHeight,\n      defaultWidth: treeWidth\n    }, function (_ref4) {\n      var height = _ref4.height,\n          width = _ref4.width;\n      return React.createElement(List, {\n        ref: _this9.listRef,\n        width: width || treeWidth,\n        height: height || ListHeight,\n        rowHeight: 36,\n        rowCount: nodes.length,\n        rowRenderer: _this9.measureRowRenderer(nodes)\n      });\n    }) : nodes));\n  };\n\n  _proto.render = function render() {\n    var _this$props14 = this.props,\n        inline = _this$props14.inline,\n        locale = _this$props14.locale,\n        disabled = _this$props14.disabled,\n        toggleComponentClass = _this$props14.toggleComponentClass,\n        placeholder = _this$props14.placeholder,\n        cleanable = _this$props14.cleanable,\n        renderValue = _this$props14.renderValue,\n        valueKey = _this$props14.valueKey,\n        labelKey = _this$props14.labelKey,\n        onEntered = _this$props14.onEntered,\n        onExited = _this$props14.onExited,\n        onClean = _this$props14.onClean,\n        style = _this$props14.style,\n        rest = _objectWithoutPropertiesLoose(_this$props14, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"valueKey\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\"]);\n\n    var activeNode = this.state.activeNode;\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, !!activeNode);\n    var selectedElement = placeholder;\n    var hasValue = !!activeNode;\n\n    if (hasValue) {\n      selectedElement = activeNode === null || activeNode === void 0 ? void 0 : activeNode[labelKey];\n\n      if (renderValue && activeNode) {\n        selectedElement = renderValue(activeNode[valueKey], activeNode, selectedElement);\n      }\n    }\n\n    var unhandled = getUnhandledProps(TreePicker, rest);\n\n    if (inline) {\n      return this.renderTree();\n    }\n\n    return React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: this.positionRef,\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\n      onExit: createChainedFunction(this.handleOnClose, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      ref: this.toggleRef,\n      onKeyDown: this.handleToggleKeyDown,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      componentClass: toggleComponentClass,\n      hasValue: hasValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return TreePicker;\n}(React.Component);\n\nTreePicker.propTypes = {\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  data: PropTypes.array,\n  open: PropTypes.bool,\n  style: PropTypes.object,\n  block: PropTypes.bool,\n  value: PropTypes.any,\n  height: PropTypes.number,\n  inline: PropTypes.bool,\n  locale: PropTypes.object,\n  labelKey: PropTypes.string,\n  valueKey: PropTypes.string,\n  container: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  placement: PropTypes.oneOf(PLACEMENT),\n  disabled: PropTypes.bool,\n  className: PropTypes.string,\n  expandAll: PropTypes.bool,\n  cleanable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  classPrefix: PropTypes.string,\n  childrenKey: PropTypes.string,\n  placeholder: PropTypes.node,\n  defaultOpen: PropTypes.bool,\n  defaultValue: PropTypes.any,\n  menuStyle: PropTypes.object,\n  menuClassName: PropTypes.string,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  containerPadding: PropTypes.number,\n  disabledItemValues: PropTypes.array,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  toggleComponentClass: PropTypes.elementType,\n  onOpen: PropTypes.func,\n  onExit: PropTypes.func,\n  onEnter: PropTypes.func,\n  onClose: PropTypes.func,\n  onHide: PropTypes.func,\n  onSearch: PropTypes.func,\n  onClean: PropTypes.func,\n  onChange: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  onExited: PropTypes.func,\n  onEntered: PropTypes.func,\n  onExiting: PropTypes.func,\n  onEntering: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderValue: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func\n};\nTreePicker.defaultProps = {\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  },\n  inline: false,\n  valueKey: 'value',\n  labelKey: 'label',\n  cleanable: true,\n  placement: 'bottomStart',\n  searchable: true,\n  appearance: 'default',\n  childrenKey: 'children',\n  virtualized: false,\n  menuAutoWidth: true\n};\npolyfill(TreePicker);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(TreePicker);","map":{"version":3,"sources":["/mnt/c/Users/Dell/Desktop/KhanaWeb/khanaweb/node_modules/rsuite/es/TreePicker/TreePicker.js"],"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_isNumber","_isString","_get","_isEmpty","_isUndefined","_isArray","React","PropTypes","classNames","List","AutoSizer","CellMeasurerCache","CellMeasurer","polyfill","shallowEqual","TreeNode","defaultProps","prefix","defaultClassPrefix","getUnhandledProps","createChainedFunction","flattenTree","shouldDisplay","getNodeParents","shouldShowNodeByExpanded","getVirtualLisHeight","treeDeprecatedWarning","hasVisibleChildren","compareArray","getExpandAll","getExpandItemValues","getExpandState","PickerToggle","getToggleWrapperClassName","onMenuKeyDown","MenuWrapper","SearchBar","PickerToggleTrigger","createConcatChildrenFunction","PLACEMENT","defaultHeight","defaultWidth","TreePicker","_React$Component","props","_this","call","menuRef","treeViewRef","positionRef","listRef","triggerRef","toggleRef","getFocusableMenuItems","filterData","state","_this$props","childrenKey","_this$props$disabledI","disabledItemValues","valueKey","items","loop","nodes","forEach","node","nodeData","refKey","disabled","some","disabledItem","push","getElementByDataKey","dataKey","ele","nodeRefs","Element","querySelector","addTreePrefix","tempNode","cache","fixedWidth","minHeight","bindNodeRefs","ref","getPositionInstance","current","getToggleInstance","addPrefix","name","classPrefix","selectActiveItem","event","_this$getActiveItem","getActiveItem","layer","handleSelect","focusNextItem","_node$focus","_this$getItemsAndActi","getItemsAndActiveIndex","activeIndex","length","nextIndex","focus","focusPreviousItem","_node$focus2","_this$getItemsAndActi2","prevIndex","handleCloseDropdown","hide","handleOpenDropdown","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleToggleDropdown","active","handleToggle","_this$props2","onExpand","expandItemValues","nextExpandItemValues","toggleExpand","expand","unserializeLists","setState","_this$toggleRef$curre","_this$props3","onChange","onSelect","value","activeNode","selectedValue","onFocus","handleKeyDown","down","up","enter","del","handleClean","handleToggleKeyDown","_this$state","keyCode","target","HTMLElement","className","includes","handleSearch","_this$props4","onSearch","searchKeyword","getFilterData","_this$props$onChange","_this$props5","handleOnOpen","_this$props$onOpen","_this$props6","_node$focus3","onOpen","handleOnClose","_this$props7","onClose","measureRowRenderer","_ref","key","index","style","parent","createElement","columnIndex","rowIndex","renderVirtualNode","_value","data","_valueKey","_props$searchKeyword","_searchKeyword","nextData","concat","_nextExpandItemValues","flattenNodes","getValue","expandAll","getActiveNode","serializeList","createRef","_proto","prototype","componentDidMount","focusNode","getDerivedStateFromProps","nextProps","prevState","nextState","Object","keys","componentDidUpdate","_prevProps","updateDataChange","updateValueChange","updateExpandItemValuesChange","updateSearchKeywordChange","forceUpdateGrid","_this$state2","_this$props8","_props","defaultValue","_this4","getActiveElementOption","options","i","_options$i$childrenKe","item","document","activeElement","getAttribute","activeItem","_get2","word","_ref2","labelKey","setVisible","visible","child","getFlattenTreeData","_this5","_this$props9","formatted","curNode","parentKeys","parentNode","showNode","inline","_node$focus4","_this6","_ref3","Array","isArray","map","_this6$nodes$refKey","list","_this7","_props2","isExpand","Set","add","delete","from","renderDropdownMenu","_this$props10","_this$props10$height","height","searchable","renderExtraFooter","locale","renderMenu","menuStyle","virtualized","menuClassName","menuAutoWidth","keyword","classes","styles","autoWidth","placeholder","searchPlaceholder","renderTree","renderNode","_this8","_this$state3","_this$props11","_this$props11$disable","renderTreeNode","renderTreeIcon","children","visibleChildren","rtl","label","filter","hasChildren","onTreeToggle","onRenderTreeNode","onRenderTreeIcon","_classNames","expandALlState","openClass","childrenClass","bind","innerRef","_this$props12","_this$props12$disable","_classNames2","_this9","_this$props13","_this$props13$classNa","dataItem","v","noResultsText","n","treeHeight","treeWidth","width","ListHeight","onKeyDown","_ref4","rowHeight","rowCount","rowRenderer","render","_this$props14","toggleComponentClass","cleanable","renderValue","onEntered","onExited","onClean","rest","selectedElement","hasValue","unhandled","pickerProps","onExit","speaker","componentClass","Component","propTypes","appearance","oneOf","array","bool","object","block","any","number","string","container","oneOfType","func","placement","defaultOpen","defaultExpandAll","containerPadding","defaultExpandItemValues","elementType","onEnter","onHide","onExiting","onEntering"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isNumber from \"lodash/isNumber\";\nimport _isString from \"lodash/isString\";\nimport _get from \"lodash/get\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _isArray from \"lodash/isArray\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { shallowEqual } from 'rsuite-utils/lib/utils';\nimport TreeNode from './TreeNode';\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction } from '../utils';\nimport { flattenTree, shouldDisplay, getNodeParents, shouldShowNodeByExpanded, getVirtualLisHeight, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState } from '../utils/treeUtils';\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction } from '../Picker';\nimport { PLACEMENT } from '../constants'; // default value for virtualized\n\nvar defaultHeight = 360;\nvar defaultWidth = 200;\n\nvar TreePicker =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(TreePicker, _React$Component);\n\n  function TreePicker(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.menuRef = void 0;\n    _this.treeViewRef = void 0;\n    _this.positionRef = void 0;\n    _this.listRef = void 0;\n    _this.triggerRef = void 0;\n    _this.toggleRef = void 0;\n\n    _this.getFocusableMenuItems = function () {\n      var filterData = _this.state.filterData;\n      var _this$props = _this.props,\n          childrenKey = _this$props.childrenKey,\n          _this$props$disabledI = _this$props.disabledItemValues,\n          disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\n          valueKey = _this$props.valueKey;\n      var items = [];\n\n      var loop = function loop(nodes) {\n        nodes.forEach(function (node) {\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\n\n          var disabled = disabledItemValues.some(function (disabledItem) {\n            return shallowEqual(disabledItem, node[valueKey]);\n          });\n\n          if (!disabled) {\n            items.push(node);\n          }\n\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\n            loop(node[childrenKey]);\n          }\n        });\n      };\n\n      loop(filterData);\n      return items;\n    };\n\n    _this.getElementByDataKey = function (dataKey) {\n      var ele = _this.nodeRefs[dataKey];\n\n      if (ele instanceof Element) {\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\n      }\n\n      return null;\n    };\n\n    _this.nodes = {};\n    _this.node = null;\n    _this.tempNode = [];\n    _this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: 20\n    });\n    _this.nodeRefs = {};\n\n    _this.bindNodeRefs = function (refKey, ref) {\n      _this.nodeRefs[refKey] = ref;\n    };\n\n    _this.getPositionInstance = function () {\n      return _this.positionRef.current;\n    };\n\n    _this.getToggleInstance = function () {\n      return _this.toggleRef.current;\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.addTreePrefix = function (name) {\n      return prefix(defaultClassPrefix('tree'))(name);\n    };\n\n    _this.selectActiveItem = function (event) {\n      var _this$getActiveItem = _this.getActiveItem(),\n          nodeData = _this$getActiveItem.nodeData,\n          layer = _this$getActiveItem.layer;\n\n      _this.handleSelect(nodeData, +layer, event);\n    };\n\n    _this.focusNextItem = function () {\n      var _node$focus;\n\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi.items,\n          activeIndex = _this$getItemsAndActi.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\n\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\n    };\n\n    _this.focusPreviousItem = function () {\n      var _node$focus2;\n\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi2.items,\n          activeIndex = _this$getItemsAndActi2.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\n\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\n    };\n\n    _this.handleCloseDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.hide();\n      }\n    };\n\n    _this.handleOpenDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.show();\n      }\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleToggleDropdown = function () {\n      var active = _this.state.active;\n\n      if (active) {\n        _this.handleCloseDropdown();\n\n        return;\n      }\n\n      _this.handleOpenDropdown();\n    };\n\n    _this.handleToggle = function (nodeData) {\n      var _this$props2 = _this.props,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey,\n          onExpand = _this$props2.onExpand,\n          expandItemValues = _this$props2.expandItemValues;\n\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\n\n      if (_isUndefined(expandItemValues)) {\n        _this.unserializeLists('expand', nextExpandItemValues);\n\n        _this.setState({\n          expandItemValues: nextExpandItemValues\n        });\n      }\n\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }));\n    };\n\n    _this.handleSelect = function (nodeData, layer, event) {\n      var _this$toggleRef$curre;\n\n      var _this$props3 = _this.props,\n          valueKey = _this$props3.valueKey,\n          onChange = _this$props3.onChange,\n          onSelect = _this$props3.onSelect,\n          value = _this$props3.value;\n      _this.node = nodeData;\n\n      if (_isUndefined(value)) {\n        _this.setState({\n          activeNode: nodeData,\n          selectedValue: nodeData[valueKey]\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, layer, event);\n\n      _this.handleCloseDropdown();\n\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\n    };\n\n    _this.handleKeyDown = function (event) {\n      onMenuKeyDown(event, {\n        down: _this.focusNextItem,\n        up: _this.focusPreviousItem,\n        enter: _this.selectActiveItem,\n        del: _this.handleClean\n      });\n    };\n\n    _this.handleToggleKeyDown = function (event) {\n      var _this$state = _this.state,\n          activeNode = _this$state.activeNode,\n          active = _this$state.active; // enter\n\n      if ((!activeNode || !active) && event.keyCode === 13) {\n        _this.handleToggleDropdown();\n      } // delete\n\n\n      if (event.keyCode === 8) {\n        _this.handleClean(event);\n      }\n\n      if (!_this.treeViewRef.current) {\n        return;\n      }\n\n      if (event.target instanceof HTMLElement) {\n        var className = event.target.className;\n\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\n          onMenuKeyDown(event, {\n            down: _this.focusNextItem\n          });\n        }\n      }\n    };\n\n    _this.handleSearch = function (value, event) {\n      var filterData = _this.state.filterData;\n      var _this$props4 = _this.props,\n          onSearch = _this$props4.onSearch,\n          searchKeyword = _this$props4.searchKeyword;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: value,\n          filterData: _this.getFilterData(filterData, value)\n        });\n      }\n\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props$onChange, _this$props5;\n\n      _this.setState({\n        activeNode: null,\n        selectedValue: null\n      });\n\n      _this.node = null;\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\n    };\n\n    _this.handleOnOpen = function () {\n      var _this$props$onOpen, _this$props6;\n\n      var activeNode = _this.state.activeNode;\n\n      if (activeNode) {\n        var _node$focus3;\n\n        var node = _this.getElementByDataKey(activeNode.refKey);\n\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\n      }\n\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleOnClose = function () {\n      var filterData = _this.state.filterData;\n      var _this$props7 = _this.props,\n          searchKeyword = _this$props7.searchKeyword,\n          onClose = _this$props7.onClose;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: '',\n          filterData: _this.getFilterData(filterData, '')\n        });\n      }\n\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n\n      _this.setState({\n        active: false\n      });\n    };\n\n    _this.measureRowRenderer = function (nodes) {\n      return function (_ref) {\n        var key = _ref.key,\n            index = _ref.index,\n            style = _ref.style,\n            parent = _ref.parent;\n        var node = nodes[index];\n        return React.createElement(CellMeasurer, {\n          cache: _this.cache,\n          columnIndex: 0,\n          key: key,\n          rowIndex: index,\n          parent: parent\n        }, function () {\n          return _this.renderVirtualNode(node, {\n            key: key,\n            style: style\n          });\n        });\n      };\n    };\n\n    var _value = props.value,\n        data = props.data,\n        _valueKey = props.valueKey,\n        _props$searchKeyword = props.searchKeyword,\n        _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\n\n    var nextData = [].concat(data);\n\n    var _nextExpandItemValues = getExpandItemValues(props);\n\n    _this.flattenNodes(nextData);\n\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\n\n    _this.state = {\n      data: data,\n      value: _value,\n      selectedValue: _this.getValue(props),\n      expandAll: getExpandAll(props),\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\n      searchKeyword: _searchKeyword,\n      expandItemValues: _this.serializeList('expand')\n    };\n    _this.treeViewRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.listRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    _this.toggleRef = React.createRef(); // for test\n\n    _this.menuRef = React.createRef();\n    treeDeprecatedWarning(props, ['expandAll']);\n    return _this;\n  }\n\n  var _proto = TreePicker.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var activeNode = this.state.activeNode;\n    this.focusNode(activeNode);\n  };\n\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n        data = nextProps.data,\n        expandAll = nextProps.expandAll,\n        searchKeyword = nextProps.searchKeyword,\n        expandItemValues = nextProps.expandItemValues;\n    var nextState = {};\n\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\n      nextState.data = data;\n    }\n\n    if (!shallowEqual(value, prevState.value)) {\n      nextState.value = value;\n      nextState.selectedValue = value;\n    }\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      nextState.expandItemValues = expandItemValues;\n    }\n\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\n      nextState.searchKeyword = searchKeyword;\n    }\n\n    if (expandAll !== prevState.expandAll) {\n      nextState.expandAll = expandAll;\n    }\n\n    return Object.keys(nextState).length ? nextState : null;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\n    this.updateDataChange(prevState);\n    this.updateValueChange(prevState);\n    this.updateExpandItemValuesChange(prevState);\n    this.updateSearchKeywordChange(prevState);\n\n    if (this.listRef.current) {\n      this.listRef.current.forceUpdateGrid();\n    }\n  };\n\n  _proto.updateDataChange = function updateDataChange(prevState) {\n    var _this$state2 = this.state,\n        searchKeyword = _this$state2.searchKeyword,\n        expandItemValues = _this$state2.expandItemValues;\n    var data = this.props.data;\n\n    if (prevState.data !== data) {\n      var nextData = [].concat(data);\n      this.flattenNodes(nextData);\n      var filterData = this.getFilterData(nextData, searchKeyword);\n      var activeNode = this.getActiveNode(this.getValue());\n      this.focusNode(activeNode);\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        data: nextData,\n        filterData: filterData,\n        activeNode: activeNode,\n        expandItemValues: this.serializeList('expand')\n      });\n    }\n  };\n\n  _proto.updateValueChange = function updateValueChange(prevState) {\n    var _this$props8 = this.props,\n        value = _this$props8.value,\n        valueKey = _this$props8.valueKey;\n\n    if (!shallowEqual(prevState.value, value)) {\n      var activeNode = null;\n\n      if (this.node === null) {\n        activeNode = this.getActiveNode(value);\n      }\n\n      if (value !== null && this.node !== null) {\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\n      }\n\n      var nextState = {\n        value: value,\n        activeNode: activeNode\n      };\n\n      if (value === null) {\n        nextState.activeNode = null;\n        this.node = null;\n      }\n\n      if (activeNode !== null) {\n        this.focusNode(activeNode);\n      }\n\n      this.setState(nextState);\n    }\n  };\n\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\n    var expandItemValues = this.props.expandItemValues;\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        expandItemValues: expandItemValues\n      });\n    }\n  };\n\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\n    var filterData = this.state.filterData;\n\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\n      this.setState({\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\n      });\n    }\n  };\n\n  _proto.getValue = function getValue(props) {\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props = props,\n        value = _props.value,\n        defaultValue = _props.defaultValue;\n    return !_isUndefined(value) ? value : defaultValue;\n  };\n\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\n    var _this4 = this;\n\n    if (valueKey === void 0) {\n      valueKey = this.props.valueKey;\n    }\n\n    var activeNode = null;\n\n    if (!_isUndefined(value)) {\n      Object.keys(this.nodes).forEach(function (refKey) {\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\n          activeNode = _this4.nodes[refKey];\n        }\n      });\n    }\n\n    return activeNode;\n  };\n\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\n    var childrenKey = this.props.childrenKey;\n\n    for (var i = 0; i < options.length; i += 1) {\n      var _options$i$childrenKe;\n\n      if (options[i].value === value) {\n        return options[i];\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\n\n        if (!_isEmpty(active)) {\n          return active;\n        }\n      }\n    }\n\n    return {};\n  };\n\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\n    var items = this.getFocusableMenuItems();\n    var activeIndex = -1;\n    items.forEach(function (item, index) {\n      if (document.activeElement !== null) {\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\n          activeIndex = index;\n        }\n      }\n    });\n    return {\n      items: items,\n      activeIndex: activeIndex\n    };\n  };\n\n  _proto.getActiveItem = function getActiveItem() {\n    var nodeData = {};\n    var activeItem = document.activeElement;\n\n    if (activeItem !== null) {\n      var _get2 = _get(activeItem, 'dataset'),\n          key = _get2.key,\n          layer = _get2.layer;\n\n      var activeNode = this.nodes[key];\n\n      if (activeNode) {\n        nodeData = activeNode;\n      }\n\n      return {\n        nodeData: nodeData,\n        layer: layer\n      };\n    }\n\n    return {};\n  };\n\n  _proto.getFilterData = function getFilterData(data, word, props) {\n    if (word === void 0) {\n      word = '';\n    }\n\n    var _ref2 = props || this.props,\n        labelKey = _ref2.labelKey,\n        childrenKey = _ref2.childrenKey;\n\n    var setVisible = function setVisible(nodes) {\n      if (nodes === void 0) {\n        nodes = [];\n      }\n\n      return nodes.forEach(function (item) {\n        item.visible = shouldDisplay(item[labelKey], word);\n\n        if (_isArray(item[childrenKey])) {\n          setVisible(item[childrenKey]);\n          item[childrenKey].forEach(function (child) {\n            if (child.visible) {\n              item.visible = child.visible;\n            }\n          });\n        }\n      });\n    };\n\n    if (!_isUndefined(word)) {\n      setVisible(data);\n    }\n\n    return data;\n  };\n\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\n    var _this5 = this;\n\n    var expandItemValues = this.state.expandItemValues;\n    var _this$props9 = this.props,\n        childrenKey = _this$props9.childrenKey,\n        valueKey = _this$props9.valueKey;\n    return flattenTree(nodes, childrenKey, function (node) {\n      var formatted = {};\n      var curNode = _this5.nodes[node.refKey];\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\n\n      if (curNode) {\n        formatted = _extends({}, node, {\n          expand: curNode.expand,\n          layer: curNode.layer,\n          parentNode: curNode.parentNode,\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\n        });\n      }\n\n      return formatted;\n    });\n  };\n\n  _proto.focusNode = function focusNode(activeNode) {\n    var inline = this.props.inline;\n\n    if (activeNode && inline) {\n      var _node$focus4;\n\n      var node = this.getElementByDataKey(activeNode.refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\n    }\n  };\n\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\n    var _this6 = this;\n\n    if (ref === void 0) {\n      ref = '0';\n    }\n\n    if (layer === void 0) {\n      layer = 0;\n    }\n\n    var _ref3 = props || this.props,\n        labelKey = _ref3.labelKey,\n        valueKey = _ref3.valueKey,\n        childrenKey = _ref3.childrenKey;\n\n    if (!Array.isArray(nodes) || nodes.length === 0) {\n      return [];\n    }\n\n    nodes.map(function (node, index) {\n      var _this6$nodes$refKey;\n\n      var refKey = ref + \"-\" + index;\n      node.refKey = refKey;\n      _this6.nodes[refKey] = (_this6$nodes$refKey = {\n        layer: layer\n      }, _this6$nodes$refKey[labelKey] = node[labelKey], _this6$nodes$refKey[valueKey] = node[valueKey], _this6$nodes$refKey.expand = getExpandState(node, props || _this6.props), _this6$nodes$refKey.refKey = refKey, _this6$nodes$refKey);\n\n      if (parentNode) {\n        _this6.nodes[refKey].parentNode = parentNode;\n      }\n\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\n    });\n  };\n\n  _proto.serializeList = function serializeList(key, nodes) {\n    if (nodes === void 0) {\n      nodes = this.nodes;\n    }\n\n    var valueKey = this.props.valueKey;\n    var list = [];\n    Object.keys(nodes).forEach(function (refKey) {\n      if (nodes[refKey][key]) {\n        list.push(nodes[refKey][valueKey]);\n      }\n    });\n    return list;\n  };\n\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\n    var _this7 = this;\n\n    if (value === void 0) {\n      value = [];\n    }\n\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props2 = props,\n        valueKey = _props2.valueKey;\n    var expandAll = getExpandAll(props);\n    Object.keys(this.nodes).forEach(function (refKey) {\n      _this7.nodes[refKey][key] = false;\n\n      if (value.length) {\n        value.forEach(function (value) {\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\n            _this7.nodes[refKey][key] = true;\n          }\n        });\n      } else {\n        _this7.nodes[refKey][key] = expandAll;\n      }\n    });\n  };\n\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\n    var valueKey = this.props.valueKey;\n    var expandItemValues = new Set(this.serializeList('expand'));\n\n    if (isExpand) {\n      expandItemValues.add(node[valueKey]);\n    } else {\n      expandItemValues.delete(node[valueKey]);\n    }\n\n    return Array.from(expandItemValues);\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _this$props10 = this.props,\n        _this$props10$height = _this$props10.height,\n        height = _this$props10$height === void 0 ? defaultHeight : _this$props10$height,\n        searchable = _this$props10.searchable,\n        searchKeyword = _this$props10.searchKeyword,\n        renderExtraFooter = _this$props10.renderExtraFooter,\n        locale = _this$props10.locale,\n        renderMenu = _this$props10.renderMenu,\n        menuStyle = _this$props10.menuStyle,\n        virtualized = _this$props10.virtualized,\n        menuClassName = _this$props10.menuClassName,\n        menuAutoWidth = _this$props10.menuAutoWidth;\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\n    var styles = virtualized ? _extends({\n      height: height\n    }, menuStyle) : menuStyle;\n    return React.createElement(MenuWrapper, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      ref: this.menuRef,\n      getToggleInstance: this.getToggleInstance,\n      getPositionInstance: this.getPositionInstance\n    }, searchable ? React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      key: \"searchBar\",\n      onChange: this.handleSearch,\n      value: keyword\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.renderNode = function renderNode(node, index, layer) {\n    var _this8 = this;\n\n    var _this$state3 = this.state,\n        selectedValue = _this$state3.selectedValue,\n        searchKeyword = _this$state3.searchKeyword;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var _this$props11 = this.props,\n        _this$props11$disable = _this$props11.disabledItemValues,\n        disabledItemValues = _this$props11$disable === void 0 ? [] : _this$props11$disable,\n        valueKey = _this$props11.valueKey,\n        labelKey = _this$props11.labelKey,\n        locale = _this$props11.locale,\n        childrenKey = _this$props11.childrenKey,\n        renderTreeNode = _this$props11.renderTreeNode,\n        renderTreeIcon = _this$props11.renderTreeIcon;\n    var refKey = node.refKey;\n    var expand = this.nodes[node.refKey].expand;\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\n\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n    var props = {\n      rtl: locale.rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      expand: expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      children: children,\n      nodeData: _extends({}, node, {\n        expand: expand\n      }),\n      disabled: disabledItemValues.filter(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }).length > 0,\n      hasChildren: visibleChildren,\n      onSelect: this.handleSelect,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n\n    if (props.hasChildren) {\n      var _classNames;\n\n      layer += 1;\n      var expandALlState = this.nodes[node.refKey].expand; // 是否展开树节点且子节点不为空\n\n      var openClass = this.addTreePrefix('open');\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expandALlState && visibleChildren, _classNames));\n      var nodes = children || [];\n      return React.createElement(\"div\", {\n        className: childrenClass,\n        key: key,\n        ref: this.bindNodeRefs.bind(this, refKey)\n      }, React.createElement(TreeNode, props), React.createElement(\"div\", {\n        className: this.addTreePrefix('children')\n      }, nodes.map(function (child, i) {\n        return _this8.renderNode(child, i, layer);\n      })));\n    }\n\n    return React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, props));\n  };\n\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\n    var selectedValue = this.state.selectedValue;\n    var _this$props12 = this.props,\n        locale = _this$props12.locale,\n        _this$props12$disable = _this$props12.disabledItemValues,\n        disabledItemValues = _this$props12$disable === void 0 ? [] : _this$props12$disable,\n        valueKey = _this$props12.valueKey,\n        labelKey = _this$props12.labelKey,\n        childrenKey = _this$props12.childrenKey,\n        renderTreeNode = _this$props12.renderTreeNode,\n        renderTreeIcon = _this$props12.renderTreeIcon;\n    var key = options.key,\n        style = options.style;\n    var layer = node.layer,\n        refKey = node.refKey,\n        expand = node.expand,\n        showNode = node.showNode;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var children = node[childrenKey];\n    var props = {\n      rtl: locale.rtl,\n      style: style,\n      value: node[valueKey],\n      label: node[labelKey],\n      layer: layer,\n      expand: expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      nodeData: node,\n      disabled: disabledItemValues.filter(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }).length > 0,\n      children: children,\n      hasChildren: !!children,\n      onSelect: this.handleSelect,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n    return showNode && React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, props));\n  };\n\n  _proto.renderTree = function renderTree() {\n    var _classNames2,\n        _this9 = this;\n\n    var filterData = this.state.filterData;\n    var _this$props13 = this.props,\n        height = _this$props13.height,\n        _this$props13$classNa = _this$props13.className,\n        className = _this$props13$classNa === void 0 ? '' : _this$props13$classNa,\n        inline = _this$props13.inline,\n        style = _this$props13.style,\n        locale = _this$props13.locale,\n        virtualized = _this$props13.virtualized;\n    var layer = 0;\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\n    var nodes = [];\n\n    if (!virtualized) {\n      nodes = filterData.map(function (dataItem, index) {\n        return _this9.renderNode(dataItem, index, layer);\n      });\n\n      if (!nodes.some(function (v) {\n        return v !== null;\n      })) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } else {\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\n        return n.showNode && n.visible;\n      });\n\n      if (!nodes.length) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } // 当未定义 height 且 设置了 virtualized 为 true，treeHeight 设置默认高度\n\n\n    var treeHeight = _isUndefined(height) && virtualized ? defaultHeight : height;\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\n    var styles = inline ? _extends({\n      height: treeHeight\n    }, style) : {};\n    var ListHeight = getVirtualLisHeight(inline, treeHeight);\n    return React.createElement(\"div\", {\n      ref: this.treeViewRef,\n      className: classes,\n      style: styles,\n      onKeyDown: this.handleKeyDown\n    }, React.createElement(\"div\", {\n      className: this.addTreePrefix('nodes')\n    }, virtualized ? React.createElement(AutoSizer, {\n      defaultHeight: ListHeight,\n      defaultWidth: treeWidth\n    }, function (_ref4) {\n      var height = _ref4.height,\n          width = _ref4.width;\n      return React.createElement(List, {\n        ref: _this9.listRef,\n        width: width || treeWidth,\n        height: height || ListHeight,\n        rowHeight: 36,\n        rowCount: nodes.length,\n        rowRenderer: _this9.measureRowRenderer(nodes)\n      });\n    }) : nodes));\n  };\n\n  _proto.render = function render() {\n    var _this$props14 = this.props,\n        inline = _this$props14.inline,\n        locale = _this$props14.locale,\n        disabled = _this$props14.disabled,\n        toggleComponentClass = _this$props14.toggleComponentClass,\n        placeholder = _this$props14.placeholder,\n        cleanable = _this$props14.cleanable,\n        renderValue = _this$props14.renderValue,\n        valueKey = _this$props14.valueKey,\n        labelKey = _this$props14.labelKey,\n        onEntered = _this$props14.onEntered,\n        onExited = _this$props14.onExited,\n        onClean = _this$props14.onClean,\n        style = _this$props14.style,\n        rest = _objectWithoutPropertiesLoose(_this$props14, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"valueKey\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\"]);\n\n    var activeNode = this.state.activeNode;\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, !!activeNode);\n    var selectedElement = placeholder;\n    var hasValue = !!activeNode;\n\n    if (hasValue) {\n      selectedElement = activeNode === null || activeNode === void 0 ? void 0 : activeNode[labelKey];\n\n      if (renderValue && activeNode) {\n        selectedElement = renderValue(activeNode[valueKey], activeNode, selectedElement);\n      }\n    }\n\n    var unhandled = getUnhandledProps(TreePicker, rest);\n\n    if (inline) {\n      return this.renderTree();\n    }\n\n    return React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: this.positionRef,\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\n      onExit: createChainedFunction(this.handleOnClose, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      ref: this.toggleRef,\n      onKeyDown: this.handleToggleKeyDown,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      componentClass: toggleComponentClass,\n      hasValue: hasValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return TreePicker;\n}(React.Component);\n\nTreePicker.propTypes = {\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  data: PropTypes.array,\n  open: PropTypes.bool,\n  style: PropTypes.object,\n  block: PropTypes.bool,\n  value: PropTypes.any,\n  height: PropTypes.number,\n  inline: PropTypes.bool,\n  locale: PropTypes.object,\n  labelKey: PropTypes.string,\n  valueKey: PropTypes.string,\n  container: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  placement: PropTypes.oneOf(PLACEMENT),\n  disabled: PropTypes.bool,\n  className: PropTypes.string,\n  expandAll: PropTypes.bool,\n  cleanable: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  classPrefix: PropTypes.string,\n  childrenKey: PropTypes.string,\n  placeholder: PropTypes.node,\n  defaultOpen: PropTypes.bool,\n  defaultValue: PropTypes.any,\n  menuStyle: PropTypes.object,\n  menuClassName: PropTypes.string,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  containerPadding: PropTypes.number,\n  disabledItemValues: PropTypes.array,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  toggleComponentClass: PropTypes.elementType,\n  onOpen: PropTypes.func,\n  onExit: PropTypes.func,\n  onEnter: PropTypes.func,\n  onClose: PropTypes.func,\n  onHide: PropTypes.func,\n  onSearch: PropTypes.func,\n  onClean: PropTypes.func,\n  onChange: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  onExited: PropTypes.func,\n  onEntered: PropTypes.func,\n  onExiting: PropTypes.func,\n  onEntering: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderValue: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func\n};\nTreePicker.defaultProps = {\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  },\n  inline: false,\n  valueKey: 'value',\n  labelKey: 'label',\n  cleanable: true,\n  placement: 'bottomStart',\n  searchable: true,\n  appearance: 'default',\n  childrenKey: 'children',\n  virtualized: false,\n  menuAutoWidth: true\n};\npolyfill(TreePicker);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(TreePicker);"]},"metadata":{},"sourceType":"module"}