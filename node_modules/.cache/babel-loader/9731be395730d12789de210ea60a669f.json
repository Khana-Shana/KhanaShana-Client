{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _find from \"lodash/find\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport compose from 'recompose/compose';\nimport IntlProvider from '../IntlProvider';\nimport withLocale from '../IntlProvider/withLocale';\nimport FileItem from './UploadFileItem';\nimport UploadTrigger from './UploadTrigger';\nimport { prefix, ajaxUpload, defaultProps, getUnhandledProps } from '../utils';\nimport { getFiles, guid } from './utils';\n\nvar Uploader = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Uploader, _React$Component);\n\n  function Uploader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.inputRef = void 0;\n\n    _this.handleRemoveFile = function (fileKey) {\n      var _this$props$onRemove, _this$props, _this$props$onChange, _this$props2;\n\n      var fileList = _this.getFileList();\n\n      var file = _find(fileList, function (f) {\n        return f.fileKey === fileKey;\n      });\n\n      var nextFileList = fileList.filter(function (f) {\n        return f.fileKey !== fileKey;\n      });\n\n      if (_this.xhrs[file.fileKey] && _this.xhrs[file.fileKey].readyState !== 4) {\n        _this.xhrs[file.fileKey].abort();\n      }\n\n      _this.setState({\n        fileList: nextFileList\n      });\n\n      (_this$props$onRemove = (_this$props = _this.props).onRemove) === null || _this$props$onRemove === void 0 ? void 0 : _this$props$onRemove.call(_this$props, file);\n      (_this$props$onChange = (_this$props2 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props2, nextFileList);\n    };\n\n    _this.handleUploadTriggerChange = function (event) {\n      var _this$props$onChange2, _this$props4;\n\n      var _this$props3 = _this.props,\n          autoUpload = _this$props3.autoUpload,\n          shouldQueueUpdate = _this$props3.shouldQueueUpdate;\n\n      var fileList = _this.getFileList();\n\n      var files = getFiles(event);\n      var newFileList = [];\n      Array.from(files).forEach(function (file) {\n        newFileList.push({\n          blobFile: file,\n          name: file.name,\n          status: 'inited',\n          fileKey: guid()\n        });\n      });\n      var nextFileList = [].concat(fileList, newFileList);\n\n      if ((shouldQueueUpdate === null || shouldQueueUpdate === void 0 ? void 0 : shouldQueueUpdate(nextFileList, newFileList)) === false) {\n        _this.cleanInputValue();\n\n        return;\n      }\n\n      (_this$props$onChange2 = (_this$props4 = _this.props).onChange) === null || _this$props$onChange2 === void 0 ? void 0 : _this$props$onChange2.call(_this$props4, nextFileList);\n\n      _this.setState({\n        fileList: nextFileList\n      }, function () {\n        autoUpload && _this.handleAjaxUpload();\n      });\n    };\n\n    _this.handleAjaxUploadSuccess = function (file, response, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'finished',\n        progress: 100\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onSuccess, _this$props5;\n\n        (_this$props$onSuccess = (_this$props5 = _this.props).onSuccess) === null || _this$props$onSuccess === void 0 ? void 0 : _this$props$onSuccess.call(_this$props5, response, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleAjaxUploadError = function (file, status, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'error'\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onError, _this$props6;\n\n        (_this$props$onError = (_this$props6 = _this.props).onError) === null || _this$props$onError === void 0 ? void 0 : _this$props$onError.call(_this$props6, status, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleAjaxUploadProgress = function (file, percent, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'uploading',\n        progress: percent\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onProgres, _this$props7;\n\n        (_this$props$onProgres = (_this$props7 = _this.props).onProgress) === null || _this$props$onProgres === void 0 ? void 0 : _this$props$onProgres.call(_this$props7, percent, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleUploadFile = function (file) {\n      var _this$props8 = _this.props,\n          name = _this$props8.name,\n          action = _this$props8.action,\n          headers = _this$props8.headers,\n          withCredentials = _this$props8.withCredentials,\n          timeout = _this$props8.timeout,\n          data = _this$props8.data,\n          onUpload = _this$props8.onUpload;\n      var xhr = ajaxUpload({\n        name: name,\n        timeout: timeout,\n        headers: headers,\n        data: data,\n        withCredentials: withCredentials,\n        file: file.blobFile,\n        url: action,\n        onError: _this.handleAjaxUploadError.bind(_assertThisInitialized(_this), file),\n        onSuccess: _this.handleAjaxUploadSuccess.bind(_assertThisInitialized(_this), file),\n        onProgress: _this.handleAjaxUploadProgress.bind(_assertThisInitialized(_this), file)\n      });\n\n      _this.updateFileList(_extends({}, file, {\n        status: 'uploading'\n      }));\n\n      _this.xhrs[file.fileKey] = xhr;\n      onUpload === null || onUpload === void 0 ? void 0 : onUpload(file);\n    };\n\n    _this.handleReupload = function (file) {\n      var _this$props9 = _this.props,\n          onReupload = _this$props9.onReupload,\n          autoUpload = _this$props9.autoUpload;\n      autoUpload && _this.handleUploadFile(file);\n      onReupload === null || onReupload === void 0 ? void 0 : onReupload(file);\n    };\n\n    _this.createFile = function (file) {\n      var fileKey = file.fileKey;\n      return _extends({}, file, {\n        fileKey: fileKey || guid(),\n        progress: 0\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.progressTimer = void 0;\n    _this.xhrs = {};\n    _this.uploadTrigger = null;\n    var _props$defaultFileLis = props.defaultFileList,\n        defaultFileList = _props$defaultFileLis === void 0 ? [] : _props$defaultFileLis;\n\n    var _fileList = defaultFileList.map(_this.createFile);\n\n    _this.state = {\n      fileList: _fileList,\n      fileMap: {}\n    };\n    _this.inputRef = React.createRef();\n    return _this;\n  } // public API\n\n\n  var _proto = Uploader.prototype;\n\n  _proto.start = function start(file) {\n    if (file) {\n      this.handleUploadFile(file);\n      return;\n    }\n\n    this.handleAjaxUpload();\n  };\n\n  _proto.getFileList = function getFileList() {\n    var fileList = this.props.fileList;\n    var fileMap = this.state.fileMap;\n\n    if (typeof fileList !== 'undefined') {\n      return fileList.map(function (file) {\n        return _extends({}, file, {}, fileMap[file.fileKey]);\n      });\n    }\n\n    return this.state.fileList;\n  };\n\n  _proto.cleanInputValue = function cleanInputValue() {\n    if (this.inputRef.current) {\n      this.inputRef.current.getInputInstance().value = '';\n    }\n  };\n\n  _proto.handleAjaxUpload = function handleAjaxUpload() {\n    var _this2 = this;\n\n    var shouldUpload = this.props.shouldUpload;\n    var fileList = this.getFileList();\n    fileList.forEach(function (file) {\n      if ((shouldUpload === null || shouldUpload === void 0 ? void 0 : shouldUpload(file)) === false) {\n        return;\n      }\n\n      if (file.status === 'inited') {\n        _this2.handleUploadFile(file);\n      }\n    });\n    this.cleanInputValue();\n  };\n\n  _proto.updateFileList = function updateFileList(nextFile, callback) {\n    var fileList = this.getFileList();\n    var nextFileList = fileList.map(function (file) {\n      return file.fileKey === nextFile.fileKey ? nextFile : file;\n    });\n    var nextState = {\n      fileList: nextFileList\n    };\n\n    if (nextFile.progress) {\n      var fileMap = this.state.fileMap;\n      fileMap[nextFile.fileKey] = {\n        progress: nextFile.progress,\n        status: nextFile.status\n      };\n      nextState.fileMap = fileMap;\n    }\n\n    this.setState(nextState, callback);\n  };\n\n  _proto.renderFileItems = function renderFileItems() {\n    var _this3 = this;\n\n    var _this$props10 = this.props,\n        disabledFileItem = _this$props10.disabledFileItem,\n        listType = _this$props10.listType,\n        onPreview = _this$props10.onPreview,\n        maxPreviewFileSize = _this$props10.maxPreviewFileSize,\n        renderFileInfo = _this$props10.renderFileInfo,\n        removable = _this$props10.removable;\n    var fileList = this.getFileList();\n    return React.createElement(\"div\", {\n      key: \"items\",\n      className: this.addPrefix('file-items')\n    }, fileList.map(function (file, index) {\n      return React.createElement(FileItem, {\n        key: file.fileKey || index,\n        file: file,\n        maxPreviewFileSize: maxPreviewFileSize,\n        listType: listType,\n        disabled: disabledFileItem,\n        onPreview: onPreview,\n        onReupload: _this3.handleReupload,\n        onCancel: _this3.handleRemoveFile,\n        renderFileInfo: renderFileInfo,\n        removable: removable\n      });\n    }));\n  };\n\n  _proto.renderUploadTrigger = function renderUploadTrigger() {\n    var _this$props11 = this.props,\n        name = _this$props11.name,\n        multiple = _this$props11.multiple,\n        disabled = _this$props11.disabled,\n        accept = _this$props11.accept,\n        children = _this$props11.children,\n        toggleComponentClass = _this$props11.toggleComponentClass,\n        draggable = _this$props11.draggable,\n        rest = _objectWithoutPropertiesLoose(_this$props11, [\"name\", \"multiple\", \"disabled\", \"accept\", \"children\", \"toggleComponentClass\", \"draggable\"]);\n\n    var unhandled = getUnhandledProps(Uploader, rest);\n    return React.createElement(UploadTrigger, _extends({}, unhandled, {\n      name: name,\n      key: \"trigger\",\n      multiple: multiple,\n      draggable: draggable,\n      disabled: disabled,\n      accept: accept,\n      ref: this.inputRef,\n      onChange: this.handleUploadTriggerChange,\n      componentClass: toggleComponentClass\n    }), children);\n  };\n\n  _proto.render = function render() {\n    var _classNames;\n\n    var _this$props12 = this.props,\n        classPrefix = _this$props12.classPrefix,\n        className = _this$props12.className,\n        listType = _this$props12.listType,\n        fileListVisible = _this$props12.fileListVisible,\n        locale = _this$props12.locale,\n        style = _this$props12.style,\n        draggable = _this$props12.draggable;\n    var classes = classNames(className, classPrefix, this.addPrefix(listType), (_classNames = {}, _classNames[this.addPrefix('draggable')] = draggable, _classNames));\n    var renderList = [this.renderUploadTrigger()];\n\n    if (fileListVisible) {\n      renderList.push(this.renderFileItems());\n    }\n\n    if (listType === 'picture') {\n      renderList.reverse();\n    }\n\n    return React.createElement(IntlProvider, {\n      locale: locale\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, renderList));\n  };\n\n  return Uploader;\n}(React.Component);\n\nUploader.propTypes = {\n  action: PropTypes.string,\n  accept: PropTypes.string,\n  autoUpload: PropTypes.bool,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  classPrefix: PropTypes.string,\n  defaultFileList: PropTypes.array,\n  fileList: PropTypes.array,\n  data: PropTypes.object,\n  multiple: PropTypes.bool,\n  disabled: PropTypes.bool,\n  disabledFileItem: PropTypes.bool,\n  name: PropTypes.string,\n  timeout: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  headers: PropTypes.object,\n  locale: PropTypes.object,\n  listType: PropTypes.oneOf(['text', 'picture-text', 'picture']),\n  shouldQueueUpdate: PropTypes.func,\n  shouldUpload: PropTypes.func,\n  onChange: PropTypes.func,\n  onUpload: PropTypes.func,\n  onReupload: PropTypes.func,\n  onPreview: PropTypes.func,\n  onError: PropTypes.func,\n  onSuccess: PropTypes.func,\n  onProgress: PropTypes.func,\n  onRemove: PropTypes.func,\n  maxPreviewFileSize: PropTypes.number,\n  style: PropTypes.object,\n  toggleComponentClass: PropTypes.elementType,\n  renderFileInfo: PropTypes.func,\n  removable: PropTypes.bool,\n  fileListVisible: PropTypes.bool,\n  draggable: PropTypes.bool\n};\nUploader.defaultProps = {\n  autoUpload: true,\n  timeout: 0,\n  name: 'file',\n  multiple: false,\n  disabled: false,\n  withCredentials: false,\n  data: {},\n  listType: 'text',\n  removable: true,\n  fileListVisible: true\n};\nexport default compose(withLocale(['Uploader']), defaultProps({\n  classPrefix: 'uploader'\n}))(Uploader);","map":{"version":3,"sources":["/mnt/c/Users/Dell/Desktop/se/KhanaShana-Client/node_modules/rsuite/es/Uploader/Uploader.js"],"names":["_objectWithoutPropertiesLoose","_extends","_assertThisInitialized","_inheritsLoose","_find","React","PropTypes","classNames","compose","IntlProvider","withLocale","FileItem","UploadTrigger","prefix","ajaxUpload","defaultProps","getUnhandledProps","getFiles","guid","Uploader","_React$Component","props","_this","call","inputRef","handleRemoveFile","fileKey","_this$props$onRemove","_this$props","_this$props$onChange","_this$props2","fileList","getFileList","file","f","nextFileList","filter","xhrs","readyState","abort","setState","onRemove","onChange","handleUploadTriggerChange","event","_this$props$onChange2","_this$props4","_this$props3","autoUpload","shouldQueueUpdate","files","newFileList","Array","from","forEach","push","blobFile","name","status","concat","cleanInputValue","handleAjaxUpload","handleAjaxUploadSuccess","response","xhr","nextFile","progress","updateFileList","_this$props$onSuccess","_this$props5","onSuccess","handleAjaxUploadError","_this$props$onError","_this$props6","onError","handleAjaxUploadProgress","percent","_this$props$onProgres","_this$props7","onProgress","handleUploadFile","_this$props8","action","headers","withCredentials","timeout","data","onUpload","url","bind","handleReupload","_this$props9","onReupload","createFile","addPrefix","classPrefix","progressTimer","uploadTrigger","_props$defaultFileLis","defaultFileList","_fileList","map","state","fileMap","createRef","_proto","prototype","start","current","getInputInstance","value","_this2","shouldUpload","callback","nextState","renderFileItems","_this3","_this$props10","disabledFileItem","listType","onPreview","maxPreviewFileSize","renderFileInfo","removable","createElement","key","className","index","disabled","onCancel","renderUploadTrigger","_this$props11","multiple","accept","children","toggleComponentClass","draggable","rest","unhandled","ref","componentClass","render","_classNames","_this$props12","fileListVisible","locale","style","classes","renderList","reverse","Component","propTypes","string","bool","node","array","object","number","oneOf","func","elementType"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _find from \"lodash/find\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport compose from 'recompose/compose';\nimport IntlProvider from '../IntlProvider';\nimport withLocale from '../IntlProvider/withLocale';\nimport FileItem from './UploadFileItem';\nimport UploadTrigger from './UploadTrigger';\nimport { prefix, ajaxUpload, defaultProps, getUnhandledProps } from '../utils';\nimport { getFiles, guid } from './utils';\n\nvar Uploader =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Uploader, _React$Component);\n\n  function Uploader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.inputRef = void 0;\n\n    _this.handleRemoveFile = function (fileKey) {\n      var _this$props$onRemove, _this$props, _this$props$onChange, _this$props2;\n\n      var fileList = _this.getFileList();\n\n      var file = _find(fileList, function (f) {\n        return f.fileKey === fileKey;\n      });\n\n      var nextFileList = fileList.filter(function (f) {\n        return f.fileKey !== fileKey;\n      });\n\n      if (_this.xhrs[file.fileKey] && _this.xhrs[file.fileKey].readyState !== 4) {\n        _this.xhrs[file.fileKey].abort();\n      }\n\n      _this.setState({\n        fileList: nextFileList\n      });\n\n      (_this$props$onRemove = (_this$props = _this.props).onRemove) === null || _this$props$onRemove === void 0 ? void 0 : _this$props$onRemove.call(_this$props, file);\n      (_this$props$onChange = (_this$props2 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props2, nextFileList);\n    };\n\n    _this.handleUploadTriggerChange = function (event) {\n      var _this$props$onChange2, _this$props4;\n\n      var _this$props3 = _this.props,\n          autoUpload = _this$props3.autoUpload,\n          shouldQueueUpdate = _this$props3.shouldQueueUpdate;\n\n      var fileList = _this.getFileList();\n\n      var files = getFiles(event);\n      var newFileList = [];\n      Array.from(files).forEach(function (file) {\n        newFileList.push({\n          blobFile: file,\n          name: file.name,\n          status: 'inited',\n          fileKey: guid()\n        });\n      });\n      var nextFileList = [].concat(fileList, newFileList);\n\n      if ((shouldQueueUpdate === null || shouldQueueUpdate === void 0 ? void 0 : shouldQueueUpdate(nextFileList, newFileList)) === false) {\n        _this.cleanInputValue();\n\n        return;\n      }\n\n      (_this$props$onChange2 = (_this$props4 = _this.props).onChange) === null || _this$props$onChange2 === void 0 ? void 0 : _this$props$onChange2.call(_this$props4, nextFileList);\n\n      _this.setState({\n        fileList: nextFileList\n      }, function () {\n        autoUpload && _this.handleAjaxUpload();\n      });\n    };\n\n    _this.handleAjaxUploadSuccess = function (file, response, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'finished',\n        progress: 100\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onSuccess, _this$props5;\n\n        (_this$props$onSuccess = (_this$props5 = _this.props).onSuccess) === null || _this$props$onSuccess === void 0 ? void 0 : _this$props$onSuccess.call(_this$props5, response, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleAjaxUploadError = function (file, status, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'error'\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onError, _this$props6;\n\n        (_this$props$onError = (_this$props6 = _this.props).onError) === null || _this$props$onError === void 0 ? void 0 : _this$props$onError.call(_this$props6, status, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleAjaxUploadProgress = function (file, percent, event, xhr) {\n      var nextFile = _extends({}, file, {\n        status: 'uploading',\n        progress: percent\n      });\n\n      _this.updateFileList(nextFile, function () {\n        var _this$props$onProgres, _this$props7;\n\n        (_this$props$onProgres = (_this$props7 = _this.props).onProgress) === null || _this$props$onProgres === void 0 ? void 0 : _this$props$onProgres.call(_this$props7, percent, nextFile, event, xhr);\n      });\n    };\n\n    _this.handleUploadFile = function (file) {\n      var _this$props8 = _this.props,\n          name = _this$props8.name,\n          action = _this$props8.action,\n          headers = _this$props8.headers,\n          withCredentials = _this$props8.withCredentials,\n          timeout = _this$props8.timeout,\n          data = _this$props8.data,\n          onUpload = _this$props8.onUpload;\n      var xhr = ajaxUpload({\n        name: name,\n        timeout: timeout,\n        headers: headers,\n        data: data,\n        withCredentials: withCredentials,\n        file: file.blobFile,\n        url: action,\n        onError: _this.handleAjaxUploadError.bind(_assertThisInitialized(_this), file),\n        onSuccess: _this.handleAjaxUploadSuccess.bind(_assertThisInitialized(_this), file),\n        onProgress: _this.handleAjaxUploadProgress.bind(_assertThisInitialized(_this), file)\n      });\n\n      _this.updateFileList(_extends({}, file, {\n        status: 'uploading'\n      }));\n\n      _this.xhrs[file.fileKey] = xhr;\n      onUpload === null || onUpload === void 0 ? void 0 : onUpload(file);\n    };\n\n    _this.handleReupload = function (file) {\n      var _this$props9 = _this.props,\n          onReupload = _this$props9.onReupload,\n          autoUpload = _this$props9.autoUpload;\n      autoUpload && _this.handleUploadFile(file);\n      onReupload === null || onReupload === void 0 ? void 0 : onReupload(file);\n    };\n\n    _this.createFile = function (file) {\n      var fileKey = file.fileKey;\n      return _extends({}, file, {\n        fileKey: fileKey || guid(),\n        progress: 0\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.progressTimer = void 0;\n    _this.xhrs = {};\n    _this.uploadTrigger = null;\n    var _props$defaultFileLis = props.defaultFileList,\n        defaultFileList = _props$defaultFileLis === void 0 ? [] : _props$defaultFileLis;\n\n    var _fileList = defaultFileList.map(_this.createFile);\n\n    _this.state = {\n      fileList: _fileList,\n      fileMap: {}\n    };\n    _this.inputRef = React.createRef();\n    return _this;\n  } // public API\n\n\n  var _proto = Uploader.prototype;\n\n  _proto.start = function start(file) {\n    if (file) {\n      this.handleUploadFile(file);\n      return;\n    }\n\n    this.handleAjaxUpload();\n  };\n\n  _proto.getFileList = function getFileList() {\n    var fileList = this.props.fileList;\n    var fileMap = this.state.fileMap;\n\n    if (typeof fileList !== 'undefined') {\n      return fileList.map(function (file) {\n        return _extends({}, file, {}, fileMap[file.fileKey]);\n      });\n    }\n\n    return this.state.fileList;\n  };\n\n  _proto.cleanInputValue = function cleanInputValue() {\n    if (this.inputRef.current) {\n      this.inputRef.current.getInputInstance().value = '';\n    }\n  };\n\n  _proto.handleAjaxUpload = function handleAjaxUpload() {\n    var _this2 = this;\n\n    var shouldUpload = this.props.shouldUpload;\n    var fileList = this.getFileList();\n    fileList.forEach(function (file) {\n      if ((shouldUpload === null || shouldUpload === void 0 ? void 0 : shouldUpload(file)) === false) {\n        return;\n      }\n\n      if (file.status === 'inited') {\n        _this2.handleUploadFile(file);\n      }\n    });\n    this.cleanInputValue();\n  };\n\n  _proto.updateFileList = function updateFileList(nextFile, callback) {\n    var fileList = this.getFileList();\n    var nextFileList = fileList.map(function (file) {\n      return file.fileKey === nextFile.fileKey ? nextFile : file;\n    });\n    var nextState = {\n      fileList: nextFileList\n    };\n\n    if (nextFile.progress) {\n      var fileMap = this.state.fileMap;\n      fileMap[nextFile.fileKey] = {\n        progress: nextFile.progress,\n        status: nextFile.status\n      };\n      nextState.fileMap = fileMap;\n    }\n\n    this.setState(nextState, callback);\n  };\n\n  _proto.renderFileItems = function renderFileItems() {\n    var _this3 = this;\n\n    var _this$props10 = this.props,\n        disabledFileItem = _this$props10.disabledFileItem,\n        listType = _this$props10.listType,\n        onPreview = _this$props10.onPreview,\n        maxPreviewFileSize = _this$props10.maxPreviewFileSize,\n        renderFileInfo = _this$props10.renderFileInfo,\n        removable = _this$props10.removable;\n    var fileList = this.getFileList();\n    return React.createElement(\"div\", {\n      key: \"items\",\n      className: this.addPrefix('file-items')\n    }, fileList.map(function (file, index) {\n      return React.createElement(FileItem, {\n        key: file.fileKey || index,\n        file: file,\n        maxPreviewFileSize: maxPreviewFileSize,\n        listType: listType,\n        disabled: disabledFileItem,\n        onPreview: onPreview,\n        onReupload: _this3.handleReupload,\n        onCancel: _this3.handleRemoveFile,\n        renderFileInfo: renderFileInfo,\n        removable: removable\n      });\n    }));\n  };\n\n  _proto.renderUploadTrigger = function renderUploadTrigger() {\n    var _this$props11 = this.props,\n        name = _this$props11.name,\n        multiple = _this$props11.multiple,\n        disabled = _this$props11.disabled,\n        accept = _this$props11.accept,\n        children = _this$props11.children,\n        toggleComponentClass = _this$props11.toggleComponentClass,\n        draggable = _this$props11.draggable,\n        rest = _objectWithoutPropertiesLoose(_this$props11, [\"name\", \"multiple\", \"disabled\", \"accept\", \"children\", \"toggleComponentClass\", \"draggable\"]);\n\n    var unhandled = getUnhandledProps(Uploader, rest);\n    return React.createElement(UploadTrigger, _extends({}, unhandled, {\n      name: name,\n      key: \"trigger\",\n      multiple: multiple,\n      draggable: draggable,\n      disabled: disabled,\n      accept: accept,\n      ref: this.inputRef,\n      onChange: this.handleUploadTriggerChange,\n      componentClass: toggleComponentClass\n    }), children);\n  };\n\n  _proto.render = function render() {\n    var _classNames;\n\n    var _this$props12 = this.props,\n        classPrefix = _this$props12.classPrefix,\n        className = _this$props12.className,\n        listType = _this$props12.listType,\n        fileListVisible = _this$props12.fileListVisible,\n        locale = _this$props12.locale,\n        style = _this$props12.style,\n        draggable = _this$props12.draggable;\n    var classes = classNames(className, classPrefix, this.addPrefix(listType), (_classNames = {}, _classNames[this.addPrefix('draggable')] = draggable, _classNames));\n    var renderList = [this.renderUploadTrigger()];\n\n    if (fileListVisible) {\n      renderList.push(this.renderFileItems());\n    }\n\n    if (listType === 'picture') {\n      renderList.reverse();\n    }\n\n    return React.createElement(IntlProvider, {\n      locale: locale\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, renderList));\n  };\n\n  return Uploader;\n}(React.Component);\n\nUploader.propTypes = {\n  action: PropTypes.string,\n  accept: PropTypes.string,\n  autoUpload: PropTypes.bool,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  classPrefix: PropTypes.string,\n  defaultFileList: PropTypes.array,\n  fileList: PropTypes.array,\n  data: PropTypes.object,\n  multiple: PropTypes.bool,\n  disabled: PropTypes.bool,\n  disabledFileItem: PropTypes.bool,\n  name: PropTypes.string,\n  timeout: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  headers: PropTypes.object,\n  locale: PropTypes.object,\n  listType: PropTypes.oneOf(['text', 'picture-text', 'picture']),\n  shouldQueueUpdate: PropTypes.func,\n  shouldUpload: PropTypes.func,\n  onChange: PropTypes.func,\n  onUpload: PropTypes.func,\n  onReupload: PropTypes.func,\n  onPreview: PropTypes.func,\n  onError: PropTypes.func,\n  onSuccess: PropTypes.func,\n  onProgress: PropTypes.func,\n  onRemove: PropTypes.func,\n  maxPreviewFileSize: PropTypes.number,\n  style: PropTypes.object,\n  toggleComponentClass: PropTypes.elementType,\n  renderFileInfo: PropTypes.func,\n  removable: PropTypes.bool,\n  fileListVisible: PropTypes.bool,\n  draggable: PropTypes.bool\n};\nUploader.defaultProps = {\n  autoUpload: true,\n  timeout: 0,\n  name: 'file',\n  multiple: false,\n  disabled: false,\n  withCredentials: false,\n  data: {},\n  listType: 'text',\n  removable: true,\n  fileListVisible: true\n};\nexport default compose(withLocale(['Uploader']), defaultProps({\n  classPrefix: 'uploader'\n}))(Uploader);"]},"metadata":{},"sourceType":"module"}