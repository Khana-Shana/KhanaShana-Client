{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _pick from \"lodash/pick\";\nimport _get from \"lodash/get\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { shallowEqualArray } from 'rsuite-utils/lib/utils';\nimport { polyfill } from 'react-lifecycles-compat';\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\nimport Checkbox from '../Checkbox';\nimport createUtils from './utils';\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\nimport { PLACEMENT } from '../constants';\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction } from '../utils';\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\nimport { PickerToggle, MenuWrapper, SearchBar, SelectedElement, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\n\nvar MultiCascader = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(MultiCascader, _React$Component);\n\n  function MultiCascader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.isControlled = null;\n    _this.menuContainerRef = void 0;\n    _this.positionRef = void 0;\n    _this.triggerRef = void 0;\n\n    _this.handleCheck = function (item, event, checked) {\n      var _this$props = _this.props,\n          valueKey = _this$props.valueKey,\n          onChange = _this$props.onChange,\n          cascade = _this$props.cascade,\n          uncheckableItemValues = _this$props.uncheckableItemValues;\n      var itemValue = item[valueKey];\n      var value = [];\n\n      if (cascade) {\n        value = MultiCascader.utils.splitValue(item, checked, _this.getValue(), uncheckableItemValues).value;\n      } else {\n        value = _this.getValue();\n\n        if (checked) {\n          value.push(itemValue);\n        } else {\n          value = value.filter(function (n) {\n            return n !== itemValue;\n          });\n        }\n      }\n\n      if (!_this.isControlled) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n    };\n\n    _this.handleChangeForSearchItem = function (value, checked, event) {\n      _this.handleCheck(value, event, checked);\n    };\n\n    _this.handleSelect = function (node, cascadeItems, activePaths, event) {\n      var _this$props2 = _this.props,\n          onSelect = _this$props2.onSelect,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey;\n\n      _this.setState({\n        selectNode: node,\n        items: cascadeItems,\n        activePaths: activePaths\n      }, function () {\n        if (_this.positionRef.current) {\n          _this.positionRef.current.updatePosition();\n        }\n      });\n\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, node[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }), event);\n    };\n\n    _this.handleSearch = function (searchKeyword, event) {\n      var _this$props$onSearch, _this$props3;\n\n      _this.setState({\n        searchKeyword: searchKeyword\n      });\n\n      (_this$props$onSearch = (_this$props3 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props3, searchKeyword, event);\n    };\n\n    _this.handleCloseDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.hide();\n      }\n    };\n\n    _this.handleOpenDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.show();\n      }\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props4 = _this.props,\n          disabled = _this$props4.disabled,\n          onChange = _this$props4.onChange,\n          data = _this$props4.data;\n\n      if (disabled) {\n        return;\n      }\n\n      var nextState = {\n        items: [data],\n        selectNode: null,\n        activePaths: []\n      };\n\n      if (!_this.isControlled) {\n        nextState.value = [];\n      }\n\n      _this.setState(nextState);\n\n      onChange === null || onChange === void 0 ? void 0 : onChange([], event);\n    };\n\n    _this.handleEntered = function () {\n      var _this$props$onOpen, _this$props5;\n\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleExit = function () {\n      var _this$props$onClose, _this$props6;\n\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\n\n      _this.setState({\n        searchKeyword: '',\n        active: false\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.renderSearchRow = function (item, key) {\n      var _extends2, _classNames;\n\n      var _this$props7 = _this.props,\n          labelKey = _this$props7.labelKey,\n          valueKey = _this$props7.valueKey,\n          cascade = _this$props7.cascade,\n          _this$props7$disabled = _this$props7.disabledItemValues,\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\n      var searchKeyword = _this.state.searchKeyword;\n\n      var values = _this.getValue();\n\n      var nodes = getNodeParents(item);\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\n      var labelElements = [];\n      var a = item[labelKey].split(regx);\n      var b = item[labelKey].match(regx);\n\n      for (var i = 0; i < a.length; i++) {\n        labelElements.push(a[i]);\n\n        if (b[i]) {\n          labelElements.push(React.createElement(\"strong\", {\n            key: i\n          }, b[i]));\n        }\n      }\n\n      nodes.push(_extends({}, item, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2)));\n      var active = values.some(function (value) {\n        if (cascade) {\n          return nodes.some(function (node) {\n            return node[valueKey] === value;\n          });\n        }\n\n        return item[valueKey] === value;\n      });\n      var disabled = disabledItemValues.some(function (value) {\n        return nodes.some(function (node) {\n          return node[valueKey] === value;\n        });\n      });\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\n      return React.createElement(\"div\", {\n        key: key,\n        className: itemClasses\n      }, React.createElement(Checkbox, {\n        disabled: disabled,\n        checked: active,\n        value: item,\n        indeterminate: cascade && !active && MultiCascader.utils.isSomeChildChecked(item, values),\n        onChange: _this.handleChangeForSearchItem\n      }, React.createElement(\"span\", {\n        className: _this.addPrefix('cascader-cols')\n      }, nodes.map(function (node, index) {\n        return React.createElement(\"span\", {\n          key: \"col-\" + index,\n          className: _this.addPrefix('cascader-col')\n        }, node[labelKey]);\n      }))));\n    };\n\n    var _data = props.data,\n        _value = props.value,\n        defaultValue = props.defaultValue;\n    var initState = {\n      data: _data,\n      searchKeyword: '',\n      prevValue: _value,\n      value: defaultValue || [],\n      selectNode: null,\n\n      /**\n       * 选中值的路径\n       */\n      activePaths: []\n    };\n    MultiCascader.utils = createUtils(props);\n    var flattenData = flattenTree(_data, props.childrenKey);\n    _this.isControlled = !_isUndefined(_value);\n    _this.state = _extends({}, initState, {\n      flattenData: flattenData,\n\n      /**\n       * 用于展示面板的数据列表，是一个二维的数组\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\n       */\n      items: [flattenData.filter(function (item) {\n        return !item.parent;\n      })]\n    }, MultiCascader.getCascadeState(props, flattenData)); // for test\n\n    _this.menuContainerRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    return _this;\n  }\n\n  MultiCascader.getCascadeState = function getCascadeState(nextProps, flattenData, nextValue) {\n    var data = nextProps.data,\n        cascade = nextProps.cascade,\n        value = nextProps.value,\n        defaultValue = nextProps.defaultValue,\n        uncheckableItemValues = nextProps.uncheckableItemValues;\n    var cascadeValue = nextValue || value || defaultValue || [];\n\n    if (cascade && data) {\n      cascadeValue = MultiCascader.utils.transformValue(cascadeValue, flattenData, uncheckableItemValues);\n    }\n\n    return {\n      value: cascadeValue\n    };\n  };\n\n  MultiCascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var data = nextProps.data,\n        valueKey = nextProps.valueKey,\n        childrenKey = nextProps.childrenKey;\n    var value = nextProps.value || prevState.value || [];\n    var prevValue = prevState.prevValue,\n        _prevState$selectNode = prevState.selectNode,\n        selectNode = _prevState$selectNode === void 0 ? {} : _prevState$selectNode,\n        items = prevState.items;\n    var flattenData = prevState.flattenData;\n    var isChangedData = data !== prevState.data;\n    var isChangedValue = !shallowEqualArray(prevValue, nextProps.value);\n\n    if (isChangedData || isChangedValue) {\n      if (isChangedData) {\n        flattenData = flattenTree(data, nextProps.childrenKey);\n      }\n      /**\n       * 如果更新了 data,\n       * 首先获取到被点击节点的值 `selectNode`， 然后再拿到新增后的 `newChildren`,\n       */\n\n\n      var nextSelectNode = flattenData.find(function (n) {\n        return selectNode && n[valueKey] === selectNode[valueKey];\n      });\n      var newChildren = (_get(nextSelectNode, childrenKey) || []).map(function (item) {\n        item.parent = nextSelectNode;\n        return item;\n      });\n\n      if (newChildren.length && items) {\n        items[items.length - 1] = newChildren;\n      }\n\n      var nextState = _extends({\n        selectNode: nextSelectNode,\n        flattenData: flattenData,\n        data: data,\n        items: MultiCascader.utils.getItems(nextSelectNode, flattenData)\n      }, MultiCascader.getCascadeState(nextProps, flattenData, value));\n\n      if (isChangedValue) {\n        nextState.prevValue = nextProps.value;\n      }\n\n      return nextState;\n    }\n\n    return null;\n  };\n\n  var _proto = MultiCascader.prototype;\n\n  _proto.getValue = function getValue() {\n    return this.state.value || [];\n  };\n\n  _proto.getSearchResult = function getSearchResult() {\n    var _this$props8 = this.props,\n        labelKey = _this$props8.labelKey,\n        valueKey = _this$props8.valueKey,\n        _this$props8$unchecka = _this$props8.uncheckableItemValues,\n        uncheckableItemValues = _this$props8$unchecka === void 0 ? [] : _this$props8$unchecka;\n    var _this$state = this.state,\n        searchKeyword = _this$state.searchKeyword,\n        flattenData = _this$state.flattenData;\n    var items = [];\n    var result = flattenData.filter(function (item) {\n      if (uncheckableItemValues.some(function (value) {\n        return item[valueKey] === value;\n      })) {\n        return false;\n      }\n\n      if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\n        return true;\n      }\n\n      return false;\n    });\n\n    for (var i = 0; i < result.length; i++) {\n      items.push(result[i]);\n\n      if (i === 99) {\n        return items;\n      }\n    }\n\n    return items;\n  };\n\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\n    var locale = this.props.locale;\n    var searchKeyword = this.state.searchKeyword;\n\n    if (searchKeyword === '') {\n      return null;\n    }\n\n    var items = this.getSearchResult();\n    return React.createElement(\"div\", {\n      className: this.addPrefix('cascader-search-panel')\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\n      className: this.addPrefix('none')\n    }, locale.noResultsText));\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _classNames2;\n\n    var _this$state2 = this.state,\n        items = _this$state2.items,\n        activePaths = _this$state2.activePaths,\n        searchKeyword = _this$state2.searchKeyword;\n    var _this$props9 = this.props,\n        renderMenu = _this$props9.renderMenu,\n        renderExtraFooter = _this$props9.renderExtraFooter,\n        menuClassName = _this$props9.menuClassName,\n        menuStyle = _this$props9.menuStyle,\n        classPrefix = _this$props9.classPrefix,\n        searchable = _this$props9.searchable,\n        locale = _this$props9.locale,\n        inline = _this$props9.inline;\n    var classes = classNames(this.addPrefix('cascader-menu'), this.addPrefix('multi-cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\n\n    var menuProps = _pick(this.props, Object.keys(dropdownMenuPropTypes));\n\n    return React.createElement(MenuWrapper, {\n      className: classes,\n      style: menuStyle\n    }, searchable && React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: this.handleSearch,\n      value: searchKeyword\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\n      classPrefix: classPrefix,\n      ref: this.menuContainerRef,\n      cascadeItems: items,\n      cascadePathItems: activePaths,\n      value: this.getValue(),\n      onSelect: this.handleSelect,\n      onCheck: this.handleCheck,\n      renderMenu: renderMenu\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.render = function render() {\n    var _this$props10 = this.props,\n        valueKey = _this$props10.valueKey,\n        labelKey = _this$props10.labelKey,\n        childrenKey = _this$props10.childrenKey,\n        placeholder = _this$props10.placeholder,\n        renderValue = _this$props10.renderValue,\n        disabled = _this$props10.disabled,\n        cleanable = _this$props10.cleanable,\n        locale = _this$props10.locale,\n        toggleComponentClass = _this$props10.toggleComponentClass,\n        style = _this$props10.style,\n        onEnter = _this$props10.onEnter,\n        onExited = _this$props10.onExited,\n        onClean = _this$props10.onClean,\n        countable = _this$props10.countable,\n        cascade = _this$props10.cascade,\n        inline = _this$props10.inline,\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"childrenKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"countable\", \"cascade\", \"inline\"]);\n\n    if (inline) {\n      return this.renderDropdownMenu();\n    }\n\n    var flattenData = this.state.flattenData;\n    var unhandled = getUnhandledProps(MultiCascader, rest);\n    var value = this.getValue();\n    var selectedItems = flattenData.filter(function (item) {\n      return value.some(function (v) {\n        return v === item[valueKey];\n      });\n    }) || [];\n    var count = selectedItems.length;\n    var hasValue = !!count;\n    var selectedElement = placeholder;\n\n    if (count > 0) {\n      selectedElement = React.createElement(SelectedElement, {\n        selectedItems: selectedItems,\n        countable: countable,\n        valueKey: valueKey,\n        labelKey: labelKey,\n        childrenKey: childrenKey,\n        prefix: this.addPrefix,\n        cascade: cascade,\n        locale: locale\n      });\n\n      if (renderValue) {\n        selectedElement = renderValue(value, selectedItems, selectedElement);\n      }\n    }\n\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\n    return React.createElement(\"div\", {\n      className: classes,\n      style: style,\n      tabIndex: -1,\n      role: \"menu\"\n    }, React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: this.positionRef,\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\n      onExit: createChainedFunction(this.handleExit, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      componentClass: toggleComponentClass,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      hasValue: hasValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return MultiCascader;\n}(React.Component);\n\nMultiCascader.propTypes = {\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  classPrefix: PropTypes.string,\n  cascade: PropTypes.bool,\n  data: PropTypes.array,\n  disabledItemValues: PropTypes.array,\n  className: PropTypes.string,\n  container: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  containerPadding: PropTypes.number,\n  block: PropTypes.bool,\n  toggleComponentClass: PropTypes.elementType,\n  menuClassName: PropTypes.string,\n  menuStyle: PropTypes.object,\n  childrenKey: PropTypes.string,\n  valueKey: PropTypes.string,\n  labelKey: PropTypes.string,\n  disabled: PropTypes.bool,\n  value: PropTypes.array,\n  defaultValue: PropTypes.array,\n  placeholder: PropTypes.node,\n  locale: PropTypes.object,\n  cleanable: PropTypes.bool,\n  open: PropTypes.bool,\n  defaultOpen: PropTypes.bool,\n  countable: PropTypes.bool,\n  placement: PropTypes.oneOf(PLACEMENT),\n  menuWidth: PropTypes.number,\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  style: PropTypes.object,\n  uncheckableItemValues: PropTypes.array,\n  searchable: PropTypes.bool,\n  preventOverflow: PropTypes.bool,\n  renderMenuItem: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderValue: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  onSearch: PropTypes.func,\n  onChange: PropTypes.func,\n  onClean: PropTypes.func,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onHide: PropTypes.func,\n  onEnter: PropTypes.func,\n  onEntering: PropTypes.func,\n  onEntered: PropTypes.func,\n  onExit: PropTypes.func,\n  onExiting: PropTypes.func,\n  onExited: PropTypes.func,\n  onSelect: PropTypes.func,\n  inline: PropTypes.bool\n};\nMultiCascader.defaultProps = {\n  cascade: true,\n  appearance: 'default',\n  data: [],\n  disabledItemValues: [],\n  uncheckableItemValues: [],\n  childrenKey: 'children',\n  valueKey: 'value',\n  labelKey: 'label',\n  locale: {\n    placeholder: 'Select',\n    checkAll: 'All',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  },\n  cleanable: true,\n  searchable: true,\n  countable: true,\n  placement: 'bottomStart'\n};\nMultiCascader.utils = {};\npolyfill(MultiCascader);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(MultiCascader);","map":{"version":3,"sources":["/mnt/c/Users/Dell/Desktop/KhanaWeb/khanaweb/node_modules/rsuite/es/MultiCascader/MultiCascader.js"],"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_pick","_get","_isUndefined","React","PropTypes","classNames","shallowEqualArray","polyfill","DropdownMenu","dropdownMenuPropTypes","Checkbox","createUtils","flattenTree","getNodeParents","PLACEMENT","defaultProps","prefix","getUnhandledProps","createChainedFunction","getSafeRegExpString","PickerToggle","MenuWrapper","SearchBar","SelectedElement","PickerToggleTrigger","getToggleWrapperClassName","createConcatChildrenFunction","MultiCascader","_React$Component","props","_this","call","isControlled","menuContainerRef","positionRef","triggerRef","handleCheck","item","event","checked","_this$props","valueKey","onChange","cascade","uncheckableItemValues","itemValue","value","utils","splitValue","getValue","push","filter","n","setState","handleChangeForSearchItem","handleSelect","node","cascadeItems","activePaths","_this$props2","onSelect","childrenKey","selectNode","items","current","updatePosition","handleSearch","searchKeyword","_this$props$onSearch","_this$props3","onSearch","handleCloseDropdown","hide","handleOpenDropdown","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleClean","_this$props4","disabled","data","nextState","handleEntered","_this$props$onOpen","_this$props5","onOpen","active","handleExit","_this$props$onClose","_this$props6","onClose","addPrefix","name","classPrefix","renderSearchRow","key","_extends2","_classNames","_this$props7","labelKey","_this$props7$disabled","disabledItemValues","state","values","nodes","regx","RegExp","labelElements","a","split","b","match","i","length","createElement","some","itemClasses","className","indeterminate","isSomeChildChecked","map","index","_data","_value","defaultValue","initState","prevValue","flattenData","parent","getCascadeState","createRef","nextProps","nextValue","cascadeValue","transformValue","getDerivedStateFromProps","prevState","_prevState$selectNode","isChangedData","isChangedValue","nextSelectNode","find","newChildren","getItems","_proto","prototype","getSearchResult","_this$props8","_this$props8$unchecka","_this$state","result","renderSearchResultPanel","locale","noResultsText","renderDropdownMenu","_classNames2","_this$state2","_this$props9","renderMenu","renderExtraFooter","menuClassName","menuStyle","searchable","inline","classes","menuProps","Object","keys","style","placeholder","searchPlaceholder","ref","cascadePathItems","onCheck","render","_this$props10","renderValue","cleanable","toggleComponentClass","onEnter","onExited","onClean","countable","rest","unhandled","selectedItems","v","count","hasValue","selectedElement","tabIndex","role","pickerProps","onExit","speaker","componentClass","Component","propTypes","appearance","oneOf","string","bool","array","container","oneOfType","func","containerPadding","number","block","elementType","object","defaultOpen","placement","menuWidth","menuHeight","preventOverflow","renderMenuItem","onHide","onEntering","onEntered","onExiting","checkAll"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _pick from \"lodash/pick\";\nimport _get from \"lodash/get\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { shallowEqualArray } from 'rsuite-utils/lib/utils';\nimport { polyfill } from 'react-lifecycles-compat';\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\nimport Checkbox from '../Checkbox';\nimport createUtils from './utils';\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\nimport { PLACEMENT } from '../constants';\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction } from '../utils';\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\nimport { PickerToggle, MenuWrapper, SearchBar, SelectedElement, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\n\nvar MultiCascader =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(MultiCascader, _React$Component);\n\n  function MultiCascader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.isControlled = null;\n    _this.menuContainerRef = void 0;\n    _this.positionRef = void 0;\n    _this.triggerRef = void 0;\n\n    _this.handleCheck = function (item, event, checked) {\n      var _this$props = _this.props,\n          valueKey = _this$props.valueKey,\n          onChange = _this$props.onChange,\n          cascade = _this$props.cascade,\n          uncheckableItemValues = _this$props.uncheckableItemValues;\n      var itemValue = item[valueKey];\n      var value = [];\n\n      if (cascade) {\n        value = MultiCascader.utils.splitValue(item, checked, _this.getValue(), uncheckableItemValues).value;\n      } else {\n        value = _this.getValue();\n\n        if (checked) {\n          value.push(itemValue);\n        } else {\n          value = value.filter(function (n) {\n            return n !== itemValue;\n          });\n        }\n      }\n\n      if (!_this.isControlled) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n    };\n\n    _this.handleChangeForSearchItem = function (value, checked, event) {\n      _this.handleCheck(value, event, checked);\n    };\n\n    _this.handleSelect = function (node, cascadeItems, activePaths, event) {\n      var _this$props2 = _this.props,\n          onSelect = _this$props2.onSelect,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey;\n\n      _this.setState({\n        selectNode: node,\n        items: cascadeItems,\n        activePaths: activePaths\n      }, function () {\n        if (_this.positionRef.current) {\n          _this.positionRef.current.updatePosition();\n        }\n      });\n\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, node[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }), event);\n    };\n\n    _this.handleSearch = function (searchKeyword, event) {\n      var _this$props$onSearch, _this$props3;\n\n      _this.setState({\n        searchKeyword: searchKeyword\n      });\n\n      (_this$props$onSearch = (_this$props3 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props3, searchKeyword, event);\n    };\n\n    _this.handleCloseDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.hide();\n      }\n    };\n\n    _this.handleOpenDropdown = function () {\n      if (_this.triggerRef.current) {\n        _this.triggerRef.current.show();\n      }\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props4 = _this.props,\n          disabled = _this$props4.disabled,\n          onChange = _this$props4.onChange,\n          data = _this$props4.data;\n\n      if (disabled) {\n        return;\n      }\n\n      var nextState = {\n        items: [data],\n        selectNode: null,\n        activePaths: []\n      };\n\n      if (!_this.isControlled) {\n        nextState.value = [];\n      }\n\n      _this.setState(nextState);\n\n      onChange === null || onChange === void 0 ? void 0 : onChange([], event);\n    };\n\n    _this.handleEntered = function () {\n      var _this$props$onOpen, _this$props5;\n\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleExit = function () {\n      var _this$props$onClose, _this$props6;\n\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\n\n      _this.setState({\n        searchKeyword: '',\n        active: false\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.renderSearchRow = function (item, key) {\n      var _extends2, _classNames;\n\n      var _this$props7 = _this.props,\n          labelKey = _this$props7.labelKey,\n          valueKey = _this$props7.valueKey,\n          cascade = _this$props7.cascade,\n          _this$props7$disabled = _this$props7.disabledItemValues,\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\n      var searchKeyword = _this.state.searchKeyword;\n\n      var values = _this.getValue();\n\n      var nodes = getNodeParents(item);\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\n      var labelElements = [];\n      var a = item[labelKey].split(regx);\n      var b = item[labelKey].match(regx);\n\n      for (var i = 0; i < a.length; i++) {\n        labelElements.push(a[i]);\n\n        if (b[i]) {\n          labelElements.push(React.createElement(\"strong\", {\n            key: i\n          }, b[i]));\n        }\n      }\n\n      nodes.push(_extends({}, item, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2)));\n      var active = values.some(function (value) {\n        if (cascade) {\n          return nodes.some(function (node) {\n            return node[valueKey] === value;\n          });\n        }\n\n        return item[valueKey] === value;\n      });\n      var disabled = disabledItemValues.some(function (value) {\n        return nodes.some(function (node) {\n          return node[valueKey] === value;\n        });\n      });\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\n      return React.createElement(\"div\", {\n        key: key,\n        className: itemClasses\n      }, React.createElement(Checkbox, {\n        disabled: disabled,\n        checked: active,\n        value: item,\n        indeterminate: cascade && !active && MultiCascader.utils.isSomeChildChecked(item, values),\n        onChange: _this.handleChangeForSearchItem\n      }, React.createElement(\"span\", {\n        className: _this.addPrefix('cascader-cols')\n      }, nodes.map(function (node, index) {\n        return React.createElement(\"span\", {\n          key: \"col-\" + index,\n          className: _this.addPrefix('cascader-col')\n        }, node[labelKey]);\n      }))));\n    };\n\n    var _data = props.data,\n        _value = props.value,\n        defaultValue = props.defaultValue;\n    var initState = {\n      data: _data,\n      searchKeyword: '',\n      prevValue: _value,\n      value: defaultValue || [],\n      selectNode: null,\n\n      /**\n       * 选中值的路径\n       */\n      activePaths: []\n    };\n    MultiCascader.utils = createUtils(props);\n    var flattenData = flattenTree(_data, props.childrenKey);\n    _this.isControlled = !_isUndefined(_value);\n    _this.state = _extends({}, initState, {\n      flattenData: flattenData,\n\n      /**\n       * 用于展示面板的数据列表，是一个二维的数组\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\n       */\n      items: [flattenData.filter(function (item) {\n        return !item.parent;\n      })]\n    }, MultiCascader.getCascadeState(props, flattenData)); // for test\n\n    _this.menuContainerRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    return _this;\n  }\n\n  MultiCascader.getCascadeState = function getCascadeState(nextProps, flattenData, nextValue) {\n    var data = nextProps.data,\n        cascade = nextProps.cascade,\n        value = nextProps.value,\n        defaultValue = nextProps.defaultValue,\n        uncheckableItemValues = nextProps.uncheckableItemValues;\n    var cascadeValue = nextValue || value || defaultValue || [];\n\n    if (cascade && data) {\n      cascadeValue = MultiCascader.utils.transformValue(cascadeValue, flattenData, uncheckableItemValues);\n    }\n\n    return {\n      value: cascadeValue\n    };\n  };\n\n  MultiCascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var data = nextProps.data,\n        valueKey = nextProps.valueKey,\n        childrenKey = nextProps.childrenKey;\n    var value = nextProps.value || prevState.value || [];\n    var prevValue = prevState.prevValue,\n        _prevState$selectNode = prevState.selectNode,\n        selectNode = _prevState$selectNode === void 0 ? {} : _prevState$selectNode,\n        items = prevState.items;\n    var flattenData = prevState.flattenData;\n    var isChangedData = data !== prevState.data;\n    var isChangedValue = !shallowEqualArray(prevValue, nextProps.value);\n\n    if (isChangedData || isChangedValue) {\n      if (isChangedData) {\n        flattenData = flattenTree(data, nextProps.childrenKey);\n      }\n      /**\n       * 如果更新了 data,\n       * 首先获取到被点击节点的值 `selectNode`， 然后再拿到新增后的 `newChildren`,\n       */\n\n\n      var nextSelectNode = flattenData.find(function (n) {\n        return selectNode && n[valueKey] === selectNode[valueKey];\n      });\n      var newChildren = (_get(nextSelectNode, childrenKey) || []).map(function (item) {\n        item.parent = nextSelectNode;\n        return item;\n      });\n\n      if (newChildren.length && items) {\n        items[items.length - 1] = newChildren;\n      }\n\n      var nextState = _extends({\n        selectNode: nextSelectNode,\n        flattenData: flattenData,\n        data: data,\n        items: MultiCascader.utils.getItems(nextSelectNode, flattenData)\n      }, MultiCascader.getCascadeState(nextProps, flattenData, value));\n\n      if (isChangedValue) {\n        nextState.prevValue = nextProps.value;\n      }\n\n      return nextState;\n    }\n\n    return null;\n  };\n\n  var _proto = MultiCascader.prototype;\n\n  _proto.getValue = function getValue() {\n    return this.state.value || [];\n  };\n\n  _proto.getSearchResult = function getSearchResult() {\n    var _this$props8 = this.props,\n        labelKey = _this$props8.labelKey,\n        valueKey = _this$props8.valueKey,\n        _this$props8$unchecka = _this$props8.uncheckableItemValues,\n        uncheckableItemValues = _this$props8$unchecka === void 0 ? [] : _this$props8$unchecka;\n    var _this$state = this.state,\n        searchKeyword = _this$state.searchKeyword,\n        flattenData = _this$state.flattenData;\n    var items = [];\n    var result = flattenData.filter(function (item) {\n      if (uncheckableItemValues.some(function (value) {\n        return item[valueKey] === value;\n      })) {\n        return false;\n      }\n\n      if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\n        return true;\n      }\n\n      return false;\n    });\n\n    for (var i = 0; i < result.length; i++) {\n      items.push(result[i]);\n\n      if (i === 99) {\n        return items;\n      }\n    }\n\n    return items;\n  };\n\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\n    var locale = this.props.locale;\n    var searchKeyword = this.state.searchKeyword;\n\n    if (searchKeyword === '') {\n      return null;\n    }\n\n    var items = this.getSearchResult();\n    return React.createElement(\"div\", {\n      className: this.addPrefix('cascader-search-panel')\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\n      className: this.addPrefix('none')\n    }, locale.noResultsText));\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _classNames2;\n\n    var _this$state2 = this.state,\n        items = _this$state2.items,\n        activePaths = _this$state2.activePaths,\n        searchKeyword = _this$state2.searchKeyword;\n    var _this$props9 = this.props,\n        renderMenu = _this$props9.renderMenu,\n        renderExtraFooter = _this$props9.renderExtraFooter,\n        menuClassName = _this$props9.menuClassName,\n        menuStyle = _this$props9.menuStyle,\n        classPrefix = _this$props9.classPrefix,\n        searchable = _this$props9.searchable,\n        locale = _this$props9.locale,\n        inline = _this$props9.inline;\n    var classes = classNames(this.addPrefix('cascader-menu'), this.addPrefix('multi-cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\n\n    var menuProps = _pick(this.props, Object.keys(dropdownMenuPropTypes));\n\n    return React.createElement(MenuWrapper, {\n      className: classes,\n      style: menuStyle\n    }, searchable && React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: this.handleSearch,\n      value: searchKeyword\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\n      classPrefix: classPrefix,\n      ref: this.menuContainerRef,\n      cascadeItems: items,\n      cascadePathItems: activePaths,\n      value: this.getValue(),\n      onSelect: this.handleSelect,\n      onCheck: this.handleCheck,\n      renderMenu: renderMenu\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.render = function render() {\n    var _this$props10 = this.props,\n        valueKey = _this$props10.valueKey,\n        labelKey = _this$props10.labelKey,\n        childrenKey = _this$props10.childrenKey,\n        placeholder = _this$props10.placeholder,\n        renderValue = _this$props10.renderValue,\n        disabled = _this$props10.disabled,\n        cleanable = _this$props10.cleanable,\n        locale = _this$props10.locale,\n        toggleComponentClass = _this$props10.toggleComponentClass,\n        style = _this$props10.style,\n        onEnter = _this$props10.onEnter,\n        onExited = _this$props10.onExited,\n        onClean = _this$props10.onClean,\n        countable = _this$props10.countable,\n        cascade = _this$props10.cascade,\n        inline = _this$props10.inline,\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"childrenKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"countable\", \"cascade\", \"inline\"]);\n\n    if (inline) {\n      return this.renderDropdownMenu();\n    }\n\n    var flattenData = this.state.flattenData;\n    var unhandled = getUnhandledProps(MultiCascader, rest);\n    var value = this.getValue();\n    var selectedItems = flattenData.filter(function (item) {\n      return value.some(function (v) {\n        return v === item[valueKey];\n      });\n    }) || [];\n    var count = selectedItems.length;\n    var hasValue = !!count;\n    var selectedElement = placeholder;\n\n    if (count > 0) {\n      selectedElement = React.createElement(SelectedElement, {\n        selectedItems: selectedItems,\n        countable: countable,\n        valueKey: valueKey,\n        labelKey: labelKey,\n        childrenKey: childrenKey,\n        prefix: this.addPrefix,\n        cascade: cascade,\n        locale: locale\n      });\n\n      if (renderValue) {\n        selectedElement = renderValue(value, selectedItems, selectedElement);\n      }\n    }\n\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\n    return React.createElement(\"div\", {\n      className: classes,\n      style: style,\n      tabIndex: -1,\n      role: \"menu\"\n    }, React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: this.positionRef,\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\n      onExit: createChainedFunction(this.handleExit, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      componentClass: toggleComponentClass,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      hasValue: hasValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return MultiCascader;\n}(React.Component);\n\nMultiCascader.propTypes = {\n  appearance: PropTypes.oneOf(['default', 'subtle']),\n  classPrefix: PropTypes.string,\n  cascade: PropTypes.bool,\n  data: PropTypes.array,\n  disabledItemValues: PropTypes.array,\n  className: PropTypes.string,\n  container: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n  containerPadding: PropTypes.number,\n  block: PropTypes.bool,\n  toggleComponentClass: PropTypes.elementType,\n  menuClassName: PropTypes.string,\n  menuStyle: PropTypes.object,\n  childrenKey: PropTypes.string,\n  valueKey: PropTypes.string,\n  labelKey: PropTypes.string,\n  disabled: PropTypes.bool,\n  value: PropTypes.array,\n  defaultValue: PropTypes.array,\n  placeholder: PropTypes.node,\n  locale: PropTypes.object,\n  cleanable: PropTypes.bool,\n  open: PropTypes.bool,\n  defaultOpen: PropTypes.bool,\n  countable: PropTypes.bool,\n  placement: PropTypes.oneOf(PLACEMENT),\n  menuWidth: PropTypes.number,\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  style: PropTypes.object,\n  uncheckableItemValues: PropTypes.array,\n  searchable: PropTypes.bool,\n  preventOverflow: PropTypes.bool,\n  renderMenuItem: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderValue: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  onSearch: PropTypes.func,\n  onChange: PropTypes.func,\n  onClean: PropTypes.func,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onHide: PropTypes.func,\n  onEnter: PropTypes.func,\n  onEntering: PropTypes.func,\n  onEntered: PropTypes.func,\n  onExit: PropTypes.func,\n  onExiting: PropTypes.func,\n  onExited: PropTypes.func,\n  onSelect: PropTypes.func,\n  inline: PropTypes.bool\n};\nMultiCascader.defaultProps = {\n  cascade: true,\n  appearance: 'default',\n  data: [],\n  disabledItemValues: [],\n  uncheckableItemValues: [],\n  childrenKey: 'children',\n  valueKey: 'value',\n  labelKey: 'label',\n  locale: {\n    placeholder: 'Select',\n    checkAll: 'All',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  },\n  cleanable: true,\n  searchable: true,\n  countable: true,\n  placement: 'bottomStart'\n};\nMultiCascader.utils = {};\npolyfill(MultiCascader);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(MultiCascader);"]},"metadata":{},"sourceType":"module"}