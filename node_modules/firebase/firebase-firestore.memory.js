!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Il){"use strict";try{(function(){Il=Il&&Object.prototype.hasOwnProperty.call(Il,"default")?Il.default:Il;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,v=(n(g,d=Error),g);function g(t,e){var n=d.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function k(t){return"number"==typeof t}function R(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function O(){}function L(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){return"array"==L(t)}function C(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),P=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function F(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[U]||(this[U]=++P)},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Y=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=_.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=O;var st,ut,at=K(X,"Opera"),ht=K(X,"Trident")||K(X,"MSIE"),ct=K(X,"Edge"),lt=ct||ht,ft=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),pt=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,ft?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(u){return t=u,e=function(){for(var t=0,e=J(String(st)).split("."),n=J(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},F(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var kt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function Ot(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++Rt,this.X=this.Z=!1}function Lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=H(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Dt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Pt={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(D(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Yt(i);return e&&e[kt]?e.Aa(n,i,V(r)?!!r.capture:!!r,o):qt(e,n,i,!0,r,o)}(t,e,n,i,r);if(D(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Yt(n),t&&t[kt]?t.za(e,n,V(i)?!!i.capture:!!i,r):qt(t,e,n,!1,i,r)}function qt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=V(r)?!!r.capture:!!r;if(s&&!At)return null;var u,a,h=Bt(t);if(h||(t[Ut]=h=new Dt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=Ft,i=a=At?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function xt(t){if(!k(t)&&t&&!t.X){var e=t.src;if(e&&e[kt])Ct(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Gt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Lt(t)}}}function Gt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function jt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&xt(t),n.call(i,e)}function Ft(t,e){return!!t.X||(At?jt(t,new _t(e,this)):jt(t,e=new _t(e||R("window.event"),this)))}function Bt(t){return(t=t[Ut])instanceof Dt?t:null}var Ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yt(e){return"function"==L(e)?e:(e[Ht]||(e[Ht]=function(t){return e.handleEvent(t)}),e[Ht])}function zt(){B.call(this),this.c=new Dt(this),(this.J=this).B=null}function Qt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var u=s.listener,a=s.da||s.src;s.Z&&Ct(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&0!=i.Ia}F(zt,B),zt.prototype[kt]=!0,(I=zt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(D(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=V(r)?!!r.capture:!!r,i=Yt(i),e&&e[kt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Vt(s=e.a[n],i,r,o))&&(Lt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,i,r,o)),(i=-1<e?n[e]:null)&&xt(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Qt(s,i,!0,t)&&r}if(r=Qt(s=t.a=n,i,!0,t)&&r,r=Qt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Qt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(zt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Lt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Kt,Zt=new Xt(function(){return new $t},function(t){t.reset()});function $t(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;Kt||(n=_.Promise.resolve(void 0),Kt=function(){n.then(re)}),ne||(Kt(),ne=!0),ie.add(t,e)}Jt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Jt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){zt.call(this),this.b=t||1,this.a=e||_,this.f=x(this.gb,this),this.g=j()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==L(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ae(t,e,n){B.call(this),this.f=null!=n?x(t,n):t,this.c=e,this.b=x(this.$a,this),this.a=[]}function he(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}F(oe,zt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=j()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},F(ae,B),(I=ae.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ae.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},F(ce,B);var le=[];function fe(t,e,n,i){D(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new zt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(t){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(t){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}F(ve,Tt),F(me,Tt),F(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,ke={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Re(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Le(){}function De(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ce,t=lt?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}F(Re,Tt),F(Oe,Tt),F(Le,Ne),Se=new Le;var Ce=45e3,Ve={},Ue={};function Pe(t,e,n){t.F=1,t.f=an(tn(e)),t.l=n,t.H=!0,qe(t,null)}function Me(t,e,n,i){t.F=1,t.f=an(tn(e)),t.l=null,t.H=n,qe(t,i)}function qe(t,e){t.v=j(),je(t),t.D=tn(t.f),un(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ae(x(t.Ja,t,t.a),t.J)),fe(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge(1)}function xe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=Ge(t,n);if(r==Ue){4==e&&(t.c=4,we(14),i=!1);break}if(r==Ve){t.c=4,we(15),i=!1;break}ze(t,r)}4==e&&0==n.length&&(t.c=1,we(16),i=!1),t.b=t.b&&i,i||(Ye(t),He(t))}function Ge(t,e){var n=t.A,i=e.indexOf("\n",n);return-1==i?Ue:(n=Number(e.substring(n,i)),isNaN(n)?Ve:(i+=1)+n>e.length?Ue:(e=e.substr(i,n),t.A=i+n,e))}function je(t){t.R=j()+t.O,Fe(t,t.O)}function Fe(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(x(t.ab,t),e)}function Be(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function He(t){t.g.Ca()||t.m||t.g.na(t)}function Ye(t){Be(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function ze(t,e){try{t.g.Fa(t,e),ge(4)}catch(t){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(C(t)||S(t))Y(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(C(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(C(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t,e){Ke(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t))}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ke(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ke(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=De.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==ti(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=ti(this.a),n=this.a.ya(),i=this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||ge(8==n||i<=0?3:2),Be(this);var r=this.a.T();this.o=r;var o=this.a.aa();if(this.b=200==r){if(this.S&&!this.s){e:{if(this.a){var s=ei(this.a,"X-HTTP-Initial-Response");if(s&&!W(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.c=3,we(12),Ye(this),He(this);break t}this.s=!0,ze(this,u)}this.H?(xe(this,e,o),lt&&this.b&&3==e&&(fe(this.I,this.P,"tick",this.bb),this.P.start())):ze(this,o),4==e&&Ye(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,je(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,we(12)):(this.c=0,we(13)),Ye(this),He(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=ti(this.a),e=this.a.aa();this.A<e.length&&(Be(this),xe(this,t,e),this.b&&4!=t&&je(this))}},I.cancel=function(){this.m=!0,Ye(this)},I.ab=function(){this.i=null;var t=j();0<=t-this.R?(2!=this.F&&(ge(3),we(17)),Ye(this),this.c=2,He(this)):Fe(this,this.R-t)},(I=We.prototype).C=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Je(this),this.a.concat()},I.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},I.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof $e?(this.h=void 0!==e?e:t.h,en(this,t.f),this.j=t.j,nn(this,t.b),rn(this,t.i),this.a=t.a,on(this,An(t.c)),this.g=t.g):t&&(n=String(t).match(Ze))?(this.h=!!e,en(this,n[1]||"",!0),this.j=hn(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.a=hn(n[5]||"",!0),on(this,n[6]||"",!0),this.g=hn(n[7]||"")):(this.h=!!e,this.c=new gn(null,this.h))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.b=n?hn(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function on(t,e,n){var i,r;e instanceof gn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(mn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},i)),i.f=r):(n||(e=cn(e,yn)),t.c=new gn(e,t.h))}function sn(t,e,n){t.c.set(e,n)}function un(t,e,n){D(n)||(n=[String(n)]),En(t.c,e,n)}function an(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",cn(n,vn)),t.join("")},$e.prototype.resolve=function(t){var e=tn(this),n=!!t.f;n?en(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?nn(e,t.b):n=null!=t.i;var i=t.a;if(n)rn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(K(r,"./")||K(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var u=r[s++];"."==u?i&&s==r.length&&o.push(""):".."==u?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(u),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?on(e,An(t.c)):n=!!t.g,n&&(e.g=t.g),e};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe(t.a,e))}function bn(t,e){return mn(t),e=In(t,e),Ke(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),Q(n)),t.b+=n.length)}function An(t){var e=new gn;return e.c=t.c,t.a&&(e.a=new We(t.a),e.b=t.b),e}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Nn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Tn(t){var e=t.a.F.a;if(null!=e)we(4),e?(we(10),pi(t.a,t,!1)):(we(11),pi(t.a,t,!0));else{t.b=new De(t,void 0,void 0),t.b.h=t.h,e=mi(e=t.a,e.Y()?t.f:null,t.i),we(4),un(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&sn(e,n,i),Me(t.b,e,!1,t.f)}}function _n(){this.a=this.b=null}function Sn(){this.a=new We}function kn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[U]||(t[U]=++P)):e.charAt(0)+t}function Rn(t,e){this.b=t,this.a=e}function On(t){this.g=t||Ln,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Sn),this.b=null,this.c=[]}(I=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){mn(this),this.a.forEach(function(t,e){Y(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){mn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){mn(this);var e=[];if(S(t))bn(this,t)&&(e=z(e,this.a.get(In(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},I.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},F(function(){},function(){}),(I=Nn.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ei(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ei(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void vi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,vi(e,2)}else 1==this.M&&(this.g?we(6):"11111"==e?(we(5),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(11),pi(this.a,this,!0))):(we(7),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Tn(this)):1==this.M&&(this.g?(we(11),pi(this.a,this,!0)):(we(10),pi(this.a,this,!1)));else{0==this.M?we(8):1==this.M&&we(9);var t=this.a;t.m=this.c,vi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},Sn.prototype.add=function(t){this.a.set(kn(t),t)},Sn.prototype.C=function(){return this.a.C()};var Ln=10;function Dn(t,e){!t.a&&(K(e,"spdy")||K(e,"quic")||K(e,"h2"))&&(t.f=t.g,t.a=new Sn,t.b&&(Pn(t,t.b),t.b=null))}function Cn(t){return t.b||t.a&&t.a.a.c>=t.f}function Vn(t){return t.b?1:t.a?t.a.a.c:0}function Un(t,e){return t=t.b?t.b==e:!!t.a&&(e=kn(e),Ke(t.a.a.b,e))}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Mn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=kn(e),n=Ke(t.a.a.b,n)),n&&Xe(t.a.a,kn(e)))}function qn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Q(t.c);var e=t.c;return Y(t.a.C(),function(t){e=e.concat(t.j)}),e}function xn(){}function Gn(){this.a=new xn}function jn(t,i,e){var r=e||"";try{Qe(t,function(t,e){var n=t;V(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Fn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}On.prototype.cancel=function(){var t;this.c=qn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Y(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},xn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Bn=_.JSON.parse;function Hn(t){zt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Yn,this.D=this.F=!1}F(Hn,zt);var Yn="",zn=/^https?$/i,Qn=["POST","PUT"];function Wn(t){return"content-type"==t.toLowerCase()}function Xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Jn(t),Zn(t)}function Jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Kn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=ti(t)||2!=t.T()))if(t.l&&4==ti(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==ti(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Ze)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!zn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<ti(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.T()+"]",Jn(t)}}finally{Zn(t)}}}function Zn(t,e){if(t.a){$n(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function $n(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function ti(t){return t.a?t.a.readyState:0}function ei(t,e){return t.a?t.a.getResponseHeader(e):null}function ni(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return sn(t,e,n),t}function ii(t){this.f=[],this.F=new _n,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!R("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=R("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=R("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=R("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=R("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new On(t&&t.concurrentRequestLimit),this.ja=new Gn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ri(t){if(oi(t),3==t.u){var e=t.P++,n=tn(t.B);sn(n,"SID",t.H),sn(n,"RID",e),sn(n,"TYPE","terminate"),hi(t,n),(e=new De(t,e,void 0)).F=2,e.f=an(tn(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=j(),je(e)}gi(t)}function oi(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),di(t),t.b.cancel(),t.h&&(k(t.h)&&_.clearTimeout(t.h),t.h=null)}function si(t,e){t.f.push(new Rn(t.Qa++,e)),3==t.u&&ui(t)}function ui(t){Cn(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ai(t,e){var n;n=e?e.W:t.P++;var i=tn(t.B);sn(i,"SID",t.H),sn(i,"RID",n),sn(i,"AID",t.O),hi(t,i),t.g&&t.i&&ni(i,t.g,t.i),n=new De(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=ci(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Pn(t.b,n),Pe(n,i,e)}function hi(t,n){t.c&&Qe({},function(t,e){sn(n,e,t)})}function ci(t,e,n){n=Math.min(t.f.length,n);var i=t.c?x(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{jn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function li(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function fi(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(x(t.Ga,t),yi(t,t.v)),t.v++,1)}function pi(t,e,n){var i=e.l;i&&Dn(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=mi(t,null,t.ha),ui(t)}function di(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function yi(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function vi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=x(t.eb,t);n||(n=new $e("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||en(n,"https"),an(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=G(Fn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=G(Fn,n,i,"TestLoadImage: error",!1,e),i.onabort=G(Fn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=G(Fn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we(2);t.u=0,t.c&&t.c.ta(e),gi(t),oi(t)}function gi(t){t.u=0,t.m=-1,t.c&&(0==qn(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.sa())}function mi(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof $e?tn(i):new $e(i,void 0);if(""!=h.b)e&&nn(h,e+"."+h.b),rn(h,h.i);else{var c,l=_.location;c=e?e+"."+l.hostname:l.hostname,r=l.protocol,o=c,s=+l.port,u=n,a=new $e(null,void 0),r&&en(a,r),o&&nn(a,o),s&&rn(a,s),u&&(a.a=u),h=a}return t.V&&et(t.V,function(t,e){sn(h,e,t)}),e=t.j,n=t.I,e&&n&&sn(h,e,n),sn(h,"VER",t.wa),hi(t,h),h}function wi(){}function bi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function Ei(t,e){zt.call(this),this.a=new ii(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else(i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ni(this)}function Ai(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ii(){Oe.call(this),this.status=1}function Ni(t){this.a=t}(I=Hn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=x(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Xn(this,t)}t=n||"";var r,o=new We(this.headers);i&&Qe(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Wn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=H(Qn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{$n(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&k(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Xn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Zn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Zn(this,!0)),Hn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Kn(this):this.Za())},I.Za=function(){Kn(this)},I.T=function(){try{return 2<ti(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ii.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new De(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&S(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ci(this,n,e),sn(r=tn(this.B),"RID",t),sn(r,"CVER",22),this.o&&this.j&&sn(r,"X-HTTP-Session-Id",this.j),hi(this,r),this.g&&i&&ni(r,this.g,i),Pn(this.b,n),this.W?(sn(r,"$req",e),sn(r,"SID","null"),n.S=!0,Pe(n,r,null)):Pe(n,r,e),this.u=2}}else 3==this.u&&(t?ai(this,t):0==this.f.length||Cn(this.b)||ai(this))},I.Ga=function(){this.l=null,this.a=new De(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=tn(this.pa);sn(t,"RID","rpc"),sn(t,"SID",this.H),sn(t,"CI",this.ia?"0":"1"),sn(t,"AID",this.O),hi(this,t),sn(t,"TYPE","xmlhttp"),this.g&&this.i&&ni(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Un(this.b,t)))if(this.m=t.o,!t.s&&Un(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(D(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;di(this),this.a.cancel(),this.a=null}fi(this),we(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(x(this.Ya,this),6e3));if(Vn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else vi(this,11)}else if(!t.s&&this.a!=t||di(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&k(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ei(i,"X-Client-Wire-Protocol"))&&Dn(this.b,r),this.j&&(i=ei(i,"X-HTTP-Session-Id")))&&(this.I=i,sn(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=mi(this,this.Y()?this.ga:null,this.ha),i.s?(Mn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(Be(i),je(i)),this.a=i):li(this),0<this.f.length&&ui(this)}else"stop"!=i[0]&&"close"!=i[0]||vi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?vi(this,7):ri(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fi(this),we(19))},I.na=function(t){var e=null;if(this.a==t){di(this),this.a=null;var n=2}else{if(!Un(this.b,t))return;e=t.j,Mn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=j()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),ui(this)):li(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Vn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(x(t.Ha,t,e),yi(t,t.A)),t.A++,1}}(this,t)||2==n&&fi(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:vi(this,5);break;case 4:vi(this,10);break;case 3:vi(this,6);break;default:vi(this,2)}}},I.eb=function(t){we(t?2:1)},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Hn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=wi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},bi.prototype.a=function(t,e){return new Ei(t,e)},F(Ei,zt),(I=Ei.prototype).addEventListener=function(t,e,n,i){Ei.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){Ei.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(0),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new Nn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ni(e,t.g,t.i)),(t=t.w).i=n,e=mi(t.a,null,t.i),we(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Tn(t)):(un(e,"MODE","init"),!t.a.o&&t.a.j&&un(e,"X-HTTP-Session-Id",t.a.j),t.b=new De(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ri(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,si(this.a,e)}else this.h?((e={}).__data__=Wt(t),si(this.a,e)):si(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ri(this.a),delete this.a,Ei.N.G.call(this)},F(Ai,Re),F(Ii,Oe),F(Ni,wi),Ni.prototype.va=function(){this.a.dispatchEvent("a")},Ni.prototype.ua=function(t){this.a.dispatchEvent(new Ai(t))},Ni.prototype.ta=function(t){this.a.dispatchEvent(new Ii)},Ni.prototype.sa=function(){this.a.dispatchEvent("b")};var Ti=G(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},bi);bi.prototype.createWebChannel=bi.prototype.a,Ei.prototype.send=Ei.prototype.Wa,Ei.prototype.open=Ei.prototype.Va,Ei.prototype.close=Ei.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",zt.prototype.listen=zt.prototype.za,Hn.prototype.listenOnce=Hn.prototype.Aa,Hn.prototype.getLastError=Hn.prototype.Xa,Hn.prototype.getLastErrorCode=Hn.prototype.ya,Hn.prototype.getStatus=Hn.prototype.T,Hn.prototype.getResponseJson=Hn.prototype.Ua,Hn.prototype.getResponseText=Hn.prototype.aa,Hn.prototype.send=Hn.prototype.ca;var _i={createWebChannelTransport:Ti,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:Hn},Si=_i.createWebChannelTransport,ki=_i.ErrorCode,Ri=_i.EventType,Oi=_i.WebChannel,Li=_i.XhrIo,Di=Il.SDK_VERSION,Ci=(Vi.prototype.t=function(){return null!=this.uid},Vi.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Vi.prototype.isEqual=function(t){return t.uid===this.uid},Vi);function Vi(t){this.uid=t}Ci.UNAUTHENTICATED=new Ci(null),Ci.i=new Ci("google-credentials-uid"),Ci.h=new Ci("first-party-uid");function Ui(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Pi,Mi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qi=(n(Ki,Pi=Error),Ki),xi=(Ji.prototype.getToken=function(){return Promise.resolve(null)},Ji.prototype.l=function(){},Ji.prototype._=function(t){(this.u=t)(Ci.UNAUTHENTICATED)},Ji.prototype.T=function(){this.u=null},Ji),Gi=(Xi.prototype.getToken=function(){var e=this,n=this.I,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.I!==n)throw new qi(Mi.ABORTED,"getToken aborted due to token change.");return t?(gu("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Ui(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Xi.prototype.l=function(){this.forceRefresh=!0},Xi.prototype._=function(t){this.u=t,this.R&&t(this.currentUser)},Xi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Xi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return gu(null===t||"string"==typeof t,"Received invalid UID: "+t),new Ci(t)},Xi),ji=(Object.defineProperty(Wi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Wi),Fi=(Qi.prototype.getToken=function(){return Promise.resolve(new ji(this.P,this.V))},Qi.prototype._=function(t){t(Ci.h)},Qi.prototype.T=function(){},Qi.prototype.l=function(){},Qi),Bi=(zi.now=function(){return zi.fromMillis(Date.now())},zi.fromDate=function(t){return zi.fromMillis(t.getTime())},zi.fromMillis=function(t){var e=Math.floor(t/1e3);return new zi(e,1e6*(t-1e3*e))},zi.prototype.toDate=function(){return new Date(this.toMillis())},zi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},zi.prototype.g=function(t){return this.seconds===t.seconds?bu(this.nanoseconds,t.nanoseconds):bu(this.seconds,t.seconds)},zi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},zi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},zi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},zi),Hi=(Yi.v=function(t){return new Yi(t)},Yi.S=function(){return Yi.MIN},Yi.prototype.C=function(t){return this.timestamp.g(t.timestamp)},Yi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Yi.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Yi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Yi.prototype.F=function(){return this.timestamp},Yi);function Yi(t){this.timestamp=t}function zi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Qi(t,e){this.P=t,this.V=e}function Wi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Ci.h}function Xi(t){var e=this;this.m=null,this.currentUser=Ci.UNAUTHENTICATED,this.R=!1,this.I=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.I++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.I=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function Ji(){this.u=null}function Ki(t,e){var n=this;return(n=Pi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Hi.MIN=new Hi(new Bi(0,0));var Zi,$i=(Object.defineProperty(nr.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),nr.prototype.isEqual=function(t){return 0===nr.k(this,t)},nr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof nr?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},nr.prototype.limit=function(){return this.offset+this.length},nr.prototype.$=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},nr.prototype.O=function(){return this.L(this.segments,this.offset,this.length-1)},nr.prototype.M=function(){return this.segments[this.offset]},nr.prototype.U=function(){return this.get(this.length-1)},nr.prototype.get=function(t){return this.segments[this.offset+t]},nr.prototype.q=function(){return 0===this.length},nr.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},nr.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},nr.k=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},nr),tr=(n(er,Zi=$i),er.prototype.L=function(t,e,n){return new er(t,e,n)},er.prototype.G=function(){return this.j().join("/")},er.prototype.toString=function(){return this.G()},er.K=function(t){if(0<=t.indexOf("//"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new er(t.split("/").filter(function(t){return 0<t.length}))},er);function er(){return null!==Zi&&Zi.apply(this,arguments)||this}function nr(t,e,n){void 0===e?e=0:e>t.length&&vu("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&vu("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.N=n}tr.H=new tr([]);var ir,rr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,or=(n(sr,ir=$i),sr.prototype.L=function(t,e,n){return new sr(t,e,n)},sr.J=function(t){return rr.test(t)},sr.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.J(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.G()},sr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},sr.X=function(){return new sr(["__name__"])},sr.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new qi(Mi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qi(Mi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new qi(Mi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr);function sr(){return null!==ir&&ir.apply(this,arguments)||this}or.H=new or([]);var ur=(ar.tt=function(t){return new ar(tr.K(t).$(5))},ar.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ar.prototype.isEqual=function(t){return null!==t&&0===tr.k(this.path,t.path)},ar.prototype.toString=function(){return this.path.toString()},ar.k=function(t,e){return tr.k(t.path,e.path)},ar.st=function(t){return t.length%2==0},ar.it=function(t){return new ar(new tr(t.slice()))},ar);function ar(t){this.path=t}ur.EMPTY=new ur(new tr([]));var hr=(dr.prototype.nt=function(t,e){return new dr(this.k,this.root.nt(t,e,this.k).rt(null,null,lr.ht,null,null))},dr.prototype.remove=function(t){return new dr(this.k,this.root.remove(t,this.k).rt(null,null,lr.ht,null,null))},dr.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},dr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.k(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},dr.prototype.q=function(){return this.root.q()},Object.defineProperty(dr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),dr.prototype.ot=function(){return this.root.ot()},dr.prototype.at=function(){return this.root.at()},dr.prototype.ut=function(t){return this.root.ut(t)},dr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},dr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},dr.prototype.ct=function(t){return this.root.ct(t)},dr.prototype.lt=function(){return new cr(this.root,null,this.k,!1)},dr.prototype._t=function(t){return new cr(this.root,t,this.k,!1)},dr.prototype.dt=function(){return new cr(this.root,null,this.k,!0)},dr.prototype.ft=function(t){return new cr(this.root,t,this.k,!0)},dr),cr=(pr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.q();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.q();)this.Tt.push(t),t=t.left;return e},pr.prototype.Rt=function(){return 0<this.Tt.length},pr.prototype.It=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},pr),lr=(fr.prototype.rt=function(t,e,n,i,r){return new fr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},fr.prototype.q=function(){return!1},fr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},fr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},fr.prototype.min=function(){return this.left.q()?this:this.left.min()},fr.prototype.ot=function(){return this.min().key},fr.prototype.at=function(){return this.right.q()?this.key:this.right.at()},fr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},fr.prototype.Pt=function(){if(this.left.q())return fr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},fr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.q()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.q())return fr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},fr.prototype.Vt=function(){return this.color},fr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},fr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},fr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},fr.prototype.bt=function(){var t=this.rt(null,null,fr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},fr.prototype.gt=function(){var t=this.rt(null,null,fr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},fr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},fr.prototype.St=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},fr.prototype.Ct=function(){if(this.Vt()&&this.left.Vt())throw vu("Red node has red child("+this.key+","+this.value+")");if(this.right.Vt())throw vu("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Ct();if(t!==this.right.Ct())throw vu("Black depths differ");return t+(this.Vt()?0:1)},fr);function fr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:fr.RED,this.left=null!=i?i:fr.EMPTY,this.right=null!=r?r:fr.EMPTY,this.size=this.left.size+1+this.right.size}function pr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function dr(t,e){this.k=t,this.root=e||lr.EMPTY}function yr(){this.size=0}lr.EMPTY=null,lr.RED=!0,lr.ht=!1,lr.EMPTY=(Object.defineProperty(yr.prototype,"key",{get:function(){throw vu("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"value",{get:function(){throw vu("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"color",{get:function(){throw vu("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"left",{get:function(){throw vu("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"right",{get:function(){throw vu("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),yr.prototype.rt=function(t,e,n,i,r){return this},yr.prototype.nt=function(t,e,n){return new lr(t,e)},yr.prototype.remove=function(t,e){return this},yr.prototype.q=function(){return!0},yr.prototype.ut=function(t){return!1},yr.prototype.ct=function(t){return!1},yr.prototype.ot=function(){return null},yr.prototype.at=function(){return null},yr.prototype.Vt=function(){return!1},yr.prototype.St=function(){return!0},yr.prototype.Ct=function(){return 0},new yr);var vr=(wr.prototype.has=function(t){return null!==this.data.get(t)},wr.prototype.first=function(){return this.data.ot()},wr.prototype.last=function(){return this.data.at()},Object.defineProperty(wr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),wr.prototype.indexOf=function(t){return this.data.indexOf(t)},wr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},wr.prototype.Dt=function(t,e){for(var n=this.data._t(t[0]);n.Rt();){var i=n.Et();if(0<=this.k(i.key,t[1]))return;e(i.key)}},wr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.Rt();)if(!t(n.Et().key))return},wr.prototype.Nt=function(t){var e=this.data._t(t);return e.Rt()?e.Et().key:null},wr.prototype.lt=function(){return new gr(this.data.lt())},wr.prototype._t=function(t){return new gr(this.data._t(t))},wr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},wr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},wr.prototype.q=function(){return this.data.q()},wr.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},wr.prototype.isEqual=function(t){if(!(t instanceof wr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(0!==this.k(i,r))return!1}return!0},wr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},wr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},wr.prototype.rt=function(t){var e=new wr(this.k);return e.data=t,e},wr),gr=(mr.prototype.Et=function(){return this.Lt.Et().key},mr.prototype.Rt=function(){return this.Lt.Rt()},mr);function mr(t){this.Lt=t}function wr(t){this.k=t,this.data=new hr(this.k)}function br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ar(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ir=(Nr.fromBase64String=function(t){return new Nr(au.Ot().atob(t))},Nr.fromUint8Array=function(t){return new Nr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Nr.prototype.toBase64=function(){return au.Ot().btoa(this.$t)},Nr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.$t)},Nr.prototype.Mt=function(){return 2*this.$t.length},Nr.prototype.C=function(t){return bu(this.$t,t.$t)},Nr.prototype.isEqual=function(t){return this.$t===t.$t},Nr);function Nr(t){this.$t=t}function Tr(t){return null==t}function _r(t){return-0===t&&1/t==-1/0}function Sr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function kr(t){var e=Pr(t.mapValue.fields.__local_write_time__.timestampValue);return new Bi(e.seconds,e.nanos)}Ir.Ut=new Ir("");var Rr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Or(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sr(t)?4:10:vu("Invalid value type: "+JSON.stringify(t))}function Lr(r,t){var e,n,i,o=Or(r);if(o!==Or(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return kr(r).isEqual(kr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Pr(r.timestampValue),n=Pr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,qr(r.bytesValue).isEqual(qr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Mr((e=r).geoPointValue.latitude)===Mr(n.geoPointValue.latitude)&&Mr(e.geoPointValue.longitude)===Mr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mr(t.integerValue)===Mr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mr(t.doubleValue),i=Mr(e.doubleValue);return n===i?_r(n)===_r(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return Eu(r.arrayValue.values||[],t.arrayValue.values||[],Lr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(br(e)!==br(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Lr(e[i],n[i])))return!1;return!0}(t);default:return vu("Unexpected value type: "+JSON.stringify(r))}}function Dr(t,e){return void 0!==(t.values||[]).find(function(t){return Lr(t,e)})}function Cr(t,e){var n,i,r,o,s,u,a,h,c,l,f=Or(t),p=Or(e);if(f!==p)return bu(f,p);switch(f){case 0:return 0;case 1:return bu(t.booleanValue,e.booleanValue);case 2:return h=e,c=Mr(t.integerValue||t.doubleValue),l=Mr(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Vr(t.timestampValue,e.timestampValue);case 4:return Vr(kr(t),kr(e));case 5:return bu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=qr(o),a=qr(s),u.C(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=bu(n[r],i[r]);if(0!==o)return o}return bu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=bu(Mr(n.latitude),Mr(i.latitude)))?r:bu(Mr(n.longitude),Mr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Cr(n[r],i[r]);if(o)return o}return bu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=bu(i[s],o[s]);if(0!==u)return u;var a=Cr(n[i[s]],r[o[s]]);if(0!==a)return a}return bu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw vu("Invalid value type: "+f)}}function Vr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return bu(t,e);var n=Pr(t),i=Pr(e),r=bu(n.seconds,i.seconds);return 0!==r?r:bu(n.nanos,i.nanos)}function Ur(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Pr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?qr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ur.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):vu("Invalid value type: "+JSON.stringify(r));var t,e,n}(t)}function Pr(t){if(gu(!!t,"Cannot normalize null or undefined timestamp."),"string"!=typeof t)return{seconds:Mr(t.seconds),nanos:Mr(t.nanos)};var e=0,n=Rr.exec(t);if(gu(!!n,"invalid timestamp: "+t),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Mr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qr(t){return"string"==typeof t?Ir.fromBase64String(t):Ir.fromUint8Array(t)}function xr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function Gr(t){return t&&"integerValue"in t}function jr(t){return!!t&&"arrayValue"in t}function Fr(t){return t&&"nullValue"in t}function Br(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hr(t){return t&&"mapValue"in t}var Yr=(zr.prototype.qt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},zr.prototype.Bt=function(t,e){return e},zr.prototype.xt=function(t){return null},zr.prototype.isEqual=function(t){return t instanceof zr},zr);function zr(){}Yr.instance=new Yr;var Qr=(Zr.prototype.qt=function(t,e){return this.apply(t)},Zr.prototype.Bt=function(t,e){return this.apply(t)},Zr.prototype.apply=function(t){for(var n=$r(t),e=function(e){n.some(function(t){return Lr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Zr.prototype.xt=function(t){return null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&Eu(this.elements,t.elements,Lr)},Zr),Wr=(Kr.prototype.qt=function(t,e){return this.apply(t)},Kr.prototype.Bt=function(t,e){return this.apply(t)},Kr.prototype.apply=function(t){for(var n=$r(t),e=function(e){n=n.filter(function(t){return!Lr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Kr.prototype.xt=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&Eu(this.elements,t.elements,Lr)},Kr),Xr=(Jr.prototype.qt=function(t,e){var n=this.xt(t),i=this.asNumber(n)+this.asNumber(this.Qt);return Gr(n)&&Gr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Jr.prototype.Bt=function(t,e){return e},Jr.prototype.xt=function(t){return Gr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Jr.prototype.isEqual=function(t){return t instanceof Jr&&Lr(this.Qt,t.Qt)},Jr.prototype.asNumber=function(t){return Mr(t.integerValue||t.doubleValue)},Jr);function Jr(t,e){this.serializer=t,this.Qt=e}function Kr(t){this.elements=t}function Zr(t){this.elements=t}function $r(t){return jr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function to(t,e){this.version=t,this.transformResults=e}var eo=(so.Gt=function(t){return new so(t)},so.zt=function(t){var e=new vr(or.k);return t.forEach(function(t){return e=e.add(t)}),new so(e)},so.prototype.Kt=function(e){var n=!1;return this.fields.forEach(function(t){t.B(e)&&(n=!0)}),n},so.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},so),no=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),io=(ro.exists=function(t){return new ro(void 0,t)},ro.updateTime=function(t){return new ro(t)},Object.defineProperty(ro.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),ro.prototype.Jt=function(t){return void 0!==this.updateTime?t instanceof Do&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Do},ro.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ro);function ro(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){this.fields=t}io.NONE=new io;var uo,ao,ho,co,lo,fo=(_o.prototype.Yt=function(t){},_o.Xt=function(t){return t instanceof Do?t.version:Hi.MIN},_o),po=(n(To,lo=fo),To.prototype.Bt=function(t,e){this.Yt(t);var n=e.version;return new Do(this.key,n,this.value,{hasCommittedMutations:!0})},To.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=fo.Xt(t);return new Do(this.key,i,this.value,{te:!0})},To.prototype.ee=function(t){return null},To.prototype.isEqual=function(t){return t instanceof To&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},To),yo=(n(No,co=fo),No.prototype.Bt=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new Vo(this.key,e.version);var n=this.ie(t);return new Do(this.key,e.version,n,{hasCommittedMutations:!0})},No.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=fo.Xt(t),r=this.ie(t);return new Do(this.key,i,r,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},No.prototype.ie=function(t){var e;return e=t instanceof Do?t.data():wo.EMPTY,this.ne(e)},No.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},No),vo=(n(Io,ho=fo),Io.prototype.Bt=function(t,e){if(this.Yt(t),gu(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.Zt.Jt(t))return new Vo(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Do(this.key,r,o,{hasCommittedMutations:!0})},Io.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Do(this.key,i.version,o,{te:!0})},Io.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Do?t.field(r.field):void 0,s=r.transform.xt(o||null);null!=s&&(e=null==e?wo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&Eu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Io.prototype.oe=function(t){return t},Io.prototype.ae=function(t,e){var n=[];gu(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Do&&(s=t.field(r.field)),n.push(o.Bt(s,e[i]))}return n},Io.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Do&&(a=e.field(s.field)),null===a&&n instanceof Do&&(a=n.field(s.field)),i.push(u.qt(a,t))}return i},Io.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Io),go=(n(Ao,ao=fo),Ao.prototype.Bt=function(t,e){return this.Yt(t),new Co(this.key,e.version,{hasCommittedMutations:!0})},Ao.prototype.qt=function(t,e,n){return this.Yt(t),this.Zt.Jt(t)?new Co(this.key,Hi.S()):t},Ao.prototype.ee=function(t){return null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Ao),mo=(n(Eo,uo=fo),Eo.prototype.Bt=function(t,e){vu("VerifyMutation should only be used in Transactions.")},Eo.prototype.qt=function(t,e,n){vu("VerifyMutation should only be used in Transactions.")},Eo.prototype.ee=function(t){vu("VerifyMutation should only be used in Transactions.")},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),wo=(bo.le=function(){return bo.EMPTY.re()},bo.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Hr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null},bo.prototype.se=function(){return this._e(this.proto.mapValue)},bo.prototype._e=function(t){var r=this,o=new vr(or.k);return Er(t.fields||{},function(t,e){var n=new or([t]);if(10===Or(e)){var i=r._e(e.mapValue).fields;i.q()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),eo.Gt(o)},bo.prototype.isEqual=function(t){return Lr(this.proto,t.proto)},bo.prototype.re=function(){return new Oo(this)},bo);function bo(t){this.proto=t}function Eo(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Ao(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Io(t,e){var n=this;return(n=ho.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=io.exists(!0),n}function No(t,e,n,i){var r=this;return(r=co.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function To(t,e,n){var i=this;return(i=lo.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function _o(){}wo.EMPTY=new wo({mapValue:{}});var So,ko,Ro,Oo=(Yo.prototype.set=function(t,e){return this.we(t,e),this},Yo.prototype.delete=function(t){return this.we(t,null),this},Yo.prototype.we=function(t,e){for(var n=this.fe,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===Or(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.U(),e)},Yo.prototype.he=function(){var t=this.Te(or.H,this.fe);return null!=t?new wo(t):this.de},Yo.prototype.Te=function(i,t){var r=this,o=!1,e=this.de.field(i),s=Hr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Yo),Lo=(Ho.me=function(t,e){return ur.k(t.key,e.key)},Ho),Do=(n(Bo,Ro=Lo),Bo.prototype.field=function(t){return this.Ee.field(t)},Bo.prototype.data=function(){return this.Ee},Bo.prototype.Re=function(){return this.Ee.proto},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ee.isEqual(t.Ee)},Bo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ee.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Bo.Ie=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Cr(i,r):vu("Trying to compare documents on fields that don't exist")},Bo),Co=(n(Fo,ko=Lo),Fo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Fo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Fo.prototype.isEqual=function(t){return t instanceof Fo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Fo),Vo=(n(jo,So=Lo),jo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),jo.prototype.isEqual=function(t){return t instanceof jo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},jo),Uo=(Go.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Tr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},Go.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Tr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Go.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Go.prototype.Pe=function(){return ur.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},Go),Po=(xo.ve=function(t){return new xo(t)},Object.defineProperty(xo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.Ce();if(null!==t&&null===e)t.Y()?this.ge=[gs]:this.ge=[new vs(t),gs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:rs.ASCENDING;this.ge.push(s===rs.ASCENDING?gs:ms)}}}return this.ge},enumerable:!0,configurable:!0}),xo.prototype.De=function(t){var e=this.filters.concat([t]);return new xo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new xo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Ne=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},xo.prototype.ke=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},xo.prototype.Le=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},xo.prototype.$e=function(t){return new xo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},xo.prototype.Oe=function(t){return new xo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},xo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},xo.prototype.canonicalId=function(){return this.Ue().canonicalId()+"|lt:"+this.pe},xo.prototype.toString=function(){return"Query(target="+this.Ue().toString()+"; limitType="+this.pe+")"},xo.prototype.isEqual=function(t){return this.Ue().isEqual(t.Ue())&&this.pe===t.pe},xo.prototype.qe=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},xo.prototype.matches=function(t){return this.Be(t)&&this.xe(t)&&this.Qe(t)&&this.We(t)},xo.prototype.je=function(){return!Tr(this.limit)&&"F"===this.pe},xo.prototype.Ge=function(){return!Tr(this.limit)&&"L"===this.pe},xo.prototype.Ce=function(){return 0<this.Ve.length?this.Ve[0].field:null},xo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Zo&&n.ze())return n.field}return null},xo.prototype.Ke=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Zo&&0<=t.indexOf(i.op))return i.op}return null},xo.prototype.Pe=function(){return this.Ue().Pe()},xo.prototype.He=function(){return null!==this.collectionGroup},xo.prototype.Ue=function(){if(!this.ye)if("F"===this.pe)this.ye=new Uo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===rs.DESCENDING?rs.ASCENDING:rs.DESCENDING;t.push(new vs(i.field,r))}var o=this.endAt?new ys(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ys(this.startAt.position,!this.startAt.before):null;this.ye=new Uo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},xo.prototype.Be=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.B(e):ur.st(this.path)?this.path.isEqual(e):this.path.W(e)},xo.prototype.xe=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},xo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},xo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},xo.prototype.be=function(t){},xo),Mo=(qo.K=function(t){switch(t){case"<":return qo.LESS_THAN;case"<=":return qo.LESS_THAN_OR_EQUAL;case"==":return qo.EQUAL;case">=":return qo.GREATER_THAN_OR_EQUAL;case">":return qo.GREATER_THAN;case"array-contains":return qo.ARRAY_CONTAINS;case"in":return qo.IN;case"array-contains-any":return qo.ARRAY_CONTAINS_ANY;default:return vu("Unknown FieldFilter operator: "+t)}},qo.prototype.toString=function(){return this.name},qo.prototype.isEqual=function(t){return this.name===t.name},qo);function qo(t){this.name=t}function xo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=u,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function Go(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function jo(){return null!==So&&So.apply(this,arguments)||this}function Fo(t,e,n){var i=this;return(i=ko.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Bo(t,e,n,i){var r=this;return(r=Ro.call(this,t,e)||this).Ee=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Ho(t,e){this.key=t,this.version=e}function Yo(t){this.de=t,this.fe=new Map}Mo.LESS_THAN=new Mo("<"),Mo.LESS_THAN_OR_EQUAL=new Mo("<="),Mo.EQUAL=new Mo("=="),Mo.GREATER_THAN=new Mo(">"),Mo.GREATER_THAN_OR_EQUAL=new Mo(">="),Mo.ARRAY_CONTAINS=new Mo("array-contains"),Mo.IN=new Mo("in"),Mo.ARRAY_CONTAINS_ANY=new Mo("array-contains-any");var zo,Qo,Wo,Xo,Jo,Ko,Zo=(n(ls,Ko=function(){}),ls.create=function(t,e,n){if(t.Y())return e===Mo.IN?new ts(t,n):new $o(t,e,n);if(Fr(n)){if(e!==Mo.EQUAL)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ls(t,e,n)}if(Br(n)){if(e!==Mo.EQUAL)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ls(t,e,n)}return e===Mo.ARRAY_CONTAINS?new es(t,n):e===Mo.IN?new ns(t,n):e===Mo.ARRAY_CONTAINS_ANY?new is(t,n):new ls(t,e,n)},ls.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Or(this.value)===Or(e)&&this.Ye(Cr(e,this.value))},ls.prototype.Ye=function(t){switch(this.op){case Mo.LESS_THAN:return t<0;case Mo.LESS_THAN_OR_EQUAL:return t<=0;case Mo.EQUAL:return 0===t;case Mo.GREATER_THAN:return 0<t;case Mo.GREATER_THAN_OR_EQUAL:return 0<=t;default:return vu("Unknown FieldFilter operator: "+this.op)}},ls.prototype.ze=function(){return 0<=[Mo.LESS_THAN,Mo.LESS_THAN_OR_EQUAL,Mo.GREATER_THAN,Mo.GREATER_THAN_OR_EQUAL].indexOf(this.op)},ls.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Ur(this.value)},ls.prototype.isEqual=function(t){return t instanceof ls&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Lr(this.value,t.value)},ls.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Ur(this.value)},ls),$o=(n(cs,Jo=Zo),cs.prototype.matches=function(t){var e=ur.k(t.key,this.key);return this.Ye(e)},cs),ts=(n(hs,Xo=Zo),hs.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},hs),es=(n(as,Wo=Zo),as.prototype.matches=function(t){var e=t.field(this.field);return jr(e)&&Dr(e.arrayValue,this.value)},as),ns=(n(us,Qo=Zo),us.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Dr(this.value.arrayValue,e)},us),is=(n(ss,zo=Zo),ss.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!jr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Dr(e.value.arrayValue,t)})},ss),rs=(os.prototype.toString=function(){return this.name},os);function os(t){this.name=t}function ss(t,e){return zo.call(this,t,Mo.ARRAY_CONTAINS_ANY,e)||this}function us(t,e){return Qo.call(this,t,Mo.IN,e)||this}function as(t,e){return Wo.call(this,t,Mo.ARRAY_CONTAINS,e)||this}function hs(t,e){var n=this;return(n=Xo.call(this,t,Mo.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ur.tt(t.referenceValue)}),n}function cs(t,e,n){var i=this;return(i=Jo.call(this,t,e,n)||this).key=ur.tt(n.referenceValue),i}function ls(t,e,n){var i=this;return(i=Ko.call(this)||this).field=t,i.op=e,i.value=n,i}rs.ASCENDING=new rs("asc"),rs.DESCENDING=new rs("desc");function fs(t){this.count=t}var ps,ds,ys=(As.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Ur(t)}).join(",")},As.prototype.Je=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?ur.k(ur.tt(o.referenceValue),e.key):Cr(o,e.field(r.field)),r.dir===rs.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},As.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Lr(this.position[e],t.position[e]))return!1;return!0},As),vs=(Es.prototype.compare=function(t,e){var n=this.Xe?Do.me(t,e):Do.Ie(this.field,t,e);switch(this.dir){case rs.ASCENDING:return n;case rs.DESCENDING:return-1*n;default:return vu("Unknown direction: "+this.dir)}},Es.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},Es.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},Es.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Es),gs=new vs(or.X(),rs.ASCENDING),ms=new vs(or.X(),rs.DESCENDING),ws=(bs.prototype.es=function(t){return new bs(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bs.prototype.ss=function(t,e){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bs.prototype.ns=function(t){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},bs);function bs(t,e,n,i,r,o,s){void 0===r&&(r=Hi.MIN),void 0===o&&(o=Hi.MIN),void 0===s&&(s=Ir.Ut),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Es(t,e){this.field=t,void 0===e&&(e=rs.ASCENDING),this.dir=e,this.Xe=t.Y()}function As(t,e){this.position=t,this.before=e}function Is(t){switch(t){case Mi.OK:return vu("Treated status OK as error");case Mi.CANCELLED:case Mi.UNKNOWN:case Mi.DEADLINE_EXCEEDED:case Mi.RESOURCE_EXHAUSTED:case Mi.INTERNAL:case Mi.UNAVAILABLE:case Mi.UNAUTHENTICATED:return;case Mi.INVALID_ARGUMENT:case Mi.NOT_FOUND:case Mi.ALREADY_EXISTS:case Mi.PERMISSION_DENIED:case Mi.FAILED_PRECONDITION:case Mi.ABORTED:case Mi.OUT_OF_RANGE:case Mi.UNIMPLEMENTED:case Mi.DATA_LOSS:return 1;default:return vu("Unknown status code: "+t)}}function Ns(t){if(void 0===t)return du("GRPC error has no .code"),Mi.UNKNOWN;switch(t){case ps.OK:return Mi.OK;case ps.CANCELLED:return Mi.CANCELLED;case ps.UNKNOWN:return Mi.UNKNOWN;case ps.DEADLINE_EXCEEDED:return Mi.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return Mi.RESOURCE_EXHAUSTED;case ps.INTERNAL:return Mi.INTERNAL;case ps.UNAVAILABLE:return Mi.UNAVAILABLE;case ps.UNAUTHENTICATED:return Mi.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return Mi.INVALID_ARGUMENT;case ps.NOT_FOUND:return Mi.NOT_FOUND;case ps.ALREADY_EXISTS:return Mi.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return Mi.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return Mi.FAILED_PRECONDITION;case ps.ABORTED:return Mi.ABORTED;case ps.OUT_OF_RANGE:return Mi.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return Mi.UNIMPLEMENTED;case ps.DATA_LOSS:return Mi.DATA_LOSS;default:return vu("Unknown status code: "+t)}}(ds=ps=ps||{})[ds.OK=0]="OK",ds[ds.CANCELLED=1]="CANCELLED",ds[ds.UNKNOWN=2]="UNKNOWN",ds[ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ds[ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ds[ds.NOT_FOUND=5]="NOT_FOUND",ds[ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",ds[ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",ds[ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",ds[ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ds[ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ds[ds.ABORTED=10]="ABORTED",ds[ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",ds[ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",ds[ds.INTERNAL=13]="INTERNAL",ds[ds.UNAVAILABLE=14]="UNAVAILABLE",ds[ds.DATA_LOSS=15]="DATA_LOSS";var Ts=new hr(ur.k);function _s(){return Ts}function Ss(){return _s()}var ks=new hr(ur.k);function Rs(){return ks}var Os=new hr(ur.k);function Ls(){return Os}var Ds=new vr(ur.k);function Cs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ds,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Vs=new vr(bu);function Us(){return Vs}function Ps(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Ms(t,e){this.targetId=t,this.bs=e}function qs(t,e,n,i){void 0===n&&(n=Ir.Ut),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var xs=(Zs.os=function(t){return new Zs(t.k)},Zs.prototype.has=function(t){return null!=this.rs.get(t)},Zs.prototype.get=function(t){return this.rs.get(t)},Zs.prototype.first=function(){return this.hs.ot()},Zs.prototype.last=function(){return this.hs.at()},Zs.prototype.q=function(){return this.hs.q()},Zs.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Zs.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Zs.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Zs.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Zs.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Zs.prototype.isEqual=function(t){if(!(t instanceof Zs))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},Zs.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Zs.prototype.rt=function(t,e){var n=new Zs;return n.k=this.k,n.rs=t,n.hs=e,n},Zs),Gs=(Ks.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):vu("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},Ks.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Ks),js=(Js.fs=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Js(t,e,xs.os(e),r,n,i,!0,!1)},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return!this.ls.q()},enumerable:!0,configurable:!0}),Js.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Js),Fs=(Xs.Rs=function(t,e){var n=new Map;return n.set(t,Bs.Is(t,e)),new Xs(Hi.MIN,n,Us(),_s(),Cs())},Xs),Bs=(Ws.Is=function(t,e){return new Ws(Ir.Ut,e,Cs(),Cs(),Cs())},Ws),Hs=(Object.defineProperty(Qs.prototype,"As",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"resumeToken",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"ks",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),Qs.prototype.Ls=function(t){0<t.Mt()&&(this.Fs=!0,this.Cs=t)},Qs.prototype.$s=function(){var n=Cs(),i=Cs(),r=Cs();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:vu("Encountered invalid change type: "+e)}}),new Bs(this.Cs,this.Ds,n,i,r)},Qs.prototype.Os=function(){this.Fs=!1,this.Ss=tu()},Qs.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},Qs.prototype.Us=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},Qs.prototype.qs=function(){this.vs+=1},Qs.prototype.Bs=function(){--this.vs},Qs.prototype.xs=function(){this.Fs=!0,this.Ds=!0},Qs),Ys=(zs.prototype.Ks=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Do?this.Hs(i,t.ys):t.ys instanceof Co&&this.Js(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Js(s,t.key,t.ys)}},zs.prototype.Ys=function(n){var i=this;this.Xs(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.Ls(n.resumeToken);break;case 1:e.Bs(),e.Ns||e.Os(),e.Ls(n.resumeToken);break;case 2:e.Bs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.xs(),e.Ls(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.Ls(n.resumeToken));break;default:vu("Unknown target watch change state: "+n.state)}})},zs.prototype.Xs=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},zs.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new ur(r.path);this.Js(e,o,new Co(o,Hi.S()))}else gu(1===n,"Single document existence filter with count: "+n);else this.ni(e)!==n&&(this.ei(e),this.zs=this.zs.add(e))}},zs.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new ur(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Js(e,i,new Co(i,r))}t.ks&&(s.set(e,t.$s()),t.Os())}});var i=Cs();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new Fs(r,s,this.zs,this.js,i);return this.js=_s(),this.Gs=$s(),this.zs=new vr(bu),t},zs.prototype.Hs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},zs.prototype.Js=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.Us(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},zs.prototype.removeTarget=function(t){this.Ws.delete(t)},zs.prototype.ni=function(t){var e=this.Zs(t).$s();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},zs.prototype.qs=function(t){this.Zs(t).qs()},zs.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Hs,this.Ws.set(t,e)),e},zs.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new vr(bu),this.Gs=this.Gs.nt(t,e)),e},zs.prototype.ti=function(t){var e=null!==this.ii(t);return e||pu("WatchChangeAggregator","Detected inactive target",t),e},zs.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},zs.prototype.ei=function(e){var n=this;this.Ws.set(e,new Hs),this.Qs.ai(e).forEach(function(t){n.Js(e,t,null)})},zs.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},zs);function zs(t){this.Qs=t,this.Ws=new Map,this.js=_s(),this.Gs=$s(),this.zs=new vr(bu)}function Qs(){this.vs=0,this.Ss=tu(),this.Cs=Ir.Ut,this.Ds=!1,this.Fs=!0}function Ws(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Xs(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.ms=i,this.Es=r}function Js(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.ds=u}function Ks(){this.as=new hr(ur.k)}function Zs(n){this.k=n?function(t,e){return n(t,e)||ur.k(t.key,e.key)}:function(t,e){return ur.k(t.key,e.key)},this.rs=Rs(),this.hs=new hr(this.k)}function $s(){return new hr(ur.k)}function tu(){return new hr(ur.k)}var eu,nu,iu=((nu={})[rs.ASCENDING.name]="ASCENDING",nu[rs.DESCENDING.name]="DESCENDING",nu),ru=((eu={})[Mo.LESS_THAN.name]="LESS_THAN",eu[Mo.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",eu[Mo.GREATER_THAN.name]="GREATER_THAN",eu[Mo.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",eu[Mo.EQUAL.name]="EQUAL",eu[Mo.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",eu[Mo.IN.name]="IN",eu[Mo.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",eu),ou=(su.prototype.li=function(t){var e=void 0===t.code?Mi.UNKNOWN:Ns(t.code);return new qi(e,t.message||"")},su.prototype._i=function(t){return this.options.di||Tr(t)?t:{value:t}},su.prototype.fi=function(t){var e;return Tr(e="object"==typeof t?t.value:t)?null:e},su.prototype.Wt=function(t){return{integerValue:""+t}},su.prototype.jt=function(t){if(this.options.di){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_r(t)?"-0":t}},su.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!_r(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},su.prototype.F=function(t){return this.options.di?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},su.prototype.v=function(t){var e=Pr(t);return new Bi(e.seconds,e.nanos)},su.prototype.Ti=function(t){return this.options.di?t.toBase64():t.toUint8Array()},su.prototype.mi=function(t){return this.options.di?(gu(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),Ir.fromBase64String(t||"")):(gu(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),Ir.fromUint8Array(t||new Uint8Array))},su.prototype.toVersion=function(t){return this.F(t.F())},su.prototype.fromVersion=function(t){return gu(!!t,"Trying to deserialize version that isn't set"),Hi.v(this.v(t))},su.prototype.Ei=function(t,e){return this.Ri(e||this.ci).child("documents").child(t).G()},su.prototype.Ii=function(t){var e=tr.K(t);return gu(uu(e),"Tried to deserialize invalid key "+e.toString()),e},su.prototype.Ai=function(t){return this.Ei(t.path)},su.prototype.tt=function(t){var e=this.Ii(t);return gu(e.get(1)===this.ci.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.ci.projectId),gu(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.ci.database),new ur(this.Pi(e))},su.prototype.Vi=function(t){return this.Ei(t)},su.prototype.pi=function(t){var e=this.Ii(t);return 4===e.length?tr.H:this.Pi(e)},Object.defineProperty(su.prototype,"gi",{get:function(){return new tr(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),su.prototype.Ri=function(t){return new tr(["projects",t.projectId,"databases",t.database])},su.prototype.Pi=function(t){return gu(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.$(5)},su.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},su.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.Re().mapValue.fields,updateTime:this.F(t.version.F())}},su.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new wo({mapValue:{fields:t.fields}});return new Do(n,i,r,{hasCommittedMutations:!!e})},su.prototype.Si=function(t){gu(!!t.found,"Tried to deserialize a found document from a missing document."),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new wo({mapValue:{fields:t.found.fields}});return new Do(e,n,i,{})},su.prototype.Ci=function(t){gu(!!t.missing,"Tried to deserialize a missing document from a found document."),gu(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Co(e,n)},su.prototype.Di=function(t){return"found"in t?this.Si(t):"missing"in t?this.Ci(t):vu("invalid batch get response: "+JSON.stringify(t))},su.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.mi(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.li(o);e=new qs(n,i,r,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.tt(u.document.name),h=this.fromVersion(u.document.updateTime),c=new wo({mapValue:{fields:u.document.fields}}),l=new Do(a,h,c,{}),f=u.targetIds||[],p=u.removedTargetIds||[];e=new Ps(f,p,l.key,l)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.tt(d.document),v=d.readTime?this.fromVersion(d.readTime):Hi.S(),g=new Co(y,v),m=d.removedTargetIds||[];e=new Ps([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.tt(w.document),E=w.removedTargetIds||[];e=new Ps([],E,b,null)}else{if(!("filter"in t))return vu("Unknown change type "+JSON.stringify(t));t.filter;var A=t.filter;A.targetId;var I=A.count||0,N=new fs(I),T=A.targetId;e=new Ms(T,N)}return e},su.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:vu("Got unexpected TargetChange.state: "+t)},su.prototype.ki=function(t){if(!("targetChange"in t))return Hi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Hi.MIN:this.fromVersion(e.readTime)},su.prototype.Li=function(t){var e,n=this;if(t instanceof po)e={update:this.yi(t.key,t.value)};else if(t instanceof go)e={delete:this.Ai(t.key)};else if(t instanceof yo)e={update:this.yi(t.key,t.data),updateMask:this.$i(t.se)};else if(t instanceof vo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof mo))return vu("Unknown mutation type "+t.type);e={verify:this.Ai(t.key)}}return t.Zt.Ht||(e.currentDocument=this.Mi(t.Zt)),e},su.prototype.Ui=function(t){var e=this,n=t.currentDocument?this.qi(t.currentDocument):io.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new wo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Bi(t.updateMask);return new yo(i,r,o,n)}return new po(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new go(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.xi(t)});return gu(!0===n.exists,'Transforms only support precondition "exists == true"'),new vo(u,a)}if(t.verify){var h=this.tt(t.verify);return new mo(h,n)}return vu("unknown mutation proto: "+JSON.stringify(t))},su.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:vu("Unknown precondition")},su.prototype.qi=function(t){return void 0!==t.updateTime?io.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?io.exists(t.exists):io.NONE},su.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Hi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new to(n,i)},su.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(gu(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.Qi(t,e)})):[]},su.prototype.Oi=function(t){var e=t.transform;if(e instanceof Yr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof Qr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Xr)return{fieldPath:t.field.G(),increment:e.Qt};throw vu("Unknown transform: "+t.transform)},su.prototype.xi=function(t){var e=null;if("setToServerValue"in t)gu("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=Yr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Qr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Wr(i)}else"increment"in t?e=new Xr(this,t.increment):vu("Unknown transform proto: "+JSON.stringify(t));var r=or.Z(t.fieldPath);return new no(r,e)},su.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},su.prototype.Gi=function(t){var e=t.documents.length;gu(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Po.ve(this.pi(n)).Ue()},su.prototype.zi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.U()}]);var i=this.Ki(t.filters);i&&(e.structuredQuery.where=i);var r=this.Hi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Ji(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Ji(t.endAt)),e},su.prototype.Yi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){gu(1===i,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xi(n.where));var u=[];n.orderBy&&(u=this.Zi(n.orderBy));var a=null;n.limit&&(a=this.fi(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Po(e,r,u,s,a,"F",h,c).Ue()},su.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},su.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return vu("Unrecognized query purpose: "+t)}},su.prototype.Ue=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.zi(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},su.prototype.Ki=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Zo?e.in(t):vu("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},su.prototype.Xi=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xi(t)}).reduce(function(t,e){return t.concat(e)}):vu("Unknown filter: "+JSON.stringify(t)):[]},su.prototype.Hi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},su.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},su.prototype.Ji=function(t){return{before:t.before,values:t.position}},su.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ys(n,e)},su.prototype.an=function(t){return iu[t.name]},su.prototype.un=function(t){switch(t){case"ASCENDING":return rs.ASCENDING;case"DESCENDING":return rs.DESCENDING;default:return}},su.prototype.cn=function(t){return ru[t.name]},su.prototype.ln=function(t){switch(t){case"EQUAL":return Mo.EQUAL;case"GREATER_THAN":return Mo.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Mo.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Mo.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Mo.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Mo.ARRAY_CONTAINS;case"IN":return Mo.IN;case"ARRAY_CONTAINS_ANY":return Mo.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return vu("Unspecified operator");default:return vu("Unknown operator")}},su.prototype._n=function(t){return{fieldPath:t.G()}},su.prototype.dn=function(t){return or.Z(t.fieldPath)},su.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},su.prototype.on=function(t){return new vs(this.dn(t.field),this.un(t.direction))},su.prototype.rn=function(t){return Zo.create(this.dn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},su.prototype.in=function(t){if(t.op===Mo.EQUAL){if(Br(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(Fr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},su.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.dn(t.unaryFilter.field);return Zo.create(e,Mo.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.dn(t.unaryFilter.field);return Zo.create(n,Mo.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return vu("Unspecified filter");default:return vu("Unknown filter")}},su.prototype.$i=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},su.prototype.Bi=function(t){var e=(t.fieldPaths||[]).map(function(t){return or.Z(t)});return eo.zt(e)},su);function su(t,e){this.ci=t,this.options=e}function uu(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var au=(cu.fn=function(t){cu.platform&&vu("Platform already defined"),cu.platform=t},cu.Ot=function(){return cu.platform||vu("Platform not set"),cu.platform},cu),hu=new l("@firebase/firestore");function cu(){}function lu(){return hu.logLevel}function fu(t){hu.logLevel=t}function pu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=u.DEBUG){var i=e.map(yu);hu.debug.apply(hu,r(["Firestore ("+Di+"): "+t],i))}}function du(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=u.ERROR){var i=e.map(yu);hu.error.apply(hu,r(["Firestore ("+Di+"): "+t],i))}}function yu(t){if("string"==typeof t)return t;var e=au.Ot();try{return e.wn(t)}catch(e){return t}}function vu(t){var e="FIRESTORE ("+Di+") INTERNAL ASSERTION FAILED: "+t;throw du(e),new Error(e)}function gu(t,e){t||vu(e)}var mu=(wu.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},wu);function wu(){}function bu(t,e){return t<e?-1:e<t?1:0}function Eu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Au(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Iu=(Object.defineProperty(Fu.prototype,"mn",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Fu.prototype.isEqual=function(t){return t instanceof Fu&&t.projectId===this.projectId&&t.database===this.database},Fu.prototype.C=function(t){return bu(this.projectId,t.projectId)||bu(this.database,t.database)},Fu),Nu=(ju.prototype.get=function(t){var e=this.En(t),n=this.Rn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},ju.prototype.has=function(t){return void 0!==this.get(t)},ju.prototype.set=function(t,e){var n=this.En(t),i=this.Rn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.Rn[n]=[[t,e]]},ju.prototype.delete=function(t){var e=this.En(t),n=this.Rn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.Rn[e]:n.splice(i,1),!0;return!1},ju.prototype.forEach=function(u){Er(this.Rn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},ju.prototype.q=function(){return Ar(this.Rn)},ju),Tu=(Gu.prototype.Bt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.Bt(e,s)}}return e},Gu.prototype.qt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.qt(e,e,this.In))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.qt(e,o,this.In))}return e},Gu.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.qt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},Gu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Cs())},Gu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Eu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Eu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Gu),_u=(xu.from=function(t,e,n,i){gu(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var r=Ls(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new xu(t,e,n,i,r)},xu),Su=(qu.prototype.q=function(){return this.gn.q()},qu.prototype.vn=function(t,e){var n=new ku(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},qu.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},qu.prototype.Cn=function(t,e){this.Dn(new ku(t,e))},qu.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Cn(t,e)})},qu.prototype.Nn=function(t){var e=this,n=ur.EMPTY,i=new ku(n,t),r=new ku(n,t+1),o=[];return this.yn.Dt([i,r],function(t){e.Dn(t),o.push(t.key)}),o},qu.prototype.kn=function(){var e=this;this.gn.forEach(function(t){return e.Dn(t)})},qu.prototype.Dn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},qu.prototype.Ln=function(t){var e=ur.EMPTY,n=new ku(e,t),i=new ku(e,t+1),r=Cs();return this.yn.Dt([n,i],function(t){r=r.add(t.key)}),r},qu.prototype.$n=function(t){var e=new ku(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},qu),ku=(Mu.me=function(t,e){return ur.k(t.key,e.key)||bu(t.On,e.On)},Mu.bn=function(t,e){return bu(t.On,e.On)||ur.k(t.key,e.key)},Mu),Ru=(Pu.prototype.catch=function(t){return this.next(void 0,t)},Pu.prototype.next=function(i,r){var o=this;return this.Bn&&vu("Called next() or catch() twice for PersistencePromise"),this.Bn=!0,this.qn?this.error?this.xn(r,this.error):this.Qn(i,this.result):new Pu(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.Un=function(t){o.xn(r,t).next(e,n)}})},Pu.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Pu.prototype.jn=function(t){try{var e=t();return e instanceof Pu?e:Pu.resolve(e)}catch(t){return Pu.reject(t)}},Pu.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Pu.resolve(e)},Pu.prototype.xn=function(t,e){return t?this.jn(function(){return t(e)}):Pu.reject(e)},Pu.resolve=function(n){return new Pu(function(t,e){t(n)})},Pu.reject=function(n){return new Pu(function(t,e){e(n)})},Pu.Gn=function(t){return new Pu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Pu.zn=function(t){for(var n=Pu.resolve(!1),e=function(e){n=n.next(function(t){return t?Pu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Pu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Pu),Ou=(Uu.prototype.Yn=function(e,n){var i=this;return this.Hn.Xn(e,n).next(function(t){return i.Zn(e,n,t)})},Uu.prototype.Zn=function(t,i,r){return this.Kn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].qt(i,t);return t})},Uu.prototype.er=function(t,e,r){var o=Ss();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].qt(t,e);o=o.nt(t,e)}),o},Uu.prototype.sr=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Uu.prototype.ir=function(i,r){var o=this;return this.Hn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=_s();return e.forEach(function(t,e){e=e||new Co(t,Hi.S()),n=n.nt(t,e)}),n})},Uu.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.He()?this.or(t,e,n):this.ar(t,e,n)},Uu.prototype.hr=function(t,e){return this.Yn(t,new ur(e)).next(function(t){var e=Rs();return t instanceof Do&&(e=e.nt(t.key,t)),e})},Uu.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,u=Rs();return this.Jn.ur(n,s).next(function(t){return Ru.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Uu.prototype.ar=function(e,n,t){var c,l,i=this;return this.Kn.rr(e,n,t).next(function(t){return c=t,i.Hn.cr(e,n)}).next(function(t){return l=t,i.lr(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.qt(a,a,i.In);c=h instanceof Do?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Uu.prototype.lr=function(t,e,n){for(var i=Cs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof yo&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Kn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Do&&(h=h.nt(t,e))}),h})},Uu),Lu=(Vu.wr=function(t,e){for(var n=Cs(),i=Cs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Vu(t,e.fromCache,n,i)},Vu),Du=(Cu.prototype.mr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Cu.prototype.next=function(){var t=++this.previousValue;return this.Er&&this.Er(t),t},Cu);function Cu(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.mr(t)},this.Er=function(t){return e.Rr(t)})}function Vu(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Uu(t,e,n){this.Kn=t,this.Hn=e,this.Jn=n}function Pu(t){var e=this;this.Mn=null,this.Un=null,this.result=void 0,this.error=void 0,this.qn=!1,this.Bn=!1,t(function(t){e.qn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.qn=!0,e.error=t,e.Un&&e.Un(t)})}function Mu(t,e){this.key=t,this.On=e}function qu(){this.gn=new vr(ku.me),this.yn=new vr(ku.bn)}function xu(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function Gu(t,e,n,i){this.batchId=t,this.In=e,this.baseMutations=n,this.mutations=i}function ju(t){this.En=t,this.Rn={}}function Fu(t,e){this.projectId=t,this.database=e||"(default)"}Du.Ir=-1;function Bu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Hu=(Xu.yr=function(t,e,n,i,r){var o=new Xu(t,e,Date.now()+n,i,r);return o.start(n),o},Xu.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Xu.prototype.Sr=function(){return this.vr()},Xu.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.gr.reject(new qi(Mi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Xu.prototype.vr=function(){var e=this;this.Ar.Cr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.gr.resolve(t)})):Promise.resolve()})},Xu.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Xu),Yu=(Object.defineProperty(Wu.prototype,"Or",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Wu.prototype.Cr=function(t){this.enqueue(t)},Wu.prototype.Mr=function(t){this.Ur(),this.qr(t)},Wu.prototype.Br=function(t){return this.Ur(),this.qr(t)},Wu.prototype.xr=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ur(),this.Fr?[3,2]:(this.Fr=!0,[4,this.Br(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wu.prototype.enqueue=function(t){return this.Ur(),this.Fr?new Promise(function(t){}):this.qr(t)},Wu.prototype.qr=function(t){var e=this,n=this.Dr.then(function(){return e.Lr=!0,t().catch(function(t){throw e.kr=t,e.Lr=!1,du("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Lr=!1,t})});return this.Dr=n},Wu.prototype.Qr=function(t,e,n){var i=this;this.Ur(),-1<this.$r.indexOf(t)&&(e=0);var r=Hu.yr(this,t,e,n,function(t){return i.Wr(t)});return this.Nr.push(r),r},Wu.prototype.Ur=function(){this.kr&&vu("AsyncQueue is already failed: "+(this.kr.stack||this.kr.message))},Wu.prototype.jr=function(){},Wu.prototype.Gr=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Dr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Dr)return[3,0];t.label=3;case 3:return[2]}})})},Wu.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Wu.prototype.Kr=function(i){var r=this;return this.Gr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Sr(),"all"!==i&&n.Pr===i)break}return r.Gr()})},Wu.prototype.Hr=function(t){this.$r.push(t)},Wu.prototype.Wr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Wu),zu=(Qu.Zr=function(t){return new Qu(t,Qu.th,Qu.eh)},Qu);function Qu(t,e,n){this.Jr=t,this.Yr=e,this.Xr=n}function Wu(){this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.kr=null,this.Lr=!1,this.$r=[]}function Xu(t,e,n,i,r){this.Ar=t,this.Pr=e,this.Vr=n,this.op=i,this.pr=r,this.gr=new Bu,this.then=this.gr.promise.then.bind(this.gr.promise),this.catch=this.gr.promise.catch.bind(this.gr.promise),this.gr.promise.catch(function(t){})}zu.sh=-1,zu.ih=1048576,zu.nh=41943040,zu.th=10,zu.eh=1e3,zu.rh=new zu(zu.nh,zu.th,zu.eh),zu.DISABLED=new zu(zu.sh,0,0);var Ju=(Ku.prototype.start=function(){return this.Ph()},Ku.prototype.Vh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Hn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Hn.ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new Ou(i.wh,e,i.persistence.Ih()),e.ph(v)}).next(function(t){for(var e=[],n=[],i=Cs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{gh:t,yh:e,bh:n}})})})];case 1:return n=t.sent(),[2,(this.Hn=e,this.Rh=m,this.hh.Ah(this.Rh),n)]}})})},Ku.prototype.vh=function(u){var a,h=this,c=Bi.now(),t=u.reduce(function(t,e){return t.add(e.key)},Cs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Rh.sr(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.ee(a.get(r.key));null!=o&&e.push(new yo(r.key,o,o.se(),io.exists(!0)))}return h.Hn.Sh(s,c,e,u)})}).then(function(t){var e=t.Pn(a);return{batchId:t.batchId,Ch:e}})},Ku.prototype.Dh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Hn.Fh(e,t).next(function(t){return t?n.Rh.sr(e,t):Ru.resolve(null)})})},Ku.prototype.Nh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.wh.kh({Lh:!0});return r.Hn.Nh(t,i.batch,i.streamToken).next(function(){return r.$h(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.Hn.Oh(t)}).next(function(){return r.Rh.sr(t,e)})})},Ku.prototype.Mh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Hn.Uh(e,t).next(function(t){return gu(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),i.Hn.qh(e,t)}).next(function(){return i.Hn.Oh(e)}).next(function(){return i.Rh.sr(e,n)})})},Ku.prototype.Bh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Hn.Bh(t)})},Ku.prototype.xh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Hn.xh(t)})},Ku.prototype.Qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Hn.Qh(t,e)})},Ku.prototype.Wh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mh.Wh(t)})},Ku.prototype.jh=function(a){var h=this,c=a.ts,l=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.wh.kh({Lh:!0});l=h.ah;var s=[];a.ws.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.mh.Gh(o,t.ps,e).next(function(){return h.mh.zh(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.Kh);l=l.nt(e,r),Ku.Hh(n,r,t)&&s.push(h.mh.Jh(o,r))}}});var u=_s(),n=Cs();if(a.ms.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.ms.forEach(function(t,e){var n=i.get(t);e instanceof Co&&e.version.isEqual(Hi.MIN)?(r.Yh(t,c),u=u.nt(t,e)):null==n||0<e.version.C(n.version)||0===e.version.C(n.version)&&n.hasPendingWrites?(r.Xh(e,c),u=u.nt(t,e)):pu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Es.has(t)&&s.push(h.persistence.dh.Zh(o,t))})})),!c.isEqual(Hi.MIN)){var t=h.mh.Wh(o).next(function(t){return h.mh.to(o,o.Kh,c)});s.push(t)}return Ru.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Rh.ir(o,u)})}).then(function(t){return h.ah=l,t})},Ku.Hh=function(t,e,n){return gu(0<e.resumeToken.Mt(),"Attempted to persist target data with no resume token"),0===t.resumeToken.Mt()||e.ts.D()-t.ts.D()>=this.eo||0<n.Ps.size+n.Vs.size+n.ps.size},Ku.prototype.so=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.oh.Sn(r._r,o),this.oh.Fn(r.dr,o),!r.fromCache){var s=this.ah.get(o),u=s.ts,a=s.ns(u);this.ah=this.ah.nt(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Ru.forEach(t,function(t){return Ru.forEach(t.dr,function(t){return n.persistence.dh.Cn(e,t)})})})},Ku.prototype.io=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Hn.no(t,e)})},Ku.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.Yn(t,e)})},Ku.prototype.ho=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.mh.oo(e,i).next(function(t){return t?(n=t,Ru.resolve(n)):r.mh.ao(e).next(function(t){return n=new ws(i,t,0,e.Kh),r.mh.uo(e,n).next(function(){return n})})})}).then(function(t){return null===r.ah.get(t.targetId)&&(r.ah=r.ah.nt(t.targetId,t),r.uh.set(i,t.targetId)),t})},Ku.prototype.oo=function(t,e){var n=this.uh.get(e);return void 0!==n?Ru.resolve(this.ah.get(n)):this.mh.oo(t,e)},Ku.prototype.co=function(n,i){var r=this,o=this.ah.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.oh.Nn(n);return i?Ru.resolve():Ru.forEach(t,function(t){return r.persistence.dh.Cn(e,t)}).next(function(){r.persistence.dh.removeTarget(e,o)})}).then(function(){r.ah=r.ah.remove(n),r.uh.delete(o.target)})},Ku.prototype.lo=function(t,n){var i=this,r=Hi.MIN,o=Cs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.oo(e,t.Ue()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.mh._o(e,t.targetId).next(function(t){o=t})}).next(function(){return i.hh.rr(e,t,n?r:Hi.MIN,n?o:Cs())}).next(function(t){return{documents:t,do:o}})})},Ku.prototype.fo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.mh._o(t,e)})},Ku.prototype.wo=function(){return this.persistence.wo()},Ku.prototype.To=function(t){this.Hn.mo(t)},Ku.prototype.Eo=function(t){this.persistence.Eo(t)},Ku.prototype.$h=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=Ru.resolve();return n.forEach(function(i){u=u.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);gu(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.C(n)<0)&&(e=s.Bt(i,e,r))&&o.Xh(e,r.Vn)})}),u.next(function(){return e.Hn.qh(t,s)})},Ku.prototype.Ro=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Io(t,n.ah)})},Ku.prototype.Ao=function(e){var n=this,t=this.ah.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.mh.ui(t,e).next(function(t){return t?t.target:null})})},Ku.prototype.Po=function(){var i=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return i.wh.Po(t,i.lh)}).then(function(t){var e=t.Vo,n=t.readTime;return i.lh=n,e})},Ku.prototype.Ph=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.wh.po(t)})];case 1:return e.lh=t.sent(),[2]}})})},Ku);function Ku(t,e,n){this.persistence=t,this.hh=e,this.oh=new Su,this.ah=new hr(bu),this.uh=new Nu(function(t){return t.canonicalId()}),this.lh=Hi.MIN,this.persistence.dh._h(this.oh),this.Hn=t.fh(n),this.wh=t.Th(),this.mh=t.Eh(),this.Rh=new Ou(this.wh,this.Hn,this.persistence.Ih()),this.hh.Ah(this.Rh)}function Zu(e){return c(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Mi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return pu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function $u(t,e){if(0!==e.length)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+va(e.length,"argument")+".")}function ta(t,e,n){if(e.length!==n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires "+va(n,"argument")+", but was called with "+va(e.length,"argument")+".")}function ea(t,e,n){if(e.length<n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+va(n,"argument")+", but was called with "+va(e.length,"argument")+".")}function na(t,e,n,i){if(e.length<n||e.length>i)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+va(e.length,"argument")+".")}function ia(t,e,n,i){aa(t,e,ya(n)+" argument",i)}function ra(t,e,n,i){void 0!==i&&ia(t,e,n,i)}function oa(t,e,n,i){aa(t,e,n+" option",i)}function sa(t,e,n,i){void 0!==i&&oa(t,e,n,i)}function ua(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(ca(s))}var u=ca(n);throw new qi(Mi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function aa(t,e,n,i){if(!("object"===e?ha(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=ca(i);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function ha(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ca(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":vu("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function la(t,e,n){if(void 0===n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ya(e)+" argument, but it was undefined.")}function fa(n,t,i){Er(t,function(t,e){if(i.indexOf(t)<0)throw new qi(Mi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function pa(t,e,n,i){var r=ca(i);return new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+ya(n)+" argument to be a "+e+", but it was: "+r)}function da(t,e,n){if(n<=0)throw new qi(Mi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+ya(e)+" argument to be a positive number, but it was: "+n+".")}function ya(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function va(t,e){return t+" "+e+(1===t?"":"s")}function ga(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new qi(Mi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function ma(){if("undefined"==typeof Uint8Array)throw new qi(Mi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wa(){if(!au.Ot().yo)throw new qi(Mi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Ju.eo=3e8;var ba=(Na.fromBase64String=function(t){ta("Blob.fromBase64String",arguments,1),ia("Blob.fromBase64String","string",1,t),wa();try{return new Na(Ir.fromBase64String(t))}catch(t){throw new qi(Mi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Na.fromUint8Array=function(t){if(ta("Blob.fromUint8Array",arguments,1),ma(),!(t instanceof Uint8Array))throw pa("Blob.fromUint8Array","Uint8Array",1,t);return new Na(Ir.fromUint8Array(t))},Na.prototype.toBase64=function(){return ta("Blob.toBase64",arguments,0),wa(),this.bo.toBase64()},Na.prototype.toUint8Array=function(){return ta("Blob.toUint8Array",arguments,0),ma(),this.bo.toUint8Array()},Na.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Na.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},Na),Ea=ga(ba,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Aa=(Ia.documentId=function(){return Ia.So},Ia.prototype.isEqual=function(t){if(!(t instanceof Ia))throw pa("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},Ia);function Ia(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new qi(Mi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(ia("FieldPath","string",n,t[n]),0===t[n].length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new or(t)}function Na(t){wa(),this.bo=t}Aa.So=new Aa(or.X().G());var Ta,_a=new RegExp("[~\\*/\\[\\]]"),Sa=(Oa.delete=function(){return $u("FieldValue.delete",arguments),ka.instance},Oa.serverTimestamp=function(){return $u("FieldValue.serverTimestamp",arguments),Da.instance},Oa.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ea("FieldValue.arrayUnion",arguments,1),new Ma(t)},Oa.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ea("FieldValue.arrayRemove",arguments,1),new qa(t)},Oa.increment=function(t){return ia("FieldValue.increment","number",1,t),ta("FieldValue.increment",arguments,1),new xa(t)},Oa.prototype.isEqual=function(t){return this===t},Oa),ka=(n(Ra,Ta=Sa),Ra);function Ra(){return Ta.call(this,"FieldValue.delete")||this}function Oa(t){this.Co=t}ka.instance=new ka;var La,Da=(n(Ca,La=Sa),Ca);function Ca(){return La.call(this,"FieldValue.serverTimestamp")||this}Da.instance=new Da;var Va,Ua,Pa,Ma=(n(Ja,Pa=Sa),Ja),qa=(n(Xa,Ua=Sa),Xa),xa=(n(Wa,Va=Sa),Wa),Ga=ga(Sa,"Use FieldValue.<field>() instead."),ja=(Object.defineProperty(Qa.prototype,"latitude",{get:function(){return this.No},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"longitude",{get:function(){return this.ko},enumerable:!0,configurable:!0}),Qa.prototype.isEqual=function(t){return this.No===t.No&&this.ko===t.ko},Qa.prototype.g=function(t){return bu(this.No,t.No)||bu(this.ko,t.ko)},Qa),Fa=/^__.*__$/,Ba=(za.prototype.Lo=function(t,e){var n=[];return null!==this.se?n.push(new yo(t,this.data,this.se,e)):n.push(new po(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},za),Ha=(Ya.prototype.Lo=function(t,e){var n=[new yo(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},Ya);function Ya(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function za(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Qa(t,e){if(ta("GeoPoint",arguments,2),ia("GeoPoint","number",1,t),ia("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new qi(Mi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qi(Mi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.No=t,this.ko=e}function Wa(t){var e=this;return(e=Va.call(this,"FieldValue.increment")||this).Fo=t,e}function Xa(t){var e=this;return(e=Ua.call(this,"FieldValue.arrayRemove")||this).Do=t,e}function Ja(t){var e=this;return(e=Pa.call(this,"FieldValue.arrayUnion")||this).Do=t,e}function Ka(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw vu("Unexpected case for UserDataSource: "+t)}}var Za=(nh.prototype.Uo=function(t){var e=null==this.path?null:this.path.child(t),n=new nh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.qo(t),n},nh.prototype.Bo=function(t){var e=null==this.path?null:this.path.child(t),n=new nh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Mo(),n},nh.prototype.xo=function(t){return new nh(this.$o,this.methodName,null,!0,this.fieldTransforms,this.se)},nh.prototype.Qo=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new qi(Mi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},nh.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},nh.prototype.Mo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.qo(this.path.get(t))},nh.prototype.qo=function(t){if(0===t.length)throw this.Qo("Document fields must not be empty");if(Ka(this.$o)&&Fa.test(t))throw this.Qo('Document fields cannot begin and end with "__"')},nh),$a=function(t,e){this.ci=t,this.key=e},th=(eh.prototype.jo=function(t,e){var n=new Za(0,t,or.H);rh("Data must be an object, but it was:",n,e);var i=this.Go(e,n);return new Ba(new wo(i),null,n.fieldTransforms)},eh.prototype.zo=function(t,e,n){var i=new Za(2,t,or.H);rh("Data must be an object, but it was:",i,e);var r,o,s=this.Go(e,i);if(n){for(var u=new vr(or.k),a=0,h=n;a<h.length;a++){var c=h[a],l=void 0;if(c instanceof Aa)l=c.vo;else{if("string"!=typeof c)throw vu("Expected stringOrFieldPath to be a string or a FieldPath");l=sh(t,c)}if(!i.contains(l))throw new qi(Mi.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");u=u.add(l)}r=eo.Gt(u),o=i.fieldTransforms.filter(function(t){return r.Kt(t.field)})}else r=eo.zt(i.se),o=i.fieldTransforms;return new Ba(new wo(s),r,o)},eh.prototype.Ko=function(o,t){var s=this,u=new Za(1,o,or.H);rh("Data must be an object, but it was:",u,t);var a=new vr(or.k),h=wo.le();Er(t,function(t,e){var n=sh(o,t),i=u.Bo(n);if((e=s.Ho(e,i))instanceof ka)a=a.add(n);else{var r=s.Jo(e,i);null!=r&&(a=a.add(n),h.set(n,r))}});var e=eo.Gt(a);return new Ha(h.he(),e,u.fieldTransforms)},eh.prototype.Yo=function(t,e,n,i){var r=new Za(1,t,or.H),o=[oh(t,e)],s=[n];if(i.length%2!=0)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(oh(t,i[u])),s.push(i[u+1]);for(var a=new vr(or.k),h=wo.le(),c=0;c<o.length;++c){var l=o[c],f=r.Bo(l),p=this.Ho(s[c],f);if(p instanceof ka)a=a.add(l);else{var d=this.Jo(p,f);null!=d&&(a=a.add(l),h.set(l,d))}}var y=eo.Gt(a);return new Ha(h.he(),y,r.fieldTransforms)},eh.prototype.Xo=function(t,e,n){void 0===n&&(n=!1);var i=new Za(n?4:3,t,or.H);return this.Jo(e,i)},eh.prototype.Ho=function(t,e){try{return this.Wo(t)}catch(t){var n=uh(t);throw e.Qo(n)}},eh.prototype.Jo=function(t,e){if(ih(t=this.Ho(t,e)))return rh("Unsupported field value:",e,t),this.Go(t,e);if(t instanceof Sa)return this.Zo(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Oo&&4!==e.$o)throw e.Qo("Nested arrays are not supported");return this.ta(t,e)}return this.ea(t,e)},eh.prototype.Go=function(t,i){var r=this,o={};return Ar(t)?i.path&&0<i.path.length&&i.se.push(i.path):Er(t,function(t,e){var n=r.Jo(e,i.Uo(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},eh.prototype.ta=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],u=this.Jo(s,e.xo(i));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),i++}return{arrayValue:{values:n}}},eh.prototype.Zo=function(t,e){if(!Ka(e.$o))throw e.Qo(t.Co+"() can only be used with update() and set()");if(null===e.path)throw e.Qo(t.Co+"() is not currently supported inside arrays");if(t instanceof ka){if(2!==e.$o)throw 1===e.$o?e.Qo("FieldValue.delete() can only appear at the top level of your update data"):e.Qo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof Da)e.fieldTransforms.push(new no(e.path,Yr.instance));else if(t instanceof Ma){var n=this.sa(t.Co,t.Do),i=new Qr(n);e.fieldTransforms.push(new no(e.path,i))}else if(t instanceof qa){var r=this.sa(t.Co,t.Do),o=new Wr(r);e.fieldTransforms.push(new no(e.path,o))}else if(t instanceof xa){var s=this.Xo("FieldValue.increment",t.Fo),u=new Xr(this.serializer,s);e.fieldTransforms.push(new no(e.path,u))}else vu("Unknown FieldValue type: "+t)},eh.prototype.ea=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Bi.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof Bi){var i=new Bi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof ja)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ba)return{bytesValue:this.serializer.Ti(t)};if(t instanceof $a)return{referenceValue:this.serializer.Ei(t.key.path,t.ci)};throw e.Qo("Unsupported field value: "+ca(t))},eh.prototype.sa=function(i,t){var r=this;return t.map(function(t,e){var n=new Za(3,i,or.H);return r.Jo(t,n.xo(e))})},eh);function eh(t,e){this.serializer=t,this.Wo=e}function nh(t,e,n,i,r,o){this.$o=t,this.methodName=e,this.path=n,this.Oo=i,void 0===r&&this.Mo(),this.Oo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function ih(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Bi||t instanceof ja||t instanceof ba||t instanceof $a||t instanceof Sa)}function rh(t,e,n){if(!ih(n)||!ha(n)){var i=ca(n);throw"an object"===i?e.Qo(t+" a custom object"):e.Qo(t+" "+i)}}function oh(t,e){if(e instanceof Aa)return e.vo;if("string"==typeof e)return sh(t,e);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function sh(t,e){try{return function(e){if(0<=e.search(_a))throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Aa.bind.apply(Aa,r([void 0],e.split("."))))}catch(t){throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=uh(e);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function uh(t){return t instanceof Error?t.message:t.toString()}function ah(t){this.key=t}function hh(t){this.key=t}function ch(t,e,n){this.query=t,this.targetId=e,this.view=n}function lh(t){this.key=t,this.xc=!1}function fh(){this.yl=null,this.targetId=0,this.bl=[]}var ph,dh,yh,vh=(ic.prototype.reset=function(){this.oa=0},ic.prototype.ca=function(){this.oa=this.ha},ic.prototype.la=function(t){var e=this;this.cancel();var n=Math.floor(this.oa+this._a()),i=Math.max(0,Date.now()-this.ua),r=Math.max(0,n-i);0<this.oa&&pu("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.oa+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.aa=this.ia.Qr(this.Pr,r,function(){return e.ua=Date.now(),t()}),this.oa*=this.ra,this.oa<this.na&&(this.oa=this.na),this.oa>this.ha&&(this.oa=this.ha)},ic.prototype.cancel=function(){null!==this.aa&&(this.aa.cancel(),this.aa=null)},ic.prototype._a=function(){return(Math.random()-.5)*this.oa},ic),gh=(nc.prototype.Ra=function(){return 1===this.state||2===this.state||4===this.state},nc.prototype.Ia=function(){return 2===this.state},nc.prototype.start=function(){3!==this.state?this.auth():this.Aa()},nc.prototype.stop=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ra()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},nc.prototype.Pa=function(){this.state=0,this.Ea.reset()},nc.prototype.Va=function(){var t=this;this.Ia()&&null===this.ma&&(this.ma=this.ia.Qr(this.da,6e4,function(){return t.pa()}))},nc.prototype.ga=function(t){this.ya(),this.stream.send(t)},nc.prototype.pa=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Ia()?[2,this.close(0)]:[2]})})},nc.prototype.ya=function(){this.ma&&(this.ma.cancel(),this.ma=null)},nc.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ya(),this.Ea.cancel(),this.Ta++,3!==e?this.Ea.reset():n&&n.code===Mi.RESOURCE_EXHAUSTED?(du(n.toString()),du("Using maximum backoff delay to prevent overloading the backend."),this.Ea.ca()):n&&n.code===Mi.UNAUTHENTICATED&&this.wa.l(),null!==this.stream&&(this.ba(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.va(n)];case 1:return t.sent(),[2]}})})},nc.prototype.ba=function(){},nc.prototype.auth=function(){var n=this;this.state=1;var t=this.Sa(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Ca(t)},function(e){t(function(){var t=new qi(Mi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},nc.prototype.Ca=function(t){var e=this,n=this.Sa(this.Ta);this.stream=this.Fa(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.va(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},nc.prototype.Aa=function(){var t=this;this.state=4,this.Ea.la(function(){return c(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},nc.prototype.Da=function(t){return pu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},nc.prototype.Sa=function(e){var n=this;return function(t){n.ia.Cr(function(){return n.Ta===e?t():(pu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},nc),mh=(n(ec,dh=gh),ec.prototype.Fa=function(t){return this.fa.ka("Listen",t)},ec.prototype.onMessage=function(t){this.Ea.reset();var e=this.serializer.Fi(t),n=this.serializer.ki(t);return this.listener.La(e,n)},ec.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.Ue(t);var n=this.serializer.en(t);n&&(e.labels=n),this.ga(e)},ec.prototype.Oa=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.ga(e)},ec),wh=(n(tc,ph=gh),Object.defineProperty(tc.prototype,"Ua",{get:function(){return this.Ma},enumerable:!0,configurable:!0}),tc.prototype.start=function(){this.Ma=!1,ph.prototype.start.call(this)},tc.prototype.ba=function(){this.Ma&&this.qa([])},tc.prototype.Fa=function(t){return this.fa.ka("Write",t)},tc.prototype.onMessage=function(t){if(gu(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.mi(t.streamToken),this.Ma){this.Ea.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ba(n,e)}return gu(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Ma=!0,this.listener.xa()},tc.prototype.Qa=function(){var t={};t.database=this.serializer.gi,this.ga(t)},tc.prototype.qa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.Li(t)})};this.ga(n)},tc),bh=($h.prototype.Wa=function(t){return new wh(this.ia,this.fa,this.credentials,this.serializer,t)},$h.prototype.ja=function(t){return new mh(this.ia,this.fa,this.credentials,this.serializer,t)},$h.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.Li(t)})};return this.Ga("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},$h.prototype.za=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.Ka("BatchGetDocuments",t).then(function(t){var n=_s();t.forEach(function(t){var e=r.serializer.Di(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);gu(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},$h.prototype.Ga=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ga(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},$h.prototype.Ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},$h),Eh=(Zh.prototype.za=function(i){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),0<this.mutations.length)throw new qi(Mi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ha.za(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Co||t instanceof Do?n.eu(t):vu("Document in a transaction was a "+t.constructor.name)}),e)]}})})},Zh.prototype.set=function(t,e){this.write(e.Lo(t,this.Zt(t))),this.Za.add(t)},Zh.prototype.update=function(t,e){try{this.write(e.Lo(t,this.su(t)))}catch(t){this.Xa=t}this.Za.add(t)},Zh.prototype.delete=function(t){this.write([new go(t,this.Zt(t))]),this.Za.add(t)},Zh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),this.Xa)throw this.Xa;return e=this.Ja,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new mo(t,n.Zt(t)))}),[4,this.Ha.commit(this.mutations)];case 1:return t.sent(),this.Ya=!0,[2]}})})},Zh.prototype.eu=function(t){var e;if(t instanceof Do)e=t.version;else{if(!(t instanceof Co))throw vu("Document in a transaction was a "+t.constructor.name);e=Hi.S()}var n=this.Ja.get(t.key);if(null!==n){if(!e.isEqual(n))throw new qi(Mi.ABORTED,"Document version changed between two reads.")}else this.Ja=this.Ja.nt(t.key,e)},Zh.prototype.Zt=function(t){var e=this.Ja.get(t);return!this.Za.has(t)&&e?io.updateTime(e):io.NONE},Zh.prototype.su=function(t){var e=this.Ja.get(t);if(this.Za.has(t)||!e)return io.exists(!0);if(e.isEqual(Hi.S()))throw new qi(Mi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return io.updateTime(e)},Zh.prototype.write=function(t){this.tu(),this.mutations=this.mutations.concat(t)},Zh.prototype.tu=function(){},Zh),Ah=(Kh.prototype.ou=function(){var t=this;0===this.nu&&(this.au("Unknown"),this.ru=this.Ar.Qr("online_state_timeout",1e4,function(){return t.ru=null,t.uu("Backend didn't respond within 10 seconds."),t.au("Offline"),Promise.resolve()}))},Kh.prototype.cu=function(t){"Online"===this.state?this.au("Unknown"):(this.nu++,1<=this.nu&&(this.lu(),this.uu("Connection failed 1 times. Most recent error: "+t.toString()),this.au("Offline")))},Kh.prototype.set=function(t){this.lu(),this.nu=0,"Online"===t&&(this.hu=!1),this.au(t)},Kh.prototype.au=function(t){t!==this.state&&(this.state=t,this.iu(t))},Kh.prototype.uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.hu?(du(e),this.hu=!1):pu("OnlineStateTracker",e)},Kh.prototype.lu=function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)},Kh),Ih=(Jh.prototype.start=function(){return this.enableNetwork()},Jh.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.Eu()?(e=this.gu,[4,this._u.xh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Su()?this.Cu():this.Iu.set("Unknown"),[4,this.Du()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Jh.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Offline"),[2]}})})},Jh.prototype.Fu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.gu.stop()];case 1:return t.sent(),[4,this.Au.stop()];case 2:return t.sent(),0<this.du.length&&(pu("RemoteStore","Stopping write stream with "+this.du.length+" pending writes"),this.du=[]),this.Nu(),[2]}})})},Jh.prototype.ku=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return pu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Tu.ku(),this.Iu.set("Unknown"),[2]}})})},Jh.prototype.listen=function(t){this.fu.has(t.targetId)||(this.fu.set(t.targetId,t),this.Su()?this.Cu():this.Au.Ia()&&this.Lu(t))},Jh.prototype.$u=function(t){this.fu.delete(t),this.Au.Ia()&&this.Ou(t),0===this.fu.size&&(this.Au.Ia()?this.Au.Va():this.Eu()&&this.Iu.set("Unknown"))},Jh.prototype.ui=function(t){return this.fu.get(t)||null},Jh.prototype.ai=function(t){return this.Mu.ai(t)},Jh.prototype.Lu=function(t){this.wu.qs(t.targetId),this.Au.$a(t)},Jh.prototype.Ou=function(t){this.wu.qs(t),this.Au.Oa(t)},Jh.prototype.Cu=function(){this.wu=new Ys(this),this.Au.start(),this.Iu.ou()},Jh.prototype.Su=function(){return this.Eu()&&!this.Au.Ra()&&0<this.fu.size},Jh.prototype.Eu=function(){return this.isPrimary&&this.networkEnabled},Jh.prototype.Nu=function(){this.wu=null},Jh.prototype.Pu=function(){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fu.forEach(function(t,e){n.Lu(t)}),[2]})})},Jh.prototype.Vu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Nu(),this.Su()?(this.Iu.cu(e),this.Cu()):this.Iu.set("Unknown"),[2]})})},Jh.prototype.pu=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Iu.set("Online"),n instanceof qs&&2===n.state&&n.cause?[2,this.Uu(n)]:(n instanceof Ps?this.wu.Ks(n):n instanceof Ms?this.wu.si(n):this.wu.Ys(n),i.isEqual(Hi.MIN)?[3,4]:[4,this._u.Wh()]);case 1:return e=t.sent(),0<=i.C(e)?[4,this.qu(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},Jh.prototype.qu=function(i){var r=this,t=this.wu.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.fu.get(e);n&&r.fu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.fu.get(t);if(e){r.fu.set(t,e.ss(Ir.Ut,e.ts)),r.Ou(t);var n=new ws(e.target,t,1,e.sequenceNumber);r.Lu(n)}}),this.Mu.jh(t)},Jh.prototype.Uu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return y(this,function(t){return this.fu.has(e)?[2,(this.fu.delete(e),this.wu.removeTarget(e),this.Mu.Bu(e,i))]:[2]})})})}),r},Jh.prototype.Du=function(){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.xu()?(e=0<this.du.length?this.du[this.du.length-1].batchId:-1,[4,this._u.io(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.du.length&&this.gu.Va(),[3,4]);case 2:return this.Qu(n),[4,this.Du()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Wu()&&this.ju(),[2]}})})},Jh.prototype.xu=function(){return this.Eu()&&this.du.length<10},Jh.prototype.Gu=function(){return this.du.length},Jh.prototype.Qu=function(t){this.du.push(t),this.gu.Ia()&&this.gu.Ua&&this.gu.qa(t.mutations)},Jh.prototype.Wu=function(){return this.Eu()&&!this.gu.Ra()&&0<this.du.length},Jh.prototype.ju=function(){this.gu.start()},Jh.prototype.yu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.gu.Qa(),[2]})})},Jh.prototype.vu=function(){var i=this;return this._u.Qh(this.gu.lastStreamToken).then(function(){for(var t=0,e=i.du;t<e.length;t++){var n=e[t];i.gu.qa(n.mutations)}}).catch(Zu)},Jh.prototype.Ba=function(t,e){var n=this,i=this.du.shift(),r=_u.from(i,t,e,this.gu.lastStreamToken);return this.Mu.zu(r).then(function(){return n.Du()})},Jh.prototype.bu=function(n){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){return n&&0<this.du.length?[2,(this.gu.Ua?this.Ku(n):this.Hu(n)).then(function(){e.Wu()&&e.ju()})]:[2]})})},Jh.prototype.Hu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return Is(e.code)?[2,(pu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.gu.lastStreamToken),this.gu.lastStreamToken=Ir.Ut,this._u.Qh(Ir.Ut).catch(Zu))]:[2]})})},Jh.prototype.Ku=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return Is(n=r.code)&&n!==Mi.ABORTED?(e=this.du.shift(),[2,(this.gu.Pa(),this.Mu.Ju(e.batchId,r).then(function(){return i.Du()}))]):[2]})})},Jh.prototype.Yu=function(){return new Eh(this.Ha)},Jh.prototype.Ru=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Jh.prototype.Xu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(pu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jh.prototype.Zu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Fu()];case 3:t.sent(),this.Iu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Jh),Nh=(Xh.prototype.tc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Xh.prototype.ec=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Xh.prototype.sc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Xh),Th=(Wh.prototype.rc=function(t){},Wh.prototype.hc=function(t,e,n){},Wh.prototype.oc=function(t){return this.ic.tc(t),this.nc[t]||"not-current"},Wh.prototype.ac=function(t,e,n){this.nc[t]=e},Wh.prototype.uc=function(t){this.ic.ec(t)},Wh.prototype.cc=function(t){return this.ic.activeTargetIds.has(t)},Wh.prototype.lc=function(t){delete this.nc[t]},Wh.prototype._c=function(){return this.ic.activeTargetIds},Wh.prototype.dc=function(t){return this.ic.activeTargetIds.has(t)},Wh.prototype.start=function(){return this.ic=new Nh,Promise.resolve()},Wh.prototype.Vh=function(t,e,n){},Wh.prototype.fc=function(t){},Wh.prototype.ku=function(){},Wh.prototype.Rr=function(t){},Wh),_h=(Qh.prototype.next=function(){return this.wc+=2,this.wc},Qh.Tc=function(){return new Qh(0)},Qh.mc=function(){return new Qh(-1)},Qh),Sh=(Object.defineProperty(zh.prototype,"Pc",{get:function(){return this.Ec},enumerable:!0,configurable:!0}),zh.prototype.Vc=function(t,e){var u=this,a=e?e.pc:new Gs,h=e?e.Ac:this.Ac,c=e?e.ls:this.ls,l=h,f=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Do?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ls.has(n.key),o=!!i&&(i.te||u.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.gc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.qe(i,p)||d&&u.query.qe(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;l.size>this.query.limit;){var n=this.query.je()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{Ac:l,pc:a,yc:f,ls:c}},zh.prototype.gc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},zh.prototype.bc=function(t,e,n){var o=this,i=this.Ac;this.Ac=t.Ac,this.ls=t.ls;var r=t.pc.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.qe(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vu("Unknown ChangeType: "+t)}}var i,r}),this.vc(n);var s=e?this.Sc():[],u=0===this.Ic.size&&this.As?1:0,a=u!==this.Rc;return this.Rc=u,0!==r.length||a?{snapshot:new js(this.query,t.Ac,i,r,t.ls,0==u,a,!1),Cc:s}:{Cc:s}},zh.prototype.Dc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.bc({Ac:this.Ac,pc:new Gs,ls:this.ls,yc:!1},!1)):{Cc:[]}},zh.prototype.Fc=function(t){return!this.Ec.has(t)&&!!this.Ac.has(t)&&!this.Ac.get(t).te},zh.prototype.vc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.Ec=e.Ec.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e.Ec=e.Ec.delete(t)}),this.As=t.As)},zh.prototype.Sc=function(){var e=this;if(!this.As)return[];var n=this.Ic;this.Ic=Cs(),this.Ac.forEach(function(t){e.Fc(t.key)&&(e.Ic=e.Ic.add(t.key))});var i=[];return n.forEach(function(t){e.Ic.has(t)||i.push(new hh(t))}),this.Ic.forEach(function(t){n.has(t)||i.push(new ah(t))}),i},zh.prototype.Nc=function(t){this.Ec=t.do,this.Ic=Cs();var e=this.Vc(t.documents);return this.bc(e,!0)},zh.prototype.kc=function(){return js.fs(this.query,this.Ac,this.ls,0===this.Rc)},zh),kh=(Yh.prototype.Oc=function(){this.Mc()},Yh.prototype.Mc=function(){var t=this;this.Ea.la(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=this.Lc.Yu(),(n=this.Uc(e))&&n.then(function(t){i.Ar.Cr(function(){return e.commit().then(function(){i.gr.resolve(t)}).catch(function(t){i.qc(t)})})}).catch(function(t){i.qc(t)}),[2]})})})},Yh.prototype.Uc=function(t){try{var e=this.updateFunction(t);return!Tr(e)&&e.catch&&e.then?e:(this.gr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gr.reject(t),null}},Yh.prototype.qc=function(t){var e=this;0<this.$c&&this.Bc(t)?(--this.$c,this.Ar.Cr(function(){return e.Mc(),Promise.resolve()})):this.gr.reject(t)},Yh.prototype.Bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Is(e)},Yh),Rh=(Object.defineProperty(Hh.prototype,"el",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Hh.prototype.subscribe=function(t){this.jc=t},Hh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.sl("listen()"),(i=this.Gc.get(s))?(e=i.targetId,this.Qc.oc(e),n=i.view.kc(),[3,4]):[3,1];case 1:return[4,this._u.ho(s.Ue())];case 2:return r=t.sent(),o=this.Qc.oc(r.targetId),e=r.targetId,[4,this.il(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Lc.listen(r),t.label=4;case 4:return[2,(this.jc.La([n]),e)]}})})},Hh.prototype.il=function(u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(u,!0)];case 1:return e=t.sent(),n=new Sh(u,e.do),i=n.Vc(e.documents),r=Bs.Is(a,h&&"Offline"!==this.onlineState),o=n.bc(i,!0===this.isPrimary,r),s=new ch(u,a,n),[2,(this.Gc.set(u,s),this.zc.has(a)?this.zc.get(a).push(u):this.zc.set(a,[u]),o.snapshot)]}})})},Hh.prototype.nl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(i.query,!0)];case 1:return e=t.sent(),n=i.view.Nc(e),[2,(this.isPrimary&&this.rl(i.targetId,n.Cc),n)]}})})},Hh.prototype.$u=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.sl("unlisten()"),e=this.Gc.get(r),1<(n=this.zc.get(e.targetId)).length?[2,(this.zc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Gc.delete(r))]:this.isPrimary?(this.Qc.uc(e.targetId),this.Qc.dc(e.targetId)?[3,2]:[4,this._u.co(e.targetId,!1).then(function(){i.Qc.lc(e.targetId),i.Lc.$u(e.targetId),i.hl(e.targetId)}).catch(Zu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.hl(e.targetId),[4,this._u.co(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Hh.prototype.write=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("write()"),[4,this._u.vh(n)];case 1:return e=t.sent(),this.Qc.rc(e.batchId),this.ol(e.batchId,i),[4,this.al(e.Ch)];case 2:return t.sent(),[4,this.Lc.Du()];case 3:return t.sent(),[2]}})})},Hh.prototype.runTransaction=function(t,e,n){new kh(t,this.Lc,e,n).Oc()},Hh.prototype.jh=function(n){return c(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.sl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.jh(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Jc.get(e);n&&(gu(t.Ps.size+t.Vs.size+t.ps.size<=1,"Limbo resolution for single document contains multiple changes."),0<t.Ps.size?n.xc=!0:0<t.Vs.size?gu(n.xc,"Received change for limbo target document without add."):0<t.ps.size&&(gu(n.xc,"Received remove for limbo target document without add."),n.xc=!1))}),[4,this.al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Zu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.Dc=function(i,t){if(this.isPrimary&&0===t||!this.isPrimary&&1===t){this.sl("applyOnlineStateChange()");var r=[];this.Gc.forEach(function(t,e){var n=e.view.Dc(i);n.snapshot&&r.push(n.snapshot)}),this.jc.ul(i),this.jc.La(r),this.onlineState=i,this.isPrimary&&this.Qc.fc(i)}},Hh.prototype.Bu=function(u,a){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.sl("rejectListens()"),this.Qc.ac(u,"rejected",a),e=this.Jc.get(u),(n=e&&e.key)?(this.Hc=this.Hc.remove(n),this.Jc.delete(u),this.cl(),i=(i=new hr(ur.k)).nt(n,new Co(n,Hi.S())),r=Cs().add(n),o=new Fs(Hi.MIN,new Map,new vr(bu),i,r),[2,this.jh(o)]):[4,this._u.co(u,!1).then(function(){return s.hl(u,a)}).catch(Zu)];case 1:return t.sent(),[2]}})})},Hh.prototype.ll=function(n,i,r){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("applyBatchState()"),[4,this._u.Dh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==i?[3,3]:[4,this.Lc.Du()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(this._l(n,r||null),this._u.To(n)):vu("Unknown batchState: "+i),t.label=4;case 4:return[4,this.al(e)];case 5:return t.sent(),[3,7];case 6:pu("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Hh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.sl("applySuccessfulWrite()"),e=i.batch.batchId,this._l(e,null),this.dl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Nh(i)];case 2:return n=t.sent(),this.Qc.hc(e,"acknowledged"),[4,this.al(n)];case 3:return t.sent(),[3,6];case 4:return[4,Zu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.Ju=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.sl("rejectFailedWrite()"),this._l(n,i),this.dl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Mh(n)];case 2:return e=t.sent(),this.Qc.hc(n,"rejected",i),[4,this.al(e)];case 3:return t.sent(),[3,6];case 4:return[4,Zu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.fl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Lc.Eu()||pu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this._u.Bh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Zc.get(e)||[]).push(i),this.Zc.set(e,n),[2])}})})},Hh.prototype.dl=function(t){(this.Zc.get(t)||[]).forEach(function(t){t.resolve()}),this.Zc.delete(t)},Hh.prototype.wl=function(e){this.Zc.forEach(function(t){t.forEach(function(t){t.reject(new qi(Mi.CANCELLED,e))})}),this.Zc.clear()},Hh.prototype.ol=function(t,e){var n=this.Xc[this.currentUser.s()];n=(n=n||new hr(bu)).nt(t,e),this.Xc[this.currentUser.s()]=n},Hh.prototype._l=function(t,e){var n=this.Xc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Xc[this.currentUser.s()]=n}},Hh.prototype.hl=function(t,e){var n=this;void 0===e&&(e=null),this.Qc.uc(t);for(var i=0,r=this.zc.get(t);i<r.length;i++){var o=r[i];this.Gc.delete(o),e&&this.jc.Tl(o,e)}if(this.zc.delete(t),this.isPrimary){var s=this.Yc.Ln(t);this.Yc.Nn(t),s.forEach(function(t){n.Yc.$n(t)||n.ml(t)})}},Hh.prototype.ml=function(t){var e=this.Hc.get(t);null!==e&&(this.Lc.$u(e),this.Hc=this.Hc.remove(t),this.Jc.delete(e),this.cl())},Hh.prototype.rl=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof ah?(this.Yc.vn(r.key,t),this.El(r)):r instanceof hh?(pu("SyncEngine","Document no longer in limbo: "+r.key),this.Yc.Cn(r.key,t),this.Yc.$n(r.key)||this.ml(r.key)):vu("Unknown limbo change: "+JSON.stringify(r))}},Hh.prototype.El=function(t){var e=t.key;this.Hc.get(e)||(pu("SyncEngine","New document in limbo: "+e),this.Kc.push(e),this.cl())},Hh.prototype.cl=function(){for(;0<this.Kc.length&&this.Hc.size<this.Wc;){var t=this.Kc.shift(),e=this.tl.next();this.Jc.set(e,new lh(t)),this.Hc=this.Hc.nt(t,e),this.Lc.listen(new ws(Po.ve(t.path).Ue(),e,2,Du.Ir))}},Hh.prototype.Rl=function(){return this.Hc},Hh.prototype.Il=function(){return this.Kc},Hh.prototype.al=function(i,a){return c(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Gc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Vc(i);return n.yc?u._u.lo(r.query,!1).then(function(t){var e=t.documents;return r.view.Vc(e,n)}):n}).then(function(t){var e=a&&a.ws.get(r.targetId),n=r.view.bc(t,!0===u.isPrimary,e);if(u.rl(r.targetId,n.Cc),n.snapshot){u.isPrimary&&u.Qc.ac(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Lu.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.jc.La(o),[4,this._u.so(s)];case 2:return t.sent(),[2]}})})},Hh.prototype.sl=function(t){},Hh.prototype.Xu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.wl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this._u.Vh(i)]):[3,3];case 1:return n=t.sent(),this.Qc.Vh(i,n.yh,n.bh),[4,this.al(n.gh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Lc.Xu()];case 4:return t.sent(),[2]}})})},Hh.prototype.Zu=function(h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a=this;return y(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Lc.Zu(!0)]);case 1:return t.sent(),e=this.Qc._c(),[4,this.Al(e.j())];case 2:for(n=t.sent(),i=0,r=n;i<r.length;i++)o=r[i],this.Lc.listen(o);return[3,7];case 3:return!1!==h||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),this.zc.forEach(function(t,e){a.Qc.cc(e)?s.push(e):u=u.then(function(){return a.hl(e),a._u.co(e,!0)}),a.Lc.$u(e)}),[4,u]);case 4:return t.sent(),[4,this.Al(s)];case 5:return t.sent(),this.Pl(),[4,this.Lc.Zu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Hh.prototype.Pl=function(){var n=this;this.Jc.forEach(function(t,e){n.Lc.$u(e)}),this.Yc.kn(),this.Jc=new Map,this.Hc=new hr(ur.k)},Hh.prototype.Al=function(d){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h,c,l,f,p;return y(this,function(t){switch(t.label){case 0:e=[],n=[],i=0,r=d,t.label=1;case 1:return i<r.length?(o=r[i],s=void 0,(u=this.zc.get(o))&&0!==u.length?[4,this._u.co(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this._u.ho(u[0].Ue())];case 3:s=t.sent(),a=0,h=u,t.label=4;case 4:return a<h.length?(c=h[a],l=this.Gc.get(c),[4,this.nl(l)]):[3,7];case 5:(f=t.sent()).snapshot&&n.push(f.snapshot),t.label=6;case 6:return a++,[3,4];case 7:return[3,12];case 8:return[4,this._u.Ao(o)];case 9:return p=t.sent(),[4,this._u.ho(p)];case 10:return s=t.sent(),[4,this.il(this.Vl(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return i++,[3,1];case 14:return[2,(this.jc.La(n),e)]}})})},Hh.prototype.Vl=function(t){return new Po(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Hh.prototype.wo=function(){return this._u.wo()},Hh.prototype.pl=function(i,r,o){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.isPrimary?(pu("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.zc.has(i))return[3,8];switch(r){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this._u.Po()];case 3:return e=t.sent(),n=Fs.Rs(i,"current"===r),[4,this.al(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this._u.co(i,!0)];case 6:return t.sent(),this.hl(i,o),[3,8];case 7:vu("Unexpected target state: "+r),t.label=8;case 8:return[2]}})})},Hh.prototype.gl=function(f,p){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h,c,l=this;return y(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[3,10];e=0,n=f,t.label=1;case 1:return e<n.length?(i=n[e],[4,this._u.Ao(i)]):[3,6];case 2:return r=t.sent(),[4,this._u.ho(r)];case 3:return o=t.sent(),[4,this.il(this.Vl(r),o.targetId,!1)];case 4:t.sent(),this.Lc.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return y(this,function(t){switch(t.label){case 0:return u.zc.has(e)?[4,u._u.co(e,!1).then(function(){l.Lc.$u(e),l.hl(e)}).catch(Zu)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Hh.prototype.enableNetwork=function(){return this._u.Eo(!0),this.Lc.enableNetwork()},Hh.prototype.disableNetwork=function(){return this._u.Eo(!1),this.Lc.disableNetwork()},Hh.prototype.ai=function(t){var e=this.Jc.get(t);if(e&&e.xc)return Cs().add(e.key);var n=Cs(),i=this.zc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Gc.get(s);n=n.kt(u.view.Pc)}return n},Hh),Oh=(Bh.prototype.listen=function(t){var e=t.query,n=!1,i=this.vl.get(e);return i||(n=!0,i=new fh,this.vl.set(e,i)),i.bl.push(t),t.Dc(this.onlineState),i.yl&&t.Cl(i.yl)&&this.Dl(),n?this.Mu.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},Bh.prototype.$u=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.vl.get(e))&&0<=(r=i.bl.indexOf(o))&&(i.bl.splice(r,1),n=0===i.bl.length),n?[2,(this.vl.delete(e),this.Mu.$u(e))]:[2]})})},Bh.prototype.La=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.vl.get(o);if(s){for(var u=0,a=s.bl;u<a.length;u++)a[u].Cl(r)&&(e=!0);s.yl=r}}e&&this.Dl()},Bh.prototype.Tl=function(t,e){var n=this.vl.get(t);if(n)for(var i=0,r=n.bl;i<r.length;i++)r[i].onError(e);this.vl.delete(t)},Bh.prototype.ul=function(r){this.onlineState=r;var o=!1;this.vl.forEach(function(t,e){for(var n=0,i=e.bl;n<i.length;n++)i[n].Dc(r)&&(o=!0)}),o&&this.Dl()},Bh.prototype.Fl=function(t){this.Sl.add(t),t.next()},Bh.prototype.Nl=function(t){this.Sl.delete(t)},Bh.prototype.Dl=function(){this.Sl.forEach(function(t){t.next()})},Bh),Lh=(Fh.prototype.Cl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new js(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Ll?this.Ol(t)&&(this.kl.next(t),o=!0):this.Ml(t,this.onlineState)&&(this.Ul(t),o=!0),this.$l=t,o},Fh.prototype.onError=function(t){this.kl.error(t)},Fh.prototype.Dc=function(t){this.onlineState=t;var e=!1;return this.$l&&!this.Ll&&this.Ml(this.$l,t)&&(this.Ul(this.$l),e=!0),e},Fh.prototype.Ml=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ql&&n||t.docs.q()&&"Offline"!==e)},Fh.prototype.Ol=function(t){if(0<t.docChanges.length)return!0;var e=this.$l&&this.$l.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},Fh.prototype.Ul=function(t){t=js.fs(t.query,t.docs,t.ls,t.fromCache),this.Ll=!0,this.kl.next(t)},Fh),Dh=(jh.prototype.Ah=function(t){this.Bl=t},jh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(Hi.MIN)?this.xl(e,i):this.Bl.sr(e,o).next(function(t){var n=s.Ql(i,t);return(i.je()||i.Ge())&&s.yc(i.pe,n,o,r)?s.xl(e,i):(lu()<=u.DEBUG&&pu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Bl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},jh.prototype.Ql=function(n,t){var i=new vr(function(t,e){return n.qe(t,e)});return t.forEach(function(t,e){e instanceof Do&&n.matches(e)&&(i=i.add(e))}),i},jh.prototype.yc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.C(i))},jh.prototype.xl=function(t,e){return lu()<=u.DEBUG&&pu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Bl.rr(t,e,Hi.MIN)},jh),Ch=(Gh.prototype.jl=function(t,e){return this.Wl.add(e),Ru.resolve()},Gh.prototype.ur=function(t,e){return Ru.resolve(this.Wl.getEntries(e))},Gh),Vh=(xh.prototype.add=function(t){var e=t.U(),n=t.O(),i=this.index[e]||new vr(tr.k),r=!i.has(n);return this.index[e]=i.add(n),r},xh.prototype.has=function(t){var e=t.U(),n=t.O(),i=this.index[e];return i&&i.has(n)},xh.prototype.getEntries=function(t){return(this.index[t]||new vr(tr.k)).j()},xh),Uh=(qh.prototype.Kl=function(t){return Ru.resolve(0===this.Hn.length)},qh.prototype.Nh=function(t,e,n){var i=e.batchId,r=this.Hl(i,"acknowledged");return gu(0===r,"Can only acknowledge the first batch in the mutation queue"),this.Hn[r],this.lastStreamToken=n,Ru.resolve()},qh.prototype.xh=function(t){return Ru.resolve(this.lastStreamToken)},qh.prototype.Qh=function(t,e){return this.lastStreamToken=e,Ru.resolve()},qh.prototype.Sh=function(t,e,n,i){var r=this.Gl;this.Gl++,0<this.Hn.length&&this.Hn[this.Hn.length-1];var o=new Tu(r,e,n,i);this.Hn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.zl=this.zl.add(new ku(a.key,r)),this.Jn.jl(t,a.key.path.O())}return Ru.resolve(o)},qh.prototype.Uh=function(t,e){return Ru.resolve(this.Jl(e))},qh.prototype.Fh=function(t,e){var n=this.Jl(e);return Ru.resolve(n.keys())},qh.prototype.no=function(t,e){var n=e+1,i=this.Yl(n),r=i<0?0:i;return Ru.resolve(this.Hn.length>r?this.Hn[r]:null)},qh.prototype.Bh=function(){return Ru.resolve(0===this.Hn.length?-1:this.Gl-1)},qh.prototype.ph=function(t){return Ru.resolve(this.Hn.slice())},qh.prototype.Xn=function(t,e){var n=this,i=new ku(e,0),r=new ku(e,Number.POSITIVE_INFINITY),o=[];return this.zl.Dt([i,r],function(t){var e=n.Jl(t.On);o.push(e)}),Ru.resolve(o)},qh.prototype.nr=function(t,e){var i=this,r=new vr(bu);return e.forEach(function(t){var e=new ku(t,0),n=new ku(t,Number.POSITIVE_INFINITY);i.zl.Dt([e,n],function(t){r=r.add(t.On)})}),Ru.resolve(this.Xl(r))},qh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;ur.st(r)||(r=r.child(""));var o=new ku(new ur(r),0),s=new vr(bu);return this.zl.Ft(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),Ru.resolve(this.Xl(s))},qh.prototype.Xl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&i.push(e)}),i},qh.prototype.qh=function(n,i){var r=this;gu(0===this.Hl(i.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Hn.shift();var o=this.zl;return Ru.forEach(i.mutations,function(t){var e=new ku(t.key,i.batchId);return o=o.delete(e),r.dh.Zl(n,t.key)}).next(function(){r.zl=o})},qh.prototype.mo=function(t){},qh.prototype.$n=function(t,e){var n=new ku(e,0),i=this.zl.Nt(n);return Ru.resolve(e.isEqual(i&&i.key))},qh.prototype.Oh=function(t){return this.Hn.length,Ru.resolve()},qh.prototype.Hl=function(t,e){return this.Yl(t)},qh.prototype.Yl=function(t){return 0===this.Hn.length?0:t-this.Hn[0].batchId},qh.prototype.Jl=function(t){var e=this.Yl(t);return e<0||e>=this.Hn.length?null:this.Hn[e]},qh),Ph=(Mh.prototype.Xh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.t_(e);return this.docs=this.docs.nt(i,{e_:e,size:s,readTime:n}),this.size+=s-o,this.Jn.jl(t,i.path.O())},Mh.prototype.Yh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Mh.prototype.tr=function(t,e){var n=this.docs.get(e);return Ru.resolve(n?n.e_:null)},Mh.prototype.getEntries=function(t,e){var n=this,i=Ss();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.e_:null)}),Ru.resolve(i)},Mh.prototype.rr=function(t,e,n){for(var i=Rs(),r=new ur(e.path.child("")),o=this.docs._t(r);o.Rt();){var s=o.Et(),u=s.key,a=s.value,h=a.e_,c=a.readTime;if(!e.path.B(u.path))break;c.C(n)<=0||h instanceof Do&&e.matches(h)&&(i=i.nt(h.key,h))}return Ru.resolve(i)},Mh.prototype.s_=function(t,e){return Ru.forEach(this.docs,function(t){return e(t)})},Mh.prototype.Po=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Mh.prototype.po=function(t){return Ru.resolve(Hi.MIN)},Mh.prototype.kh=function(t){return new Mh.i_(this)},Mh.prototype.n_=function(t){return Ru.resolve(this.size)},Mh);function Mh(t,e){this.Jn=t,this.t_=e,this.docs=new hr(ur.k),this.size=0}function qh(t,e){this.Jn=t,this.dh=e,this.Hn=[],this.Gl=1,this.lastStreamToken=Ir.Ut,this.zl=new vr(ku.me)}function xh(){this.index={}}function Gh(){this.Wl=new Vh}function jh(){}function Fh(t,e,n){this.query=t,this.kl=e,this.Ll=!1,this.$l=null,this.onlineState="Unknown",this.options=n||{}}function Bh(t){this.Mu=t,this.vl=new Nu(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Sl=new Set,this.Mu.subscribe(this)}function Hh(t,e,n,i,r){this._u=t,this.Lc=e,this.Qc=n,this.currentUser=i,this.Wc=r,this.jc=null,this.Gc=new Nu(function(t){return t.canonicalId()}),this.zc=new Map,this.Kc=[],this.Hc=new hr(ur.k),this.Jc=new Map,this.Yc=new Su,this.Xc={},this.Zc=new Map,this.tl=_h.mc(),this.isPrimary=void 0,this.onlineState="Unknown"}function Yh(t,e,n,i){this.Ar=t,this.Lc=e,this.updateFunction=n,this.gr=i,this.$c=5,this.Ea=new vh(this.Ar,"retry_transaction")}function zh(t,e){this.query=t,this.Ec=e,this.Rc=null,this.As=!1,this.Ic=Cs(),this.ls=Cs(),this.Ac=new xs(t.qe.bind(t))}function Qh(t){this.wc=t}function Wh(){this.ic=new Nh,this.nc={},this.Mu=null,this.iu=null,this.Tr=null}function Xh(){this.activeTargetIds=Us()}function Jh(t,e,n,i,r){var o=this;this._u=t,this.Ha=e,this.du=[],this.fu=new Map,this.wu=null,this.networkEnabled=!1,this.isPrimary=!1,this.Tu=r,this.Tu.mu(function(t){n.Cr(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(pu("RemoteStore","Restarting streams for network reachability change."),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Iu=new Ah(n,i),this.Au=this.Ha.ja({Na:this.Pu.bind(this),va:this.Vu.bind(this),La:this.pu.bind(this)}),this.gu=this.Ha.Wa({Na:this.yu.bind(this),va:this.bu.bind(this),xa:this.vu.bind(this),Ba:this.Ba.bind(this)})}function Kh(t,e){this.Ar=t,this.iu=e,this.state="Unknown",this.nu=0,this.ru=null,this.hu=!0}function Zh(t){this.Ha=t,this.Ja=Ls(),this.mutations=[],this.Ya=!1,this.Xa=null,this.Za=new Set}function $h(t,e,n,i){this.ia=t,this.fa=e,this.credentials=n,this.serializer=i}function tc(t,e,n,i,r){var o=this;return(o=ph.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.Ma=!1,o.lastStreamToken=Ir.Ut,o}function ec(t,e,n,i,r){var o=this;return(o=dh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function nc(t,e,n,i,r,o){this.ia=t,this.da=n,this.fa=i,this.wa=r,this.listener=o,this.state=0,this.Ta=0,this.ma=null,this.stream=null,this.Ea=new vh(t,e)}function ic(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ia=t,this.Pr=e,this.na=n,this.ra=i,this.ha=r,this.oa=0,this.aa=null,this.ua=Date.now(),this.reset()}function rc(t){var e=this;return(e=yh.call(this)||this).c_=t,e}function oc(){this.Ch=new Nu(function(t){return t.toString()}),this.r_=!1}Ph.i_=(Object.defineProperty(oc.prototype,"readTime",{get:function(){return this.h_},set:function(t){this.h_=t},enumerable:!0,configurable:!0}),oc.prototype.Xh=function(t,e){this.o_(),this.readTime=e,this.Ch.set(t.key,t)},oc.prototype.Yh=function(t,e){this.o_(),e&&(this.readTime=e),this.Ch.set(t,null)},oc.prototype.tr=function(t,e){this.o_();var n=this.Ch.get(e);return void 0!==n?Ru.resolve(n):this.a_(t,e)},oc.prototype.getEntries=function(t,e){return this.u_(t,e)},oc.prototype.apply=function(t){return this.o_(),this.r_=!0,this.bc(t)},oc.prototype.o_=function(){},n(rc,yh=oc),rc.prototype.bc=function(n){var i=this,r=[];return this.Ch.forEach(function(t,e){e?r.push(i.c_.Xh(n,e,i.readTime)):i.c_.Yh(t)}),Ru.Gn(r)},rc.prototype.a_=function(t,e){return this.c_.tr(t,e)},rc.prototype.u_=function(t,e){return this.c_.getEntries(t,e)},rc);var sc,uc=(Ec.prototype.Xs=function(t,n){return this.l_.forEach(function(t,e){return n(e)}),Ru.resolve()},Ec.prototype.Wh=function(t){return Ru.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.w_=function(t){return Ru.resolve(this.__)},Ec.prototype.ao=function(t){return this.highestTargetId=this.f_.next(),Ru.resolve(this.highestTargetId)},Ec.prototype.to=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.__&&(this.__=e),Ru.resolve()},Ec.prototype.T_=function(t){this.l_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.f_=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.__&&(this.__=t.sequenceNumber)},Ec.prototype.uo=function(t,e){return this.T_(e),this.targetCount+=1,Ru.resolve()},Ec.prototype.Jh=function(t,e){return this.T_(e),Ru.resolve()},Ec.prototype.m_=function(t,e){return this.l_.delete(e.target),this.d_.Nn(e.targetId),--this.targetCount,Ru.resolve()},Ec.prototype.E_=function(n,i,r){var o=this,s=0,u=[];return this.l_.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.l_.delete(t),u.push(o.R_(n,e.targetId)),s++)}),Ru.Gn(u).next(function(){return s})},Ec.prototype.I_=function(t){return Ru.resolve(this.targetCount)},Ec.prototype.oo=function(t,e){var n=this.l_.get(e)||null;return Ru.resolve(n)},Ec.prototype.ui=function(t,e){return vu("Not yet implemented.")},Ec.prototype.zh=function(e,t,n){this.d_.Sn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),Ru.Gn(r)},Ec.prototype.Gh=function(e,t,n){this.d_.Fn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.Cn(e,t))}),Ru.Gn(r)},Ec.prototype.R_=function(t,e){return this.d_.Nn(e),Ru.resolve()},Ec.prototype._o=function(t,e){var n=this.d_.Ln(e);return Ru.resolve(n)},Ec.prototype.$n=function(t,e){return Ru.resolve(this.d_.$n(e))},Ec),ac=(bc.prototype.start=function(){return Promise.resolve()},bc.prototype.ku=function(){return this.V_=!1,Promise.resolve()},Object.defineProperty(bc.prototype,"g_",{get:function(){return this.V_},enumerable:!0,configurable:!0}),bc.prototype.wo=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return[2,[this.clientId]]})})},bc.prototype.y_=function(t){return t(!0)},bc.prototype.b_=function(){},bc.prototype.Eo=function(t){},bc.prototype.Ih=function(){return this.Jn},bc.prototype.fh=function(t){var e=this.A_[t.s()];return e||(e=new Uh(this.Jn,this.dh),this.A_[t.s()]=e),e},bc.prototype.Eh=function(){return this.mh},bc.prototype.Th=function(){return this.Kn},bc.prototype.runTransaction=function(t,e,n){var i=this;pu("MemoryPersistence","Starting transaction:",t);var r=new hc(this.P_.next());return this.dh.v_(),n(r).next(function(t){return i.dh.S_(r).next(function(){return t})}).Wn().then(function(t){return r.C_(),t})},bc.prototype.D_=function(e,n){return Ru.zn(Object.values(this.A_).map(function(t){return function(){return t.$n(e,n)}}))},bc),hc=(wc.prototype.N_=function(t){this.F_.push(t)},wc.prototype.C_=function(){this.F_.forEach(function(t){return t()})},n(mc,sc=wc),mc),cc=(gc.O_=function(t){return new gc(t)},Object.defineProperty(gc.prototype,"M_",{get:function(){if(this.L_)return this.L_;throw vu("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),gc.prototype._h=function(t){this.k_=t},gc.prototype.vn=function(t,e){return this.M_.delete(e),Ru.resolve()},gc.prototype.Cn=function(t,e){return this.M_.add(e),Ru.resolve()},gc.prototype.Zl=function(t,e){return this.M_.add(e),Ru.resolve()},gc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Eh();return i._o(t,e.targetId).next(function(t){t.forEach(function(t){return n.M_.add(t)})}).next(function(){return i.m_(t,e)})},gc.prototype.v_=function(){this.L_=new Set},gc.prototype.S_=function(t){var n=this,i=this.persistence.Th().kh();return Ru.forEach(this.M_,function(e){return n.U_(t,e).next(function(t){t||i.Yh(e)})}).next(function(){return n.L_=null,i.apply(t)})},gc.prototype.Zh=function(t,e){var n=this;return this.U_(t,e).next(function(t){t?n.M_.delete(e):n.M_.add(e)})},gc.prototype.p_=function(t){return 0},gc.prototype.U_=function(t,e){var n=this;return Ru.zn([function(){return n.persistence.Eh().$n(t,e)},function(){return n.persistence.D_(t,e)},function(){return Ru.resolve(n.k_.$n(e))}])},gc),lc=(vc.prototype.initialize=function(e){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){switch(t.label){case 0:return this.Qc=this.q_(e),this.persistence=this.B_(e),[4,this.persistence.start()];case 1:return t.sent(),this.x_=this.Q_(e),this._u=this.W_(e),this.Lc=this.j_(e),this.Mu=this.G_(e),this.z_=this.K_(e),this.Qc.iu=function(t){return n.Mu.Dc(t,1)},this.Lc.Mu=this.Mu,this.Qc.Mu=this.Mu,[4,this.Qc.start()];case 2:return t.sent(),[4,this.Lc.start()];case 3:return t.sent(),[4,this._u.start()];case 4:return t.sent(),[4,this.persistence.y_(function(e){return c(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Mu.Zu(e)];case 1:return t.sent(),this.x_&&(e&&!this.x_.g_?this.x_.start(this._u):e||this.x_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},vc.prototype.K_=function(t){return new Oh(this.Mu)},vc.prototype.Q_=function(t){return null},vc.prototype.W_=function(t){return new Ju(this.persistence,new Dh,t.H_)},vc.prototype.B_=function(t){return new ac(t.clientId,cc.O_)},vc.prototype.j_=function(t){var e=this;return new Ih(this._u,t.Ha,t.Ar,function(t){return e.Mu.Dc(t,0)},t.platform.J_())},vc.prototype.q_=function(t){return new Th},vc.prototype.G_=function(t){return new Rh(this._u,this.Lc,this.Qc,t.H_,t.Wc)},vc.prototype.clearPersistence=function(t){throw new qi(Mi.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},vc),fc=(yc.prototype.start=function(e,n){var i=this;this.X_();var r=new Bu,o=new Bu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,pu("FirestoreClient","Initializing. user=",t.uid),i.Z_(e,n,t,o).then(r.resolve,r.reject);i.Ar.Cr(function(){return i.Xu(t)})}),this.Ar.Cr(function(){return r.promise}),o.promise},yc.prototype.enableNetwork=function(){var t=this;return this.X_(),this.Ar.enqueue(function(){return t.Mu.enableNetwork()})},yc.prototype.Z_=function(s,u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.td(this.Y_)];case 1:return e=t.sent(),n=this.platform.ed(this.Y_.ci),i=new bh(this.Ar,e,this.credentials,n),[4,s.initialize({Ar:this.Ar,Y_:this.Y_,platform:this.platform,Ha:i,clientId:this.clientId,H_:a,Wc:100,sd:u})];case 2:return t.sent(),this.persistence=s.persistence,this.Qc=s.Qc,this._u=s._u,this.Lc=s.Lc,this.Mu=s.Mu,this.x_=s.x_,this.nd=s.z_,this.persistence.b_(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.rd(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.Z_(new lc,{hd:!1},a,h))];case 4:return[2]}})})},yc.prototype.rd=function(t){return"FirebaseError"===t.name?t.code===Mi.FAILED_PRECONDITION||t.code===Mi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},yc.prototype.X_=function(){if(this.Ar.Or)throw new qi(Mi.FAILED_PRECONDITION,"The client has already been terminated.")},yc.prototype.Xu=function(t){return this.Ar.jr(),pu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Mu.Xu(t)},yc.prototype.disableNetwork=function(){var t=this;return this.X_(),this.Ar.enqueue(function(){return t.Mu.disableNetwork()})},yc.prototype.terminate=function(){var t=this;return this.Ar.xr(function(){return c(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.x_&&this.x_.stop(),[4,this.Lc.ku()];case 1:return t.sent(),[4,this.Qc.ku()];case 2:return t.sent(),[4,this.persistence.ku()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},yc.prototype.waitForPendingWrites=function(){var t=this;this.X_();var e=new Bu;return this.Ar.Cr(function(){return t.Mu.fl(e)}),e.promise},yc.prototype.listen=function(t,e,n){var i=this;this.X_();var r=new Lh(t,e,n);return this.Ar.Cr(function(){return i.nd.listen(r)}),r},yc.prototype.$u=function(t){var e=this;this.od||this.Ar.Cr(function(){return e.nd.$u(t)})},yc.prototype.ad=function(t){var e=this;return this.X_(),this.Ar.enqueue(function(){return e._u.ro(t)}).then(function(t){if(t instanceof Do)return t;if(t instanceof Co)return null;throw new qi(Mi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},yc.prototype.ud=function(r){var t=this;return this.X_(),this.Ar.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(r,!0)];case 1:return e=t.sent(),n=new Sh(r,e.do),i=n.Vc(e.documents),[2,n.bc(i,!1).snapshot]}})})})},yc.prototype.write=function(t){var e=this;this.X_();var n=new Bu;return this.Ar.Cr(function(){return e.Mu.write(t,n)}),n.promise},yc.prototype.ci=function(){return this.Y_.ci},yc.prototype.Fl=function(t){var e=this;this.X_(),this.Ar.Cr(function(){return e.nd.Fl(t),Promise.resolve()})},yc.prototype.Nl=function(t){this.od||this.nd.Nl(t)},Object.defineProperty(yc.prototype,"od",{get:function(){return this.Ar.Or},enumerable:!0,configurable:!0}),yc.prototype.transaction=function(t){var e=this;this.X_();var n=new Bu;return this.Ar.Cr(function(){return e.Mu.runTransaction(e.Ar,t,n),Promise.resolve()}),n.promise},yc),pc=(dc.prototype.next=function(t){this.ld(this.observer.next,t)},dc.prototype.error=function(t){this.ld(this.observer.error,t)},dc.prototype._d=function(){this.muted=!0},dc.prototype.ld=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},dc);function dc(t){this.observer=t,this.muted=!1}function yc(t,e,n,i){this.platform=t,this.Y_=e,this.credentials=n,this.Ar=i,this.clientId=mu.Tn()}function vc(){}function gc(t){this.persistence=t,this.k_=null,this.L_=null}function mc(t){var e=this;return(e=sc.call(this)||this).Kh=t,e}function wc(){this.F_=[]}function bc(t,e){var n=this;this.clientId=t,this.A_={},this.P_=new Du(0),this.V_=!1,this.V_=!0,this.dh=e(this),this.mh=new uc(this),this.Jn=new Ch,this.Kn=new Ph(this.Jn,function(t){return n.dh.p_(t)})}function Ec(t){this.persistence=t,this.l_=new Nu(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Hi.MIN,this.highestTargetId=0,this.__=0,this.d_=new Su,this.targetCount=0,this.f_=_h.Tc()}function Ac(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Ic,Nc,Tc=(Xc.prototype.fd=function(t){switch(Or(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mr(t.integerValue||t.doubleValue);case 3:return this.wd(t.timestampValue);case 4:return this.Td(t);case 5:return t.stringValue;case 6:return new ba(qr(t.bytesValue));case 7:return this.md(t.referenceValue);case 8:return new ja(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.Ed(t.arrayValue);case 10:return this.Rd(t.mapValue);default:throw vu("Invalid value type: "+JSON.stringify(t))}},Xc.prototype.Rd=function(t){var n=this,i={};return Er(t.fields||{},function(t,e){i[t]=n.fd(e)}),i},Xc.prototype.Ed=function(t){var e=this;return(t.values||[]).map(function(t){return e.fd(t)})},Xc.prototype.Td=function(t){switch(this.dd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Sr(n)?t(n):n}(t);return null==e?null:this.fd(e);case"estimate":return this.wd(kr(t));default:return null}},Xc.prototype.wd=function(t){var e=Pr(t),n=new Bi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Xc.prototype.md=function(t){var e=tr.K(t);gu(uu(e),"ReferenceValue is not valid "+t);var n=new Iu(e.get(1),e.get(3)),i=new ur(e.$(5));return n.isEqual(this.firestore.Id)||du("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Id.projectId+"/"+this.firestore.Id.database+") instead."),new Lc(i,this.firestore,this.converter)},Xc),_c=zu.sh,Sc=(Wc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Wc),kc=(Qc.prototype.settings=function(t){ta("Firestore.settings",arguments,1),ia("Firestore.settings","object",1,t);var e=new Sc(t);if(this.pd&&!this.Sd.isEqual(e))throw new qi(Mi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Sd=e).credentials&&(this.bd=function(t){if(!t)return new xi;switch(t.type){case"gapi":var e=t.Fd;return gu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Fi(e,t.V||"0");case"provider":return t.Fd;default:throw new qi(Mi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Qc.prototype.enableNetwork=function(){return this.Vd(),this.pd.enableNetwork()},Qc.prototype.disableNetwork=function(){return this.Vd(),this.pd.disableNetwork()},Qc.prototype.enablePersistence=function(t){var e,n;if(this.pd)throw new qi(Mi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&du("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.Nd(this.vd,{hd:!0,cacheSizeBytes:this.Sd.cacheSizeBytes,synchronizeTabs:i})},Qc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.pd&&!this.pd.od)throw new qi(Mi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Bu,[2,(this.Pd.Mr(function(){return c(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.kd(),[4,this.vd.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Qc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Qc.prototype,"Ld",{get:function(){return this.Vd(),this.pd.od},enumerable:!0,configurable:!0}),Qc.prototype.waitForPendingWrites=function(){return this.Vd(),this.pd.waitForPendingWrites()},Qc.prototype.onSnapshotsInSync=function(t){if(this.Vd(),Ac(t))return this.$d(t);ia("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.$d(e)},Qc.prototype.$d=function(t){var e=this,n=new pc({next:function(){t.next&&t.next()},error:function(t){throw vu("Uncaught Error in onSnapshotsInSync")}});return this.pd.Fl(n),function(){n._d(),e.pd.Nl(n)}},Qc.prototype.Vd=function(){return this.pd||this.Nd(new lc,{hd:!1}),this.pd},Qc.prototype.kd=function(){return new Au(this.Id,this.yd,this.Sd.host,this.Sd.ssl,this.Sd.forceLongPolling)},Qc.prototype.Nd=function(t,e){var n=this.kd();return this.pd=new fc(au.Ot(),n,this.bd,this.Pd),this.pd.start(t,e)},Qc.prototype.Dd=function(i){var t=new ou(i,{di:au.Ot().di});return new th(t,function(t){if(t instanceof Lc){var e=i,n=t.firestore.Id;if(!n.isEqual(e))throw new qi(Mi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new $a(i,t.Od)}return t})},Qc.gd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new qi(Mi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new qi(Mi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Iu(n)},Object.defineProperty(Qc.prototype,"app",{get:function(){if(!this.Ad)throw new qi(Mi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ad},enumerable:!0,configurable:!0}),Qc.prototype.collection=function(t){return ta("Firestore.collection",arguments,1),ia("Firestore.collection","non-empty string",1,t),this.Vd(),new Mc(tr.K(t),this)},Qc.prototype.doc=function(t){return ta("Firestore.doc",arguments,1),ia("Firestore.doc","non-empty string",1,t),this.Vd(),Lc.Md(tr.K(t),this)},Qc.prototype.collectionGroup=function(t){if(ta("Firestore.collectionGroup",arguments,1),ia("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Vd(),new Uc(new Po(tr.H,t),this)},Qc.prototype.runTransaction=function(e){var n=this;return ta("Firestore.runTransaction",arguments,1),ia("Firestore.runTransaction","function",1,e),this.Vd().transaction(function(t){return e(new Rc(n,t))})},Qc.prototype.batch=function(){return this.Vd(),new Oc(this)},Object.defineProperty(Qc,"logLevel",{get:function(){switch(lu()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Qc.setLogLevel=function(t){switch(ta("Firestore.setLogLevel",arguments,1),ia("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":fu(u.DEBUG);break;case"error":fu(u.ERROR);break;case"silent":fu(u.SILENT);break;default:throw new qi(Mi.INVALID_ARGUMENT,"Invalid log level: "+t)}},Qc.prototype.Ud=function(){return this.Sd.timestampsInSnapshots},Qc),Rc=(zc.prototype.get=function(t){var n=this;ta("Transaction.get",arguments,1);var i=$c("Transaction.get",t,this.qd);return this.Bd.za([i.Od]).then(function(t){if(!t||1!==t.length)return vu("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof Co)return new Cc(n.qd,i.Od,null,!1,!1,i.xd);if(e instanceof Do)return new Cc(n.qd,i.Od,e,!1,!1,i.xd);throw vu("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},zc.prototype.set=function(t,e,n){na("Transaction.set",arguments,2,3);var i=$c("Transaction.set",t,this.qd);n=Jc("Transaction.set",n);var r=tl(i.xd,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.qd.Cd.zo(s,o,n.mergeFields):this.qd.Cd.jo(s,o);return this.Bd.set(i.Od,u),this},zc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Aa?(ea("Transaction.update",arguments,3),i=$c("Transaction.update",t,this.qd),this.qd.Cd.Yo("Transaction.update",e,n,o)):(ta("Transaction.update",arguments,2),i=$c("Transaction.update",t,this.qd),this.qd.Cd.Ko("Transaction.update",e)),this.Bd.update(i.Od,r),this},zc.prototype.delete=function(t){ta("Transaction.delete",arguments,1);var e=$c("Transaction.delete",t,this.qd);return this.Bd.delete(e.Od),this},zc),Oc=(Yc.prototype.set=function(t,e,n){na("WriteBatch.set",arguments,2,3),this.jd();var i=$c("WriteBatch.set",t,this.qd);n=Jc("WriteBatch.set",n);var r=tl(i.xd,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.qd.Cd.zo(s,o,n.mergeFields):this.qd.Cd.jo(s,o);return this.Qd=this.Qd.concat(u.Lo(i.Od,io.NONE)),this},Yc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.jd(),r="string"==typeof e||e instanceof Aa?(ea("WriteBatch.update",arguments,3),i=$c("WriteBatch.update",t,this.qd),this.qd.Cd.Yo("WriteBatch.update",e,n,o)):(ta("WriteBatch.update",arguments,2),i=$c("WriteBatch.update",t,this.qd),this.qd.Cd.Ko("WriteBatch.update",e)),this.Qd=this.Qd.concat(r.Lo(i.Od,io.exists(!0))),this},Yc.prototype.delete=function(t){ta("WriteBatch.delete",arguments,1),this.jd();var e=$c("WriteBatch.delete",t,this.qd);return this.Qd=this.Qd.concat(new go(e.Od,io.NONE)),this},Yc.prototype.commit=function(){return this.jd(),this.Wd=!0,0<this.Qd.length?this.qd.Vd().write(this.Qd):Promise.resolve()},Yc.prototype.jd=function(){if(this.Wd)throw new qi(Mi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Yc),Lc=(Hc.Md=function(t,e,n){if(t.length%2!=0)throw new qi(Mi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new Hc(new ur(t),e,n)},Object.defineProperty(Hc.prototype,"id",{get:function(){return this.Od.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Hc.prototype,"parent",{get:function(){return new Mc(this.Od.path.O(),this.firestore,this.xd)},enumerable:!0,configurable:!0}),Object.defineProperty(Hc.prototype,"path",{get:function(){return this.Od.path.G()},enumerable:!0,configurable:!0}),Hc.prototype.collection=function(t){if(ta("DocumentReference.collection",arguments,1),ia("DocumentReference.collection","non-empty string",1,t),!t)throw new qi(Mi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=tr.K(t);return new Mc(this.Od.path.child(e),this.firestore)},Hc.prototype.isEqual=function(t){if(!(t instanceof Hc))throw pa("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Od.isEqual(t.Od)&&this.xd===t.xd},Hc.prototype.set=function(t,e){na("DocumentReference.set",arguments,1,2),e=Jc("DocumentReference.set",e);var n=tl(this.xd,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.Cd.zo(r,i,e.mergeFields):this.firestore.Cd.jo(r,i);return this.pd.write(o.Lo(this.Od,io.NONE))},Hc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Aa?(ea("DocumentReference.update",arguments,2),this.firestore.Cd.Yo("DocumentReference.update",t,e,i)):(ta("DocumentReference.update",arguments,1),this.firestore.Cd.Ko("DocumentReference.update",t)),this.pd.write(n.Lo(this.Od,io.exists(!0)))},Hc.prototype.delete=function(){return ta("DocumentReference.delete",arguments,0),this.pd.write([new go(this.Od,io.NONE)])},Hc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];na("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ac(t[r])||(fa("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),sa("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ac(t[r])?t[r]:(ia("DocumentReference.onSnapshot","function",r,t[r]),ra("DocumentReference.onSnapshot","function",r+1,t[r+1]),ra("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Gd(o,n)},Hc.prototype.Gd=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new pc({next:function(t){if(n.next){var e=t.docs.get(i.Od);n.next(new Cc(i.firestore,i.Od,e,t.fromCache,t.hasPendingWrites,i.xd))}},error:e}),o=this.pd.listen(Po.ve(this.Od.path),r,t);return function(){r._d(),i.pd.$u(o)}},Hc.prototype.get=function(n){var i=this;return na("DocumentReference.get",arguments,0,1),Zc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Vd().ad(i.Od).then(function(t){e(new Cc(i.firestore,i.Od,t,!0,t instanceof Do&&t.te,i.xd))},t):i.zd(e,t,n)})},Hc.prototype.zd=function(e,n,i){var r=this.Gd({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new qi(Mi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new qi(Mi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Hc.prototype.withConverter=function(t){return new Hc(this.Od,this.firestore,t)},Hc),Dc=(Bc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Bc),Cc=(Fc.prototype.data=function(t){if(na("DocumentSnapshot.data",arguments,0,1),t=Kc("DocumentSnapshot.data",t),this.Kd){if(this.xd){var e=new Vc(this.qd,this.Od,this.Kd,this.Hd,this.Jd);return this.xd.fromFirestore(e,t)}return new Tc(this.qd,this.qd.Ud(),t.serverTimestamps,void 0).fd(this.Kd.Re())}},Fc.prototype.get=function(t,e){if(na("DocumentSnapshot.get",arguments,1,2),e=Kc("DocumentSnapshot.get",e),this.Kd){var n=this.Kd.data().field(oh("DocumentSnapshot.get",t));if(null!==n)return new Tc(this.qd,this.qd.Ud(),e.serverTimestamps,this.xd).fd(n)}},Object.defineProperty(Fc.prototype,"id",{get:function(){return this.Od.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"ref",{get:function(){return new Lc(this.Od,this.qd,this.xd)},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"exists",{get:function(){return null!==this.Kd},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"metadata",{get:function(){return new Dc(this.Jd,this.Hd)},enumerable:!0,configurable:!0}),Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw pa("isEqual","DocumentSnapshot",1,t);return this.qd===t.qd&&this.Hd===t.Hd&&this.Od.isEqual(t.Od)&&(null===this.Kd?null===t.Kd:this.Kd.isEqual(t.Kd))&&this.xd===t.xd},Fc),Vc=(n(jc,Nc=Cc),jc.prototype.data=function(t){return Nc.prototype.data.call(this,t)},jc),Uc=(Gc.prototype.where=function(t,e,n){var i;ta("Query.where",arguments,3),la("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new qi(Mi.INVALID_ARGUMENT,"Invalid value "+ca(e)+" provided to function Query.where() for its "+ya(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=oh("Query.where",t),o=Mo.K(e);if(r.Y()){if(o===Mo.ARRAY_CONTAINS||o===Mo.ARRAY_CONTAINS_ANY)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Mo.IN){this.Xd(n,o);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Zd(h))}i={arrayValue:{values:s}}}else i=this.Zd(n)}else o!==Mo.IN&&o!==Mo.ARRAY_CONTAINS_ANY||this.Xd(n,o),i=this.firestore.Cd.Xo("Query.where",n,o===Mo.IN);var c=Zo.create(r,o,i);return this.tf(c),new Gc(this.Yd.De(c),this.firestore,this.xd)},Gc.prototype.orderBy=function(t,e){var n;if(na("Query.orderBy",arguments,1,2),ra("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=rs.ASCENDING;else{if("desc"!==e)throw new qi(Mi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=rs.DESCENDING}if(null!==this.Yd.startAt)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Yd.endAt)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=oh("Query.orderBy",t),r=new vs(i,n);return this.ef(r),new Gc(this.Yd.Fe(r),this.firestore,this.xd)},Gc.prototype.limit=function(t){return ta("Query.limit",arguments,1),ia("Query.limit","number",1,t),da("Query.limit",1,t),new Gc(this.Yd.Ne(t),this.firestore,this.xd)},Gc.prototype.limitToLast=function(t){return ta("Query.limitToLast",arguments,1),ia("Query.limitToLast","number",1,t),da("Query.limitToLast",1,t),new Gc(this.Yd.ke(t),this.firestore,this.xd)},Gc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ea("Query.startAt",arguments,1);var i=this.sf("Query.startAt",t,e,!0);return new Gc(this.Yd.Le(i),this.firestore,this.xd)},Gc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ea("Query.startAfter",arguments,1);var i=this.sf("Query.startAfter",t,e,!1);return new Gc(this.Yd.Le(i),this.firestore,this.xd)},Gc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ea("Query.endBefore",arguments,1);var i=this.sf("Query.endBefore",t,e,!0);return new Gc(this.Yd.$e(i),this.firestore,this.xd)},Gc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ea("Query.endAt",arguments,1);var i=this.sf("Query.endAt",t,e,!1);return new Gc(this.Yd.$e(i),this.firestore,this.xd)},Gc.prototype.isEqual=function(t){if(!(t instanceof Gc))throw pa("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Yd.isEqual(t.Yd)},Gc.prototype.withConverter=function(t){return new Gc(this.Yd,this.firestore,t)},Gc.prototype.sf=function(t,e,n,i){if(la(t,1,e),e instanceof Cc){if(0<n.length)throw new qi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new qi(Mi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.if(r.Kd,i)}var o=[e].concat(n);return this.nf(t,o,i)},Gc.prototype.if=function(t,e){for(var n=[],i=0,r=this.Yd.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(xr(this.firestore.Id,t.key));else{var s=t.field(o.field);if(Sr(s))throw new qi(Mi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.G();throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ys(n,e)},Gc.prototype.nf=function(t,e,n){var i=this.Yd.Ve;if(e.length>i.length)throw new qi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Yd.He()&&-1!==s.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.Yd.path.child(tr.K(s));if(!ur.st(u))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ur(u);r.push(xr(this.firestore.Id,a))}else{var h=this.firestore.Cd.Xo(t,s);r.push(h)}}return new ys(r,n)},Gc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];na("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ac(t[r])||(fa("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),sa("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ac(t[r])?t[r]:(ia("Query.onSnapshot","function",r,t[r]),ra("Query.onSnapshot","function",r+1,t[r+1]),ra("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.rf(this.Yd),this.Gd(i,n)},Gc.prototype.Gd=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new pc({next:function(t){e.next&&e.next(new Pc(n.firestore,n.Yd,t,n.xd))},error:i}),o=this.firestore.Vd(),s=o.listen(this.Yd,r,t);return function(){r._d(),o.$u(s)}},Gc.prototype.rf=function(t){if(t.Ge()&&0===t.Ve.length)throw new qi(Mi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Gc.prototype.get=function(n){var i=this;return na("Query.get",arguments,0,1),Zc("Query.get",n),this.rf(this.Yd),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Vd().ud(i.Yd).then(function(t){e(new Pc(i.firestore,i.Yd,t,i.xd))},t):i.zd(e,t,n)})},Gc.prototype.zd=function(e,n,i){var r=this.Gd({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new qi(Mi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Gc.prototype.Zd=function(t){if("string"==typeof t){if(""===t)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Yd.He()&&-1!==t.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Yd.path.child(tr.K(t));if(!ur.st(e))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return xr(this.firestore.Id,new ur(e))}if(t instanceof Lc){var n=t;return xr(this.firestore.Id,n.Od)}throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ca(t)+".")},Gc.prototype.Xd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Gc.prototype.tf=function(t){if(t instanceof Zo){var e=[Mo.ARRAY_CONTAINS,Mo.ARRAY_CONTAINS_ANY],n=[Mo.IN,Mo.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ze()){var o=this.Yd.Se();if(null!==o&&!o.isEqual(t.field))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Yd.Ce();null!==s&&this.hf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.Yd.Ke(n)),null===u&&i&&(u=this.Yd.Ke(e)),null!=u)throw u===t.op?new qi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new qi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Gc.prototype.ef=function(t){if(null===this.Yd.Ce()){var e=this.Yd.Se();null!==e&&this.hf(e,t.field)}},Gc.prototype.hf=function(t,e){if(!e.isEqual(t))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Gc),Pc=(Object.defineProperty(xc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"empty",{get:function(){return this.uf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"size",{get:function(){return this.uf.docs.size},enumerable:!0,configurable:!0}),xc.prototype.forEach=function(e,n){var i=this;na("QuerySnapshot.forEach",arguments,1,2),ia("QuerySnapshot.forEach","function",1,e),this.uf.docs.forEach(function(t){e.call(n,i._f(t))})},Object.defineProperty(xc.prototype,"query",{get:function(){return new Uc(this.af,this.qd,this.xd)},enumerable:!0,configurable:!0}),xc.prototype.docChanges=function(t){t&&(fa("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),sa("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.uf.ds)throw new qi(Mi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.cf&&this.lf===e||(this.cf=function(r,e,o,s){if(o.cs.q()){var n=0;return o.docChanges.map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Vc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vu("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.qd,e,this.uf,this.xd),this.lf=e),this.cf},xc.prototype.isEqual=function(t){if(!(t instanceof xc))throw pa("isEqual","QuerySnapshot",1,t);return this.qd===t.qd&&this.af.isEqual(t.af)&&this.uf.isEqual(t.uf)&&this.xd===t.xd},xc.prototype._f=function(t){return new Vc(this.qd,t.key,t,this.metadata.fromCache,this.uf.ls.has(t.key),this.xd)},xc),Mc=(n(qc,Ic=Uc),Object.defineProperty(qc.prototype,"id",{get:function(){return this.Yd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"parent",{get:function(){var t=this.Yd.path.O();return t.q()?null:new Lc(new ur(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(qc.prototype,"path",{get:function(){return this.Yd.path.G()},enumerable:!0,configurable:!0}),qc.prototype.doc=function(t){if(na("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=mu.Tn()),ia("CollectionReference.doc","non-empty string",1,t),""===t)throw new qi(Mi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=tr.K(t);return Lc.Md(this.Yd.path.child(e),this.firestore,this.xd)},qc.prototype.add=function(t){ta("CollectionReference.add",arguments,1),ia("CollectionReference.add","object",1,this.xd?this.xd.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},qc.prototype.withConverter=function(t){return new qc(this.df,this.firestore,t)},qc);function qc(t,e,n){var i=this;if(((i=Ic.call(this,Po.ve(t),e,n)||this).df=t).length%2!=1)throw new qi(Mi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function xc(t,e,n,i){this.qd=t,this.af=e,this.uf=n,this.xd=i,this.cf=null,this.lf=null,this.metadata=new Dc(n.hasPendingWrites,n.fromCache)}function Gc(t,e,n){this.Yd=t,this.firestore=e,this.xd=n}function jc(){return null!==Nc&&Nc.apply(this,arguments)||this}function Fc(t,e,n,i,r,o){this.qd=t,this.Od=e,this.Kd=n,this.Hd=i,this.Jd=r,this.xd=o}function Bc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Hc(t,e,n){this.Od=t,this.firestore=e,this.xd=n,this.pd=this.firestore.Vd()}function Yc(t){this.qd=t,this.Qd=[],this.Wd=!1}function zc(t,e){this.qd=t,this.Bd=e}function Qc(t,e,n){var i=this;if(void 0===n&&(n=new lc),this.Ad=null,this.Pd=new Yu,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vd(),[4,this.pd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.Ad=r,this.Id=Qc.gd(r),this.yd=r.name,this.bd=new Gi(e)}else{var o=t;if(!o.projectId)throw new qi(Mi.INVALID_ARGUMENT,"Must provide projectId");this.Id=new Iu(o.projectId,o.database),this.yd="[DEFAULT]",this.bd=new xi}this.vd=n,this.Sd=new Sc({}),this.Cd=this.Dd(this.Id)}function Wc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new qi(Mi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else oa("settings","non-empty string","host",t.host),this.host=t.host,sa("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(fa("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),sa("settings","object","credentials",t.credentials),this.credentials=t.credentials,sa("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?du("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&du("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,sa("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=zu.nh;else{if(t.cacheSizeBytes!==_c&&t.cacheSizeBytes<zu.ih)throw new qi(Mi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+zu.ih);this.cacheSizeBytes=t.cacheSizeBytes}sa("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Xc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.dd=n,this.converter=i}function Jc(t,e){if(void 0===e)return{merge:!1};if(fa(t,e,["merge","mergeFields"]),sa(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ca(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+ca(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof Aa}),void 0!==e.mergeFields&&void 0!==e.merge)throw new qi(Mi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function Kc(t,e){return void 0===e?{}:(fa(t,e,["serverTimestamps"]),ua(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Zc(t,e){ra(t,"object",1,e),e&&(fa(t,e,["source"]),ua(t,0,"source",e.source,["default","server","cache"]))}function $c(t,e,n){if(e instanceof Lc){if(e.firestore!==n)throw new qi(Mi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw pa(t,"DocumentReference",1,e)}function tl(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var el,nl=ga(kc,"Use firebase.firestore() instead."),il=ga(Rc,"Use firebase.firestore().runTransaction() instead."),rl=ga(Oc,"Use firebase.firestore().batch() instead."),ol=ga(Lc,"Use firebase.firestore().doc() instead."),sl=ga(Cc),ul=ga(Vc),al=ga(Uc),hl=ga(Pc),cl=ga(Mc,"Use firebase.firestore().collection() instead."),ll={Firestore:nl,GeoPoint:ja,Timestamp:Bi,Blob:Ea,Transaction:il,WriteBatch:rl,DocumentReference:ol,DocumentSnapshot:sl,Query:al,QueryDocumentSnapshot:ul,QuerySnapshot:hl,CollectionReference:cl,FieldPath:Aa,FieldValue:Ga,setLogLevel:kc.setLogLevel,CACHE_SIZE_UNLIMITED:_c},fl=(El.prototype.mu=function(t){},El.prototype.ku=function(){},El),pl=(bl.prototype.mu=function(t){this.Ef.push(t)},bl.prototype.ku=function(){window.removeEventListener("online",this.ff),window.removeEventListener("offline",this.Tf)},bl.prototype.Rf=function(){window.addEventListener("online",this.ff),window.addEventListener("offline",this.Tf)},bl.prototype.wf=function(){pu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ef;t<e.length;t++)(0,e[t])(0)},bl.prototype.mf=function(){pu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ef;t<e.length;t++)(0,e[t])(1)},bl.If=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},bl),dl=(wl.prototype.Na=function(t){this.Vf=t},wl.prototype.va=function(t){this.pf=t},wl.prototype.onMessage=function(t){this.gf=t},wl.prototype.close=function(){this.Pf()},wl.prototype.send=function(t){this.Af(t)},wl.prototype.yf=function(){this.Vf()},wl.prototype.bf=function(t){this.pf(t)},wl.prototype.vf=function(t){this.gf(t)},wl),yl={BatchGetDocuments:"batchGet",Commit:"commit"},vl="gl-js/ fire/"+Di,gl=(ml.prototype.Cf=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=vl},ml.prototype.Ga=function(a,i,r){var h=this,c=this.Df(a);return new Promise(function(o,s){var u=new Li;u.listenOnce(Ri.COMPLETE,function(){try{switch(u.getLastErrorCode()){case ki.NO_ERROR:var t=u.getResponseJson();pu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case ki.TIMEOUT:pu("Connection",'RPC "'+a+'" timed out'),s(new qi(Mi.DEADLINE_EXCEEDED,"Request time out"));break;case ki.HTTP_ERROR:var e=u.getStatus();if(pu("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Mi).indexOf(r)?r:Mi.UNKNOWN);s(new qi(i,n.message))}else s(new qi(Mi.UNKNOWN,"Server responded with status "+u.getStatus()))}else pu("Connection",'RPC "'+a+'" failed'),s(new qi(Mi.UNAVAILABLE,"Connection failed."));break;default:vu('RPC "'+a+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{pu("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);pu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Cf(n,r),u.send(c,"POST",e,n,15)})},ml.prototype.Ka=function(t,e,n){return this.Ga(t,e,n)},ml.prototype.ka=function(t,e){var n,i,r=[this.Sf,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Si(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Cf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}pu("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new dl({Af:function(t){l?pu("Connection","Not sending because WebChannel is closed:",t):(c||(pu("Connection","Opening WebChannel transport."),h.open(),c=!0),pu("Connection","WebChannel sending:",t),h.send(t))},Pf:function(){return h.close()}});return a(Oi.EventType.OPEN,function(){l||pu("Connection","WebChannel transport opened.")}),a(Oi.EventType.CLOSE,function(){l||(l=!0,pu("Connection","WebChannel transport closed"),f.bf())}),a(Oi.EventType.ERROR,function(t){l||(l=!0,pu("Connection","WebChannel transport errored:",t),f.bf(new qi(Mi.UNAVAILABLE,"The operation could not be completed")))}),a(Oi.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];gu(!!n,"Got a webchannel message without data.");var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){pu("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=ps[r];if(void 0!==t)return Ns(t)}(),s=i.message;void 0===o&&(o=Mi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.bf(new qi(o,s)),h.close()}else pu("Connection","WebChannel received:",n),f.vf(n)}}),setTimeout(function(){f.yf()},0),f},ml.prototype.Df=function(t){var e=yl[t];return this.Sf+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},ml);function ml(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.Sf=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function wl(t){this.Af=t.Af,this.Pf=t.Pf}function bl(){var t=this;this.ff=function(){return t.wf()},this.Tf=function(){return t.mf()},this.Ef=[],this.Rf()}function El(){}function Al(){this.di=!0,this.yo="undefined"!=typeof atob}au.fn((Object.defineProperty(Al.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Al.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Al.prototype.td=function(t){return Promise.resolve(new gl(t))},Al.prototype.J_=function(){return new(pl.If()?pl:fl)},Al.prototype.ed=function(t){return new ou(t,{di:!0})},Al.prototype.wn=function(t){return JSON.stringify(t)},Al.prototype.atob=function(t){return atob(t)},Al.prototype.btoa=function(t){return btoa(t)},new Al)),(el=Il).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new kc(e,n,new lc);var e,n},"PUBLIC").setServiceProps(Object.assign({},ll))),el.registerVersion("@firebase/firestore","1.14.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
